// 日本ステージ会話データの定義
export const japanConversationData = {
    // コンピュータエリア
    'computer': {
        'background': 'test_1',
        'bgm': 'curono',
        'conversations': [
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': 'ここはコンピュータエリアだぜ☆',
                'expression': 'a'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': '最新のテクノロジーが集まってる場所だな',
                'expression': 'b'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': 'プログラミングとか、AIとか、いろんな技術があるぜ',
                'expression': 'a'
            }
        ]
    },
    
    // 故障車エリア
    'breaking_car': {
        'background': 'test_1',
        'bgm': 'curono',
        'conversations': [
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': '故障した車があるな...',
                'expression': 'b'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': 'メンテナンスが必要だな',
                'expression': 'a'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': '安全第一で修理しないとな',
                'expression': 'c'
            }
        ]
    },
    
    // 特殊詐欺エリア
    'special_scam': {
        'background': 'test_1',
        'bgm': 'まどいの水源',
        'conversations': [
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': '友達の結婚式よかったな、、、',
                'expression': 'a'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': 'とりあえず、ネカフェに泊まって体、バキバキだから一服するか',
                'expression': 'b'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': 'ふぅ、、、、、、',
                'expression': 'c'
            },
            {
                'speaker': '知らないおじさん',
                'character': 'stranger',
                'text': 'ちょっと、お兄さん、ここらへんで有名な居酒屋しらない？',
                'expression': 'a'
            },
            {
                'speaker': '知らないおじさん',
                'character': 'stranger',
                'text': '俺も、、、久しぶりにかえったからな、、、とりあえず、知っているところ答えるか',
                'expression': 'a'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': 'ここなんかはゆうめいですね、、、',
                'expression': 'a'
            },
            {
                'speaker': '知らないおじさん',
                'character': 'stranger',
                'text': 'ありがとうありがとう、、、',
                'expression': 'a'
            },
            {
                'speaker': '知らないおじさん',
                'character': 'stranger',
                'text': 'お兄さんいい人だから、俺もいろいろ話したくなったわ',
                'expression': 'a'
            },
            {
                'speaker': '知らないおじさん',
                'character': 'stranger',
                'text': '実は俺宝くじ当たったから、働く必要なくなって鹿児島観光してたんだわ',
                'expression': 'a'
            },
            {
                'speaker': '知らないおじさん',
                'character': 'stranger',
                'text': 'お兄さんいつ帰るの？あした？',
                'expression': 'a'
            },
            {
                'speaker': '知らないおじさん',
                'character': 'stranger',
                'text': 'じゃあもう飛行機とかいいから、ちょっと話そうよ、飯いこう',
                'expression': 'a'
            },
            {
                'speaker': '知らないおじさん',
                'character': 'stranger',
                'text': '焼き鳥とかにいこうや',
                'expression': 'a'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': 'ん？？？？言ったところと違うけど、まぁええか',
                'expression': 'b'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': 'あっ、わかりました',
                'expression': 'a'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': '焼き鳥おいしいですね',
                'expression': 'a'
            },
            {
                'speaker': '知らないおじさん',
                'character': 'stranger',
                'text': '美味しかったですね。',
                'expression': 'a'
            },
            {
                'speaker': '知らないおじさん',
                'character': 'stranger',
                'text': 'ちょっと、つかれましたね、そこのベンチに座りましょう',
                'expression': 'a'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': '仕事とかあんまりうまくいってなくて、さらに家族もいろいろあって',
                'expression': 'c'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': '彼女とも大変で、そのうえ生活費出すのギリギリで、、、',
                'expression': 'c'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': 'うぅ、、、、くぅ、、、、',
                'expression': 'c'
            },
            {
                'speaker': '知らないおじさん',
                'character': 'stranger',
                'text': 'そっか、大変やったんやな',
                'expression': 'a'
            },
            {
                'speaker': '知らないおじさん',
                'character': 'stranger',
                'text': 'そうだな、、俺、宝くじ１億円当たってるし、５０万あげるわ',
                'expression': 'a'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': 'マジっすか',
                'expression': 'a'
            },
            {
                'speaker': '知らないおじさん',
                'character': 'stranger',
                'text': 'じゃあ、もう今日はゆっくり帰りな',
                'expression': 'a'
            },
            {
                'speaker': '知らないおじさん',
                'character': 'stranger',
                'text': '今日はもう飛行機キャンセルして、きれいなおねーちゃんがいるところといいとこ連れて行ってあげるよ',
                'expression': 'a'
            },
            {
                'speaker': '知らないおじさん',
                'character': 'stranger',
                'text': 'だけど、そうだな、このまま５０万円上げるのは簡単だけど',
                'expression': 'a'
            },
            {
                'speaker': '知らないおじさん',
                'character': 'stranger',
                'text': 'お兄さんの今後のためにそのまま渡すだけでは意味ないな、、',
                'expression': 'a'
            },
            {
                'speaker': '知らないおじさん',
                'character': 'stranger',
                'text': 'お兄さんならどうする？',
                'expression': 'a'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': 'ど、、どうすかね、、、',
                'expression': 'b'
            },
            {
                'speaker': '知らないおじさん',
                'character': 'stranger',
                'text': 'こうするのがいいよ、、',
                'expression': 'a'
            },
            {
                'speaker': '知らないおじさん',
                'character': 'stranger',
                'text': '俺今、金を扱う仕事をしていて、金を扱うトレーダーをしているんだ',
                'expression': 'a'
            },
            {
                'speaker': '知らないおじさん',
                'character': 'stranger',
                'text': '日本で買って、海外っていうか中国とかで売るって感じかな',
                'expression': 'a'
            },
            {
                'speaker': '知らないおじさん',
                'character': 'stranger',
                'text': '中国では金の価値がめっちゃあがっているんだよ',
                'expression': 'a'
            },
            {
                'speaker': '知らないおじさん',
                'character': 'stranger',
                'text': 'で、今、ちょうど一口あいてて',
                'expression': 'a'
            },
            {
                'speaker': '知らないおじさん',
                'character': 'stranger',
                'text': '確定で５０万とか入れたら１倍以上、、、２倍とかになるから',
                'expression': 'a'
            },
            {
                'speaker': '知らないおじさん',
                'character': 'stranger',
                'text': 'その一口をあげるよ',
                'expression': 'a'
            },
            {
                'speaker': '知らないおじさん',
                'character': 'stranger',
                'text': 'ただし、その５０万円は自分で準備してね、、',
                'expression': 'a'
            },
            {
                'speaker': '知らないおじさん',
                'character': 'stranger',
                'text': 'どうする？？',
                'expression': 'a'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': '、、、うっ、、、',
                'expression': 'c'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': '状況を整理しよう、',
                'expression': 'b'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': '俺は（2022年）当時、貯金ゼロ、友達の祝儀３万とかでカツカツ、、、',
                'expression': 'c'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': 'しかも、今ニート、、、、',
                'expression': 'c'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': 'だが、お金は欲しい、、、',
                'expression': 'b'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': 'でも、お金を増やすにはお金がいる',
                'expression': 'b'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': '、、、どうしよう、、',
                'expression': 'c'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': '借りるしかないよな、、、、、、',
                'expression': 'c'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': '借りるしか、、、',
                'expression': 'c'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': 'ちょっと、待ってください',
                'expression': 'a'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': '俺今、カツカツなので、消費者金融をあたらせてください',
                'expression': 'a'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': 'ニートでも行ける消費者金融を探すか、、、',
                'expression': 'b'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': 'なかなか、ないか、、、',
                'expression': 'b'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': 'あった、ここだ、、、、',
                'expression': 'a'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': 'あっ、５０万、、、借りました',
                'expression': 'a'
            },
            {
                'speaker': '知らないおじさん',
                'character': 'stranger',
                'text': 'よし、じゃあ、今から連れて行くところに金があるんよね',
                'expression': 'a'
            },
            {
                'speaker': '知らないおじさん',
                'character': 'stranger',
                'text': 'そこで買って、郵便とか全部俺がして届けるから、',
                'expression': 'a'
            },
            {
                'speaker': '知らないおじさん',
                'character': 'stranger',
                'text': 'そのあと一緒に、今日ご飯とか食べたり、お酒飲んだりいろいろ一緒にしよう',
                'expression': 'a'
            },
            {
                'speaker': '知らないおじさん',
                'character': 'stranger',
                'text': 'で、、、、場所なんだけど、ドン・キホーテ、、、',
                'expression': 'a'
            },
            {
                'speaker': '知らないおじさん',
                'character': 'stranger',
                'text': 'ドン・キホーテに金が売っているから、とりあえず、先に口座でお金おろしてきてね',
                'expression': 'a'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': 'わかりました、',
                'expression': 'a'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': 'ガラガラ、、、、、',
                'expression': 'a'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': '５０万円の札束、、うわ、、、これが５０万なんだ、、、',
                'expression': 'a'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': 'これが５０万円なんすね、すごいっすね',
                'expression': 'a'
            },
            {
                'speaker': '知らないおじさん',
                'character': 'stranger',
                'text': 'いや、もっと増えるから',
                'expression': 'a'
            },
            {
                'speaker': '知らないおじさん',
                'character': 'stranger',
                'text': 'こんなもんじゃないよ',
                'expression': 'a'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': 'うわ、マジっすか、、',
                'expression': 'a'
            },
            {
                'speaker': '知らないおじさん',
                'character': 'stranger',
                'text': 'とりあえず、この場でパッと渡すと怪しまれるから',
                'expression': 'a'
            },
            {
                'speaker': '知らないおじさん',
                'character': 'stranger',
                'text': 'ちょっと、そこの通りを歩いて、人目のつかない場所に行こうか',
                'expression': 'a'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': 'じゃあ、これよろしくお願いしますね',
                'expression': 'a'
            },
            {
                'speaker': '知らないおじさん',
                'character': 'stranger',
                'text': 'じゃあ、ドン・キホーテに行こうか',
                'expression': 'a'
            },
            {
                'speaker': '知らないおじさん',
                'character': 'stranger',
                'text': 'ドン・キホーテについたけど、俺金を買ってくるからちょっとここでまっててね',
                'expression': 'a'
            },
            {
                'speaker': '知らないおじさん',
                'character': 'stranger',
                'text': '絶対まっててよ',
                'expression': 'a'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': 'わかりました！！！',
                'expression': 'a'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': '数分後、、、',
                'expression': 'b'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': 'もうそろそろかな、、、',
                'expression': 'b'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': '数十分後、、、',
                'expression': 'b'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': 'まぁまぁまぁまぁ、、、金に換えるからなこれぐらいかかるんだろな',
                'expression': 'b'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': 'まぁ、いい人だったしな、、、、まぁ。。ないよな、、、そんなこと、、、',
                'expression': 'c'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': '３０分後、、、',
                'expression': 'b'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': 'あっ、、あへぇ、、あれ、、、おかしいな、、、、おそいな、、、',
                'expression': 'c'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': 'んん、、、あれ、、、あへぇぇ、、ほんとに、、、おそいな、、、おそ、、',
                'expression': 'c'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': 'あっ、、、、、あっあっ、、、ア、、、、いや、、、あっ、、、',
                'expression': 'c'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': '、、、、あっ、騙された、、、、、、、、、、、、、、',
                'expression': 'c'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': 'はっ、っは、、、、はぁ、はぁ、うぅ、、、、、はぁ、はぁ、、、、、、',
                'expression': 'c'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': 'あああああ、、、、、あああああああああああ、、、',
                'expression': 'c'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': 'とっ、とりあえず、ちょっと、顔見知りの居酒屋のオーナーにそっ、相談しよう',
                'expression': 'c'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': 'プルルルルルル',
                'expression': 'a'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': '、、、、、あああああ、、だっ、、、、',
                'expression': 'c'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': '騙されました、どうしましょう、、',
                'expression': 'c'
            },
            {
                'speaker': '親切な居酒屋の店主',
                'character': 'owner',
                'text': '落ち着け、とりあえず、交番にいきーーー',
                'expression': 'a'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': '、、、、、、、',
                'expression': 'c'
            },
            {
                'speaker': '交番',
                'character': 'police',
                'text': 'どうされました？？',
                'expression': 'a'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': 'うっ、、、うぅ、、、騙されました。。。。',
                'expression': 'c'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': '５０万をかりでぇ、、、そして、ドンキでお金渡して、、、、',
                'expression': 'c'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': 'うぅ、、、うっ、、、、、',
                'expression': 'c'
            },
            {
                'speaker': '交番',
                'character': 'police',
                'text': '証拠はありますでしょうか、、、、',
                'expression': 'a'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': 'なっ、、ないです、、、、、',
                'expression': 'c'
            },
            {
                'speaker': '交番',
                'character': 'police',
                'text': 'その人は、、どんな顔だった？？？',
                'expression': 'a'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': 'えっ、、絵は得意なので、、、',
                'expression': 'a'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': 'うぅ、、かっ、、描きます、、、、',
                'expression': 'c'
            },
            {
                'speaker': '交番',
                'character': 'police',
                'text': '、、、、、、',
                'expression': 'a'
            },
            {
                'speaker': '交番',
                'character': 'police',
                'text': '、、、、、、、、、',
                'expression': 'a'
            },
            {
                'speaker': '交番',
                'character': 'police',
                'text': '一応、これで捜査してみますが、、、',
                'expression': 'a'
            },
            {
                'speaker': '交番',
                'character': 'police',
                'text': '、、、こりゃ、、、見つかりはせんで、、、、',
                'expression': 'a'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': '、、、、、しばらくして、、、',
                'expression': 'c'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': 'その５０万円は帰ってくることはなかった、、、',
                'expression': 'c'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': 'ひろかずは目の前が真っ暗になった',
                'expression': 'c'
            }
        ]
    },
    
    // 路上の噴水エリア
    'rojyounopenki': {
        'background': 'test_1',
        'bgm': 'longing_Love',
        'conversations': [
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': '路上の噴水だな',
                'expression': 'a'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': '街の景観を良くしてるぜ',
                'expression': 'b'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': '夏は涼しそうだな',
                'expression': 'a'
            }
        ]
    },
    
    // テレビ塔エリア
    'tereapo': {
        'background': 'test_1',
        'bgm': 'curono',
        'conversations': [
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': 'テレビ塔だ！',
                'expression': 'a'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': '電波を送信してる重要な施設だな',
                'expression': 'b'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': '街のランドマークになってるぜ☆',
                'expression': 'a'
            }
        ]
    },
    
    // 初日の出エリア
    'first_rising_sun': {
        'background': 'test_1',
        'bgm': '紫電清霜',
        'conversations': [
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': '初日の出を見る場所だな',
                'expression': 'a'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': '新年の始まりを祝う場所だぜ',
                'expression': 'b'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': 'みんなで集まってお祝いするんだな',
                'expression': 'a'
            }
        ]
    },
    
    // 荒地エリア
    'arechi': {
        'background': 'test_1',
        'bgm': 'bloody_tears',
        'conversations': [
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': 'ここは荒地だな...',
                'expression': 'b'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': '開発が進んでいない場所だぜ',
                'expression': 'a'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': '将来は何か建つかもしれないな',
                'expression': 'c'
            }
        ]
    },
    
    // グレーバイトエリア
    'gray_bytes': {
        'background': 'test_1',
        'bgm': 'curono',
        'conversations': [
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': 'グレーバイト...',
                'expression': 'b'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': '何か秘密がありそうだな',
                'expression': 'a'
            },
            {
                'speaker': 'ひろかず',
                'character': 'hirokazu',
                'text': '調査してみるか？',
                'expression': 'c'
            }
        ]
    }
};

// 日本ステージ会話マネージャークラス
export class JapanConversationManager {
    constructor() {
        this.conversationData = japanConversationData;
        this.currentEvent = null;
        this.resourceManager = null; // リソース管理クラスの参照
    }
    
    // リソース管理クラスを設定
    setResourceManager(resourceManager) {
        this.resourceManager = resourceManager;
    }
    
    // マップ読み込み時の処理（基本データのみ、重いリソースは除外）
    async loadMap(mapName = 'japan') {
        if (!this.resourceManager) {
            throw new Error('ResourceManager not set');
        }
        
        try {
            console.log(`日本マップ「${mapName}」を読み込み中...`);
            
            // 基本データのみ読み込み（重いリソースは除外）
            await this.resourceManager.loadMapResources(mapName);
            
            console.log(`日本マップ「${mapName}」の読み込み完了`);
            return true;
        } catch (error) {
            console.error('マップ読み込みエラー:', error);
            throw error;
        }
    }

    getConversation(eventId) {
        return this.conversationData[eventId] || null;
    }

    getAvailableEvents() {
        return Object.keys(this.conversationData);
    }
    
    // イベント開始（リソース読み込み付き）
    async startEvent(eventId) {
        if (!this.resourceManager) {
            throw new Error('ResourceManager not set');
        }
        
        try {
            // 必要なリソースを読み込み
            await this.resourceManager.loadEventResources(eventId, this.conversationData);
            
            // イベントを開始
            this.currentEvent = eventId;
            return true;
        } catch (error) {
            console.error('Failed to start event:', error);
            throw error;
        }
    }
    
    // イベント終了
    endEvent() {
        if (this.resourceManager) {
            this.resourceManager.unloadResources();
        }
        this.currentEvent = null;
    }

    addConversation(eventId, conversationData) {
        this.conversationData[eventId] = conversationData;
    }

    updateConversation(eventId, conversationData) {
        this.conversationData[eventId] = conversationData;
    }
} 