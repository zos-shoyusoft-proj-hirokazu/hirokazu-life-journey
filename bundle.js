(()=>{"use strict";var e,t,a={61:(e,t,a)=>{a.r(t),a.d(t,{startPhaserGame:()=>F});const s=function(){let e,t;document.fullscreenElement?(e=screen.width,t=screen.height):(e=window.innerWidth,window.visualViewport?t=window.visualViewport.height:(t=window.innerHeight,/Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(t=Math.min(window.innerHeight,window.screen.height-100))));let a=e,s=t;return a=Math.max(320,a),s=Math.max(240,s),{width:a,height:s}}(),r=/iPad|iPhone|iPod/i.test(navigator.userAgent),i={type:Phaser.AUTO,width:s.width,height:s.height,backgroundColor:"#87CEEB",parent:"game-container",audio:{disableWebAudio:r,noAudio:!1},scale:{mode:Phaser.Scale.RESIZE,autoCenter:Phaser.Scale.CENTER_BOTH,expandParent:!0,fullscreenTarget:"game-container",resizeCallback:function(){}},physics:{default:"arcade",arcade:{gravity:{y:0},debug:!1,fps:60,timeScale:1,skipQuadTree:!1,maxEntries:12,tileBias:16,forceX:!1,overlapBias:4}},render:{antialias:!1,pixelArt:!1,clearBeforeRender:!0,preserveDrawingBuffer:!1,failIfMajorPerformanceCaveat:!1,powerPreference:"default"}};class o{constructor(e){this.scene=e,this.tilemap=null,this.mapLayer=null,this.areas=[],this.mapWidth=0,this.mapHeight=0,this.mapScaleX=1,this.mapScaleY=1,this.scaledMapWidth=0,this.scaledMapHeight=0,this.currentMapKey=null,this.map=null,this.layers=[],this.npcSprites=new Map,this.objectGroup=null}createMap(e,t,a){return e&&t?this.createNewMap(e,t,a):this.createLegacyMap()}createNewMap(e){this.currentMapKey=e;try{if(this.tilemap=this.scene.make.tilemap({key:e}),this.map=this.tilemap,!this.tilemap)return void console.error("[MapManager] ã‚¿ã‚¤ãƒ«ãƒãƒƒãƒ—ã®ä½œæˆã«å¤±æ•—ã—ã¾ã—ãŸ")}catch(e){throw console.error("[MapManager] ã‚¿ã‚¤ãƒ«ãƒãƒƒãƒ—ä½œæˆã‚¨ãƒ©ãƒ¼:",e),e}if(this.tilemap&&this.tilemap.tilesets&&this.tilemap.tilesets.length>0&&this.tilemap.tilesets.forEach((e=>{try{const t=Object.keys(this.scene.textures.list);let a=null;if(t.includes(e.name)&&(a=e.name),!a){const s=t.find((t=>e.name.includes(t)||t.includes(e.name)));s&&(a=s)}a&&this.tilemap&&this.tilemap.addTilesetImage(e.name,a)}catch(t){console.error(`[MapManager] ã‚¿ã‚¤ãƒ«ã‚»ãƒƒãƒˆå‡¦ç†ã‚¨ãƒ©ãƒ¼: ${e.name}`,t)}})),!(this.tilemap&&this.tilemap.layers&&this.tilemap.layers.length>0))return console.error("[MapManager] Tiledãƒãƒƒãƒ—ã«ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒå®šç¾©ã•ã‚Œã¦ã„ã¾ã›ã‚“"),this.tilemap;if(this.layers=[],this.tilemap.layers.forEach(((e,t)=>{try{if(this.tilemap&&this.tilemap.tilesets){const a=this.tilemap.createLayer(e.name,this.tilemap.tilesets,0,0);a&&(this.layers.push(a),0===t&&(this.mapLayer=a))}}catch(a){console.error(`[MapManager] âŒ ãƒ¬ã‚¤ãƒ¤ãƒ¼${t+1}ä½œæˆã‚¨ãƒ©ãƒ¼: ${e.name}`,a)}})),0===this.layers.length)return console.error("[MapManager] ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒä½œæˆã•ã‚Œã¦ã„ã¾ã›ã‚“"),this.tilemap;this.tilemap?(this.mapWidth=this.tilemap.widthInPixels||this.tilemap.width*this.tilemap.tileWidth||0,this.mapHeight=this.tilemap.heightInPixels||this.tilemap.height*this.tilemap.tileHeight||0):(this.mapWidth=0,this.mapHeight=0),this.scaleMapToScreen();const t=this.getObjectLayerName(e);this.extractAreaData(t),this.mapLayer&&(this.mapLayer.setVisible(!0),this.mapLayer.setDepth(0))}createLegacyMap(){try{const e=this.currentMapKey;if(!e)return void console.error("[MapManager] ãƒãƒƒãƒ—ã‚­ãƒ¼ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“");if(this.tilemap=this.scene.make.tilemap({key:e}),this.map=this.tilemap,!this.tilemap)return void console.error("[MapManager] ã‚¿ã‚¤ãƒ«ãƒãƒƒãƒ—ã®ä½œæˆã«å¤±æ•—ã—ã¾ã—ãŸ");if(e&&e.includes("taketa_highschool")){if(this.tilemap&&this.tilemap.tilesets&&this.tilemap.tilesets.length>0&&this.tilemap.tilesets.forEach((e=>{try{const t=Object.keys(this.scene.textures.list);let a=null;if(t.includes(e.name)&&(a=e.name),!a){const s=t.find((t=>e.name.includes(t)||t.includes(e.name)));s&&(a=s)}a&&this.tilemap.addTilesetImage(e.name,a)}catch(t){console.error(`[MapManager] ã‚¿ã‚¤ãƒ«ã‚»ãƒƒãƒˆå‡¦ç†ã‚¨ãƒ©ãƒ¼: ${e.name}`,t)}})),this.tilemap&&this.tilemap.layers&&this.tilemap.layers.length>0){if(this.layers=[],this.tilemap.layers.forEach(((e,t)=>{try{const a=[];this.tilemap.tilesets.forEach((e=>{if(e&&e.name){const t=Object.keys(this.scene.textures.list).find((t=>t.includes(e.name)));if(t){const s=this.tilemap.addTilesetImage(e.name,t);s&&a.push(s)}}})),0===a.length&&console.warn(`[MapManager] âš ï¸ ãƒ¬ã‚¤ãƒ¤ãƒ¼${t+1}ç”¨ã®å®Ÿéš›ã®ã‚¿ã‚¤ãƒ«ã‚»ãƒƒãƒˆãŒã‚ã‚Šã¾ã›ã‚“: ${e.name}`);const s=this.tilemap.createLayer(e.name,a,0,0);if(s){let a;a=e.name.includes("åºŠ")?0:50+t,s.setDepth(a),s.setVisible(!0),this.layers.push(s),0===t&&(this.mapLayer=s)}}catch(a){console.error(`[MapManager] âŒ ãƒ¬ã‚¤ãƒ¤ãƒ¼${t+1}ä½œæˆã‚¨ãƒ©ãƒ¼: ${e.name}`,a)}})),this.mapWidth=this.tilemap.widthInPixels||this.tilemap.width*this.tilemap.tileWidth||0,this.mapHeight=this.tilemap.heightInPixels||this.tilemap.height*this.tilemap.tileHeight||0,this.tilemap){const e=["ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒ¬ã‚¤ãƒ¤ãƒ¼1","ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒ¬ã‚¤ãƒ¤ãƒ¼2"];console.log("[MapManager] ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒ¬ã‚¤ãƒ¤ãƒ¼å‡¦ç†é–‹å§‹"),console.log(`[MapManager] tilemapæƒ…å ±: å¹…=${this.tilemap.width}, é«˜ã•=${this.tilemap.height}, ã‚¿ã‚¤ãƒ«å¹…=${this.tilemap.tileWidth}, ã‚¿ã‚¤ãƒ«é«˜ã•=${this.tilemap.tileHeight}`),e.forEach((e=>{const t=this.tilemap.getObjectLayer(e);if(t){const a=t.width||this.tilemap.widthInPixels||this.tilemap.width*this.tilemap.tileWidth||0,s=t.height||this.tilemap.heightInPixels||this.tilemap.height*this.tilemap.tileHeight||0;console.log(`[MapManager] ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒ¬ã‚¤ãƒ¤ãƒ¼ç™ºè¦‹: ${e}, å¹…: ${a}, é«˜ã•: ${s}`),t.width=a,t.height=s,this.processObjectLayer(e)}else console.warn(`[MapManager] ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: ${e}`)}))}else console.warn("[MapManager] tilemapãŒå­˜åœ¨ã—ã¾ã›ã‚“");if(this.tilemap&&this.tilemap.layers){const e=this.tilemap.layers.filter((e=>"objectgroup"===e.type));e.length>0&&this.extractAreaData(e[0].name)}}}else{const e=this.createTilesets();this.createLayers(e),this.placeObjects()}}catch(e){console.error("[MapManager] createLegacyMapã‚¨ãƒ©ãƒ¼:",e)}}processAllAvailableObjectLayers(){this.tilemap&&this.tilemap.layers?this.tilemap.layers.filter((e=>"objectgroup"===e.type)).forEach((e=>{this.processObjectLayer(e.name)})):console.warn("[MapManager] tilemapã¾ãŸã¯layersãŒå­˜åœ¨ã—ã¾ã›ã‚“")}processObjectLayer(e){try{if(!this.tilemap)return void console.warn("[MapManager] tilemapãŒå­˜åœ¨ã—ã¾ã›ã‚“");const t=this.tilemap.getObjectLayer(e);if(!t)return void console.warn(`[MapManager] ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒ¬ã‚¤ãƒ¤ãƒ¼ '${e}' ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“`);this.objectGroup||(this.objectGroup=this.scene.physics.add.staticGroup()),t.objects.forEach(((e,t)=>{let a=e.x||0,s=e.y||0;const r=this.tilemap.scale||this.tilemap.scaleX||1;1!==r&&(a*=r,s*=r),a+=this.tilemap.x||this.tilemap.scrollX||0,s+=this.tilemap.y||this.tilemap.scrollY||0,this.mapLayer&&(a+=this.mapLayer.x||0,s+=this.mapLayer.y||0);const i=e.width||32,o=e.height||32,n=e.type||"wall",c=e.name||`object_${t}`,h=a+i/2,l=s+o/2;let p=0;"move"===n&&(p=255);const g=this.scene.add.rectangle(h,l,i,o,p,.5);this.scene.physics.add.existing(g,!0),this.objectGroup.add(g);const u=this.scene.add.text(h,l-o/2-10,`${c} (${n})`,{fontSize:"12px",fill:"#ffffff",backgroundColor:"#000000",padding:{x:2,y:1}});u.setOrigin(.5,1),u.setDepth(1e3),g.setData("objectType",n),g.setData("objectName",c),g.setData("objectId",e.id),"move"===n&&(g.setData("moveId",c),g.setData("moveType",n),console.log(`[MapManager] moveã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ: ${c}, åº§æ¨™: (${h}, ${l}), ã‚µã‚¤ã‚º: ${i}x${o}`)),g.setData("objectType",n),g.setData("objectName",c),g.setData("originalData",e)}))}catch(e){console.error("[MapManager] ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒ¬ã‚¤ãƒ¤ãƒ¼å‡¦ç†ã‚¨ãƒ©ãƒ¼:",e)}}scaleMapToScreen(){const e=this.scene.cameras.main.width,t=this.scene.cameras.main.height,a=e/this.mapWidth,s=t/this.mapHeight,r=Math.min(a,s);if(this.scene.cameraManager&&(this.scene.cameraManager.currentScale=r),this.mapScaleX=r,this.mapScaleY=r,this.mapLayer){this.mapLayer.setScale(this.mapScaleX,this.mapScaleY);const a=(e-this.mapWidth*this.mapScaleX)/2,s=(t-this.mapHeight*this.mapScaleY)/2;this.mapLayer.setPosition(a,s)}if(this.scaledMapWidth=this.mapWidth*this.mapScaleX,this.scaledMapHeight=this.mapHeight*this.mapScaleY,this.scene.cameraManager){this.scene.cameraManager.camera.setBounds(0,0,e,t),this.scene.cameraManager.camera.setBackgroundColor("#87CEEB");const a=this.mapLayer?this.mapLayer.x:0,s=this.mapLayer?this.mapLayer.y:0;this.scene.cameraManager.camera.centerOn(a+this.scaledMapWidth/2,s+this.scaledMapHeight/2)}this.updateObjectPositions(this.mapScaleX)}getObjectLayerName(){return this.currentMapKey&&this.currentMapKey.includes("highschool")?"ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒ¬ã‚¤ãƒ¤ãƒ¼1":this.currentMapKey&&this.currentMapKey.includes("taketa")&&!this.currentMapKey.includes("highschool")?"taketa":this.currentMapKey&&this.currentMapKey.includes("miemachi")?"miemachi":this.currentMapKey&&this.currentMapKey.includes("japan")?"japan":"ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒ¬ã‚¤ãƒ¤ãƒ¼1"}extractAreaData(e=null){if(!e){const t=this.scene.mapConfig?.mapKey||"taketa";e=this.getObjectLayerName(t)}if(!e)return void console.warn(`MapManager: No object layer name found for mapKey '${this.scene.mapConfig?.mapKey}'`);let t=null;try{"function"==typeof this.tilemap.getObjectLayer&&(t=this.tilemap.getObjectLayer(e))}catch(e){}if(!t&&Array.isArray(this.tilemap.objects)&&(t=this.tilemap.objects.find((t=>t&&t.name===e))),t||console.warn(`[MapManager] ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒ¬ã‚¤ãƒ¤ãƒ¼'${e}'ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“`),t&&t.objects)this.areas=[],this.areas=t.objects.map((e=>({id:e.id,name:e.name,originalX:e.x,originalY:e.y,originalWidth:e.width,originalHeight:e.height,x:e.x*this.mapScaleX+(this.mapLayer?this.mapLayer.x:0),y:e.y*this.mapScaleY+(this.mapLayer?this.mapLayer.y:0),width:e.width*this.mapScaleX,height:e.height*this.mapScaleY,ellipse:e.ellipse||!1,rotation:e.rotation||0,type:e.type||"location"})));else{console.warn(`[MapManager] Object layer '${e}' not found or has no objects`);const t=this.tilemap.layers.find((e=>"objectgroup"===e.type));t&&this.extractAreaData(t.name)}}handleResize(){this.scaleMapToScreen();const e=this.scene.mapConfig?.mapKey||this.currentMapKey;if(e){const t=this.getObjectLayerName(e);this.extractAreaData(t)}}createFallbackImage(e){const t=this.scene.add.graphics();t.fillStyle(65280),t.fillRect(0,0,32,32),t.generateTexture(e,32,32),t.destroy()}getTilemap(){return this.tilemap}getMapLayer(){return this.mapLayer}getAreas(){return this.areas}getMapSize(){return{width:this.mapWidth,height:this.mapHeight,scaledWidth:this.scaledMapWidth,scaledHeight:this.scaledMapHeight}}getMapScale(){return{scaleX:this.mapScaleX,scaleY:this.mapScaleY}}updateObjectPositions(e){if(this.areas&&this.areas.length>0){const t=this.mapLayer?this.mapLayer.x:0,a=this.mapLayer?this.mapLayer.y:0;this.areas.forEach((s=>{s.x=s.originalX*e+t,s.y=s.originalY*e+a,s.width=s.originalWidth*e,s.height=s.originalHeight*e})),this.scaledMapWidth=this.mapWidth*e,this.scaledMapHeight=this.mapHeight*e,this.scene.areaSelectionManager&&this.scene.areaSelectionManager.updateAreaPositions([...this.areas])}else console.warn("MapManager: No areas available for position update")}createTilesets(){const e=[],t={"[A]Grass1_pipo":"[A]Grass1_pipo",backgraund:"pipo-map001_at-kusa",GK_A2_C_autotile:"GK_A2_C_autotile",Preview_RPGMakerVXAce:"Preview_RPGMakerVXAce",Preview:"Preview",GK_JC_A5_2:"GK_JC_A5_2",GK_JC_B_2:"GK_JC_B_2",tiles:"tiles",tileset:"tiles",Tilemap:"Tilemap"},a=[{keyword:"GK_A2_C",texture:"GK_A2_C_autotile"},{keyword:"Preview_RPGMaker",texture:"Preview_RPGMakerVXAce"},{keyword:"GK_JC_A5",texture:"GK_JC_A5_2"},{keyword:"GK_JC_B",texture:"GK_JC_B_2"},{keyword:"Tilemap",texture:"Tilemap"}];return this.map.tilesets.forEach((s=>{let r=null;const i=s.name,o=s.tileWidth||32,n=s.tileHeight||32;let c=t[i];if(!c){const e=a.find((e=>i.includes(e.keyword)));c=e?e.texture:"tiles",e||console.warn(`Unknown tileset: ${i}, using tiles.png as fallback`)}r=this.map.addTilesetImage(i,c,o,n),r&&e.push(r)})),e}createLayers(){try{if(!this.tilemap)return void console.warn("[MapManager] tilemapãŒå­˜åœ¨ã—ã¾ã›ã‚“");this.tilemap.tilesets&&this.tilemap.tilesets.length>0&&this.tilemap.tilesets.forEach((e=>{try{const t=Object.keys(this.scene.textures.list).find((t=>t.includes(e.name.replace(/[!@#$%^&*()]/g,""))));t&&this.tilemap.addTilesetImage(e.name,t)}catch(t){console.warn(`[MapManager] ã‚¿ã‚¤ãƒ«ã‚»ãƒƒãƒˆè¿½åŠ ã‚¨ãƒ©ãƒ¼: ${e.name}`,t)}})),this.layers=[],this.tilemap.layers&&this.tilemap.layers.forEach(((e,t)=>{try{if("tilelayer"===e.type){const a=this.tilemap.createLayer(e.name,this.tilemap.tilesets,0,0);if(a){let s;s=e.name.includes("åºŠ")?0:50+t,a.setDepth(s),this.layers.push(a),0===t&&(this.mapLayer=a)}}}catch(t){console.warn(`[MapManager] ãƒ¬ã‚¤ãƒ¤ãƒ¼ä½œæˆã‚¨ãƒ©ãƒ¼: ${e.name}`,t)}}))}catch(e){console.error("[MapManager] ãƒ¬ã‚¤ãƒ¤ãƒ¼ä½œæˆã‚¨ãƒ©ãƒ¼:",e)}}placeObjects(){this.objectGroup=this.scene.physics.add.staticGroup(),this.map.objects.forEach((e=>{e.objects.forEach((e=>{const t=e.name;if(this.scene.textures.exists(t)){const a=this.scene.add.sprite(e.x,e.y,t,1);let s;if(a.setOrigin(0,0),a.setScale(1),s="npc"===e.type?200:"wall"===e.type||"å»ºç‰©"===e.type?150:75,a.setDepth(s),"npc"===e.type)this.npcSprites.set(e.name,a),this.scene.collisionManager.addObjectToCollision(a,{type:"npc",width:e.width||32,height:e.height||32,name:e.name});else{let t=!1;if(e.properties&&Array.isArray(e.properties)){const a=e.properties.find((e=>"collides"===e.name));t=a&&!0===a.value}if(t){let t=e.type||"wall";this.scene.collisionManager.addObjectToCollision(a,{type:t,width:e.width||32,height:e.height||32,name:e.name})}}}else console.warn(`Image not found: ${t} - ã‚¹ãƒ—ãƒ©ã‚¤ãƒˆä½œæˆã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ã¾ã™`)}))}))}createFallbackMap(){try{const e=this.map.addTilesetImage("tileset","tiles",32,32),t=this.map.createLayer(0,e,0,0);t&&(this.layers.push(t),t.setDepth(-1),t.setCollisionByProperty({collides:!0}))}catch(e){console.error("Fallback also failed:",e)}}getObjectGroup(){return this.objectGroup}getNpcSprite(e){return this.npcSprites.get(e)}makeNpcFacePlayer(e,t,a){const s=this.getNpcSprite(e);if(!s)return void console.warn(`NPC sprite not found: ${e}`);const r=t-s.x,i=a-s.y;let o,n;switch(o=Math.abs(r)>Math.abs(i)?r>0?"right":"left":i>0?"down":"up",o){case"down":default:n=1;break;case"left":n=4;break;case"right":n=7;break;case"up":n=10}s.setFrame(n)}destroy(){this.layers&&this.layers.length>0&&(this.layers.forEach((e=>{e&&e.destroy&&e.destroy()})),this.layers=[]),this.mapLayer&&this.mapLayer.destroy&&(this.mapLayer.destroy(),this.mapLayer=null),this.tilemap&&this.tilemap.destroy&&(this.tilemap.destroy(),this.tilemap=null),this.map&&this.map.destroy&&(this.map.destroy(),this.map=null),this.npcSprites&&(this.npcSprites.forEach((e=>{e&&e.destroy&&e.destroy()})),this.npcSprites.clear()),this.objectGroup&&this.objectGroup.destroy&&(this.objectGroup.destroy(),this.objectGroup=null),this.areas=[],this.mapWidth=0,this.mapHeight=0,this.mapScaleX=1,this.mapScaleY=1,this.scaledMapWidth=0,this.scaledMapHeight=0}}class n{constructor(e){this.scene=e,this.player=null,this.cursors=null,this.wasd=null,this.speed=300}createPlayer(e,t){if(!this.scene.textures.exists("player_placeholder")){const e=document.createElement("canvas");e.width=1,e.height=1;const t=e.getContext("2d");t.fillStyle="#000000",t.fillRect(0,0,1,1),this.scene.textures.addCanvas("player_placeholder",e)}this.player=this.scene.physics.add.sprite(e,t,"player_placeholder"),this.player.setDisplaySize(30,30),this.player.setDepth(40),this.player.setAlpha(1),this.player.clearTint(),this.player.setTint(0),this.player.setCollideWorldBounds(!0),this.player.setBounce(0),this.player.setDrag(200),this.scene.time.delayedCall(100,(()=>{this.player&&(this.player.setDepth(40),this.player.setAlpha(1),this.player.clearTint(),this.player.setTint(0))})),this.scene.time.addEvent({delay:1e3,callback:this.checkPlayerState,callbackScope:this,loop:!0}),this.monitorPlayerChanges()}checkPlayerState(){this.player&&(this.player.alpha<1&&this.player.setAlpha(1),40!==this.player.depth&&this.player.setDepth(40))}monitorPlayerChanges(){if(console.log("[PlayerController] ç›£è¦–é–‹å§‹"),this.player){console.log("[PlayerController] ä¸»äººå…¬ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆç¢ºèª: å­˜åœ¨ã—ã¾ã™");const e=this.player.depth;console.log("[PlayerController] å…ƒã®æ·±åº¦:",e);const t=setInterval((()=>{this.player&&this.player.depth!==e&&(console.log("[PlayerController] âš ï¸ æ·±åº¦ãŒå¤‰æ›´ã•ã‚Œã¾ã—ãŸ:",e,"â†’",this.player.depth),this.player.setDepth(40),console.log("[PlayerController] æ·±åº¦ã‚’å…ƒã«æˆ»ã—ã¾ã—ãŸ: 40"))}),100),a=this.player.alpha;console.log("[PlayerController] å…ƒã®é€æ˜åº¦:",a);const s=setInterval((()=>{this.player&&this.player.alpha!==a&&(console.log("[PlayerController] âš ï¸ é€æ˜åº¦ãŒå¤‰æ›´ã•ã‚Œã¾ã—ãŸ:",a,"â†’",this.player.alpha),this.player.setAlpha(1),console.log("[PlayerController] é€æ˜åº¦ã‚’å…ƒã«æˆ»ã—ã¾ã—ãŸ: 1.0"))}),100),r=this.player.tint;console.log("[PlayerController] å…ƒã®è‰²èª¿:",r);const i=setInterval((()=>{this.player&&this.player.tint!==r&&(console.log("[PlayerController] âš ï¸ è‰²èª¿ãŒå¤‰æ›´ã•ã‚Œã¾ã—ãŸ:",r,"â†’",this.player.tint),this.player.clearTint(),this.player.setTint(0),this.player.setTint(0),this.player.setTint(0),console.log("[PlayerController] è‰²èª¿ã‚’å…ƒã«æˆ»ã—ã¾ã—ãŸ: 0x000000"))}),50);this._monitoringTimers=[t,s,i],console.log("[PlayerController] ç›£è¦–ã‚¿ã‚¤ãƒãƒ¼è¨­å®šå®Œäº†")}else console.log("[PlayerController] ä¸»äººå…¬ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆç¢ºèª: å­˜åœ¨ã—ã¾ã›ã‚“")}setInputKeys(e,t){this.cursors=e,this.wasd=t}update(){if(console.log("[PlayerController] update() å‘¼ã³å‡ºã—"),!this.player)return void console.warn("[PlayerController] ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒå­˜åœ¨ã—ã¾ã›ã‚“");if(this.cursors&&this.wasd){let e=0,t=0;this.cursors.left.isDown||this.wasd.A.isDown?e=-this.speed:(this.cursors.right.isDown||this.wasd.D.isDown)&&(e=this.speed),this.cursors.up.isDown||this.wasd.W.isDown?t=-this.speed:(this.cursors.down.isDown||this.wasd.S.isDown)&&(t=this.speed),this.player.setVelocityX(e),this.player.setVelocityY(t)}console.log(`[PlayerController] ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ä½ç½®: (${this.player.x}, ${this.player.y})`);let e=766,t=895;if(this.scene&&this.scene.collisionManager){const a=this.scene.mapManager;if(a&&a.objectGroup){const s=a.objectGroup.children.entries.find((e=>"move"===e.getData("objectType")));s&&(e=s.x,t=s.y,console.log(`[PlayerController] å®Ÿéš›ã®moveã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆåº§æ¨™: (${e}, ${t})`))}}const a=Math.sqrt(Math.pow(this.player.x-e,2)+Math.pow(this.player.y-t,2));if(a<100){if(console.log(`[PlayerController] âš ï¸ moveã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«è¿‘ã¥ã„ã¦ã„ã¾ã™: è·é›¢=${a.toFixed(2)}`),this.scene&&this.scene.collisionManager){const e=this.scene.mapManager;if(e&&e.objectGroup){const t=e.objectGroup.children.entries.find((e=>"move"===e.getData("objectType")));t&&(console.log("[PlayerController] moveã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆè©³ç´°:"),console.log(`  - è¦‹ãŸç›®ã®åº§æ¨™: (${t.x}, ${t.y})`),console.log(`  - è¦‹ãŸç›®ã®ã‚µã‚¤ã‚º: ${t.width} x ${t.height}`),console.log("  - ç‰©ç†ãƒœãƒ‡ã‚£:",t.body),t.body&&(console.log(`  - ç‰©ç†ãƒœãƒ‡ã‚£åº§æ¨™: (${t.body.x}, ${t.body.y})`),console.log(`  - ç‰©ç†ãƒœãƒ‡ã‚£ã‚µã‚¤ã‚º: ${t.body.width} x ${t.body.height}`),console.log(`  - ç‰©ç†ãƒœãƒ‡ã‚£ã®ä¸­å¿ƒ: (${t.body.center.x}, ${t.body.center.y})`)))}}a<50&&(console.log(`[PlayerController] ğŸ”¥ moveã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«éå¸¸ã«è¿‘ã„ã§ã™: è·é›¢=${a.toFixed(2)}`),console.log(`[PlayerController] ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼åº§æ¨™: (${this.player.x}, ${this.player.y})`),console.log(`[PlayerController] moveã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆåº§æ¨™: (${e}, ${t})`),this.player.body&&console.log("[PlayerController] ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®ç‰©ç†ãƒœãƒ‡ã‚£:",this.player.body))}}setVelocity(e,t){this.player&&(this.player.setVelocityX(e),this.player.setVelocityY(t))}getPosition(){return this.player?{x:this.player.x,y:this.player.y}:{x:0,y:0}}destroy(){try{this.player&&(this.player.destroy(),this.player=null),this.cursors=null,this.wasd=null}catch(e){console.error("Error during PlayerController cleanup:",e)}}}class c{constructor(e){this.scene=e,this.activeEffects=[]}showTouchRipple(e,t,a=65280,s=400){const r=this.scene.add.circle(e,t,10,a,.7);r.setDepth(9999),this.scene.tweens.add({targets:r,scaleX:5,scaleY:5,alpha:0,duration:s,ease:"Power2",onComplete:()=>{r.destroy()}}),this.activeEffects.push(r)}showObjectRipple(e,t,a,s,r=16711680,i=400){const o=Math.max(a,s)/2,n=this.scene.add.circle(e,t,o,r,.7);n.setDepth(9999),this.scene.tweens.add({targets:n,scaleX:3,scaleY:3,alpha:0,duration:i,ease:"Power2",onComplete:()=>{n.destroy()}}),this.activeEffects.push(n)}showButtonHover(e,t=1.2,a=16766720,s=.7){e.setScale&&e.setScale(t),e.setFillStyle&&e.setFillStyle(a,s)}resetButtonState(e,t=1,a=4286945,s=.7){e.setScale&&e.setScale(t),e.setFillStyle&&e.setFillStyle(a,s)}showSelectionEffect(e,t,a=16776960,s=16711680){const r=this.scene.add.circle(e,t,30,a,.6);r.setStrokeStyle(4,s),this.scene.tweens.add({targets:r,scaleX:2,scaleY:2,alpha:0,duration:800,ease:"Power2",onComplete:()=>{r.destroy()}}),this.activeEffects.push(r)}destroy(){this.activeEffects&&this.activeEffects.length>0&&(this.activeEffects.forEach((e=>{e&&e.destroy&&e.destroy()})),this.activeEffects=[]),this.scene=null}}class h{constructor(e,t,a="se_touch"){this.scene=e,this.player=t,this.seKey=a,this.visualFeedback=new c(e),this.touchStartX=0,this.touchStartY=0,this.isPointerDown=!1,this.targetX=0,this.targetY=0,this.setupVirtualGamepad(),this.scene.input.on("pointerdown",(e=>{try{if(this.scene.sound&&this.scene.sound.locked){try{this.scene.sound.context&&"running"!==this.scene.sound.context.state&&this.scene.sound.context.resume()}catch(e){}try{const e=this.scene.sound.context;if(e&&"function"==typeof e.createOscillator){const t=e.createOscillator(),a=e.createGain();a.gain.value=1e-4,t.connect(a).connect(e.destination),t.start(),t.stop(e.currentTime+.05)}}catch(e){}}}catch(e){}if(this.scene.cameras&&this.scene.cameras.main){const t=this.scene.cameras.main.getWorldPoint(e.x,e.y);this.showTouchFeedback(t.x,t.y)}else this.showTouchFeedback(e.x,e.y)}))}setupVirtualGamepad(){const e=this.scene.scale.width-120,t=this.scene.scale.height-120;this.baseCircle=this.scene.add.circle(e,t,50,3355443,.6),this.baseCircle.setScrollFactor(0),this.baseCircle.setStrokeStyle(2,5592405),this.baseCircle.setDepth(1e3),this.stickCircle=this.scene.add.circle(e,t,20,8947848,.9),this.stickCircle.setScrollFactor(0),this.stickCircle.setStrokeStyle(2,11184810),this.stickCircle.setDepth(1001),this.centerX=e,this.centerY=t,this.maxDistance=40,this.currentInput={x:0,y:0},this.isStickActive=!1,this.currentPointerId=null;const a=this.scene.add.circle(e,t,80,0,.01);a.setScrollFactor(0),a.setDepth(999),a.setInteractive(),this.touchArea=a,a.on("pointerdown",(e=>{null===this.currentPointerId&&this.startStickControl(e)})),this.scene.input.on("pointermove",(e=>{this.isStickActive&&e.id===this.currentPointerId&&this.updateStick(e.x,e.y)})),this.scene.input.on("pointerup",(e=>{this.isStickActive&&e.id===this.currentPointerId&&this.endStickControl()})),this.scene.scale.on("resize",this.handleResize,this)}startStickControl(e){this.isStickActive=!0,this.currentPointerId=e.id,this.stickCircle.setAlpha(1),this.baseCircle.setAlpha(.8),this.updateStick(e.x,e.y)}endStickControl(){this.isStickActive=!1,this.currentPointerId=null,this.resetStick(),this.stickCircle.setAlpha(.9),this.baseCircle.setAlpha(.6)}handleResize(){const e=this.scene.scale.width,t=this.scene.scale.height;this.centerX=e-120,this.centerY=t-120,this.baseCircle.setPosition(this.centerX,this.centerY),this.stickCircle.setPosition(this.centerX,this.centerY),this.touchArea&&this.touchArea.setPosition(this.centerX,this.centerY)}updateStick(e,t){const a=e-this.centerX,s=t-this.centerY;let r=e,i=t;if(Math.sqrt(a*a+s*s)>this.maxDistance){const e=Math.atan2(s,a);r=this.centerX+Math.cos(e)*this.maxDistance,i=this.centerY+Math.sin(e)*this.maxDistance}this.stickCircle.x=r,this.stickCircle.y=i;const o=(r-this.centerX)/this.maxDistance,n=(i-this.centerY)/this.maxDistance;if(this.currentInput.x=o,this.currentInput.y=n,Math.sqrt(o*o+n*n)<.05)return void(this.player&&this.player.setVelocityX&&(this.player.setVelocityX(0),this.player.setVelocityY(0)));const c=450*o,h=450*n;this.player&&this.player.setVelocityX&&(this.player.setVelocityX(c),this.player.setVelocityY(h))}resetStick(){this.stickCircle.x=this.centerX,this.stickCircle.y=this.centerY,this.currentInput.x=0,this.currentInput.y=0,this.player&&this.player.setVelocityX&&(this.player.setVelocityX(0),this.player.setVelocityY(0))}getCurrentInput(){return{...this.currentInput}}enableAreaSelection(e){this.areaSelectionManager=e,this.hideVirtualGamepad(),this.setupAreaSelectionTouch()}hideVirtualGamepad(){this.baseCircle&&this.baseCircle.setVisible(!1),this.stickCircle&&this.stickCircle.setVisible(!1)}showVirtualGamepad(){this.baseCircle&&this.baseCircle.setVisible(!0),this.stickCircle&&this.stickCircle.setVisible(!0)}setupAreaSelectionTouch(){this.scene.input.on("pointerdown",(e=>{this.handleAreaSelectionTouch(e)})),this.touchStartTime=0,this.longPressThreshold=500}handleAreaSelectionTouch(e){try{if(this.touchStartTime=Date.now(),!this.scene.cameras||!this.scene.cameras.main)return void console.error("TouchControlManager: Camera not available");const t=this.scene.cameras.main.getWorldPoint(e.x,e.y),a=t.x,s=t.y;this.areaSelectionManager&&this.areaSelectionManager.handleTouchAt(a,s),this.showTouchFeedback(a,s)}catch(e){console.error("TouchControlManager: Error in handleAreaSelectionTouch:",e)}}showTouchFeedback(e,t){try{this.visualFeedback.showTouchRipple(e,t),this.scene.audioManager&&this.scene.audioManager.playSe&&this.scene.audioManager.playSe(this.seKey,.3)}catch(e){console.warn("TouchControlManager: Error in showTouchFeedback:",e)}}disableAreaSelection(){this.areaSelectionManager=null,this.showVirtualGamepad(),this.scene.input.off("pointerdown")}destroy(){this.baseCircle&&this.baseCircle.destroy(),this.stickCircle&&this.stickCircle.destroy(),this.scene.scale.off("resize",this.handleResize,this)}updatePosition(e,t){if(this.baseCircle&&this.stickCircle){const a=120,s=e-a,r=t-a;this.baseCircle.setPosition(s,r),this.stickCircle.setPosition(s,r),this.centerX=s,this.centerY=r,this.touchArea&&this.touchArea.setPosition(s,r),this.isStickActive&&(this.stickCircle.setPosition(this.centerX,this.centerY),this.currentInput={x:0,y:0}),console.log("[TouchControlManager] ä½ç½®æ›´æ–°å®Œäº†:",{width:e,height:t,padX:s,padY:r})}}}class l{constructor(){this.playerPosText=null,this.backButton=null}createUI(e){e.add.text(400,50,"â˜…â˜…â˜…ãƒ†ã‚¹ãƒˆä¸­â˜…â˜…â˜…bbbbb",{fontSize:"24px",fill:"#000000",fontWeight:"bold"}).setOrigin(.5),e.add.text(400,550,"çŸ¢å°ã‚­ãƒ¼ã¾ãŸã¯WASDã§ç§»å‹•ï¼ãƒãƒƒãƒ—ä¸Šã‚’æ­©ã„ã¦ã¿ã‚ˆã†ï¼",{fontSize:"16px",fill:"#000000"}).setOrigin(.5),this.playerPosText=e.add.text(10,10,"",{fontSize:"16px",fill:"#000000",backgroundColor:"#ffffff",padding:{x:5,y:5}}),this.createBackButton(e)}createBackButton(e){if(!e||!e.cameras||!e.cameras.main)return void console.warn("UIManager: Scene or camera is not available for back button");if(!e.input)return void console.warn("UIManager: Scene input system is not available for back button");this.backButtonGraphics=e.add.graphics(),this.backButtonGraphics.fillStyle(0,.3),this.backButtonGraphics.fillRoundedRect(4.5,4.5,155,30,8),this.backButtonGraphics.fillStyle(2763306,.95),this.backButtonGraphics.fillRoundedRect(2.5,2.5,155,30,8),this.backButtonGraphics.fillStyle(16777215,.1),this.backButtonGraphics.fillRoundedRect(2.5,2.5,155,15,8),this.backButtonGraphics.setDepth(1e3),this.backButtonGraphics.setScrollFactor(0),this.backButtonGraphics.setInteractive(new Phaser.Geom.Rectangle(5,5,150,40),Phaser.Geom.Rectangle.Contains);let t="æˆ»ã‚‹";e.scene&&e.scene.key&&("Stage1Scene"===e.scene.key||"Stage2Scene"===e.scene.key||"Stage3Scene"===e.scene.key?t="ãƒãƒƒãƒ—ã«æˆ»ã‚‹":"MiemachiStage"!==e.scene.key&&"TaketastageStage"!==e.scene.key&&"JapanStage"!==e.scene.key||(t="ã‚¹ãƒ†ãƒ¼ã‚¸é¸æŠç”»é¢")),this.backButtonGraphics.on("pointerdown",((t,a,s,r)=>{try{r&&r.preventDefault&&r.preventDefault()}catch(e){}try{r&&r.stopImmediatePropagation&&r.stopImmediatePropagation()}catch(e){}if("Stage1Scene"===e.scene?.key||"Stage2Scene"===e.scene?.key||"Stage3Scene"===e.scene?.key){try{e.input&&e.input.removeAllListeners&&e.input.removeAllListeners("pointerdown")}catch(e){}try{e.sound&&e.sound.removeAllListeners&&e.sound.removeAllListeners("unlocked")}catch(e){}try{e.sound&&e.sound.stopAll&&e.sound.stopAll()}catch(e){}try{e.audioManager&&e.audioManager.stopAll&&e.audioManager.stopAll()}catch(e){}try{e._htmlBgm&&(e._htmlBgm.pause(),e._htmlBgm=null)}catch(e){}try{e._eventHtmlBgm&&(e._eventHtmlBgm.pause(),e._eventHtmlBgm=null)}catch(e){}try{e.load&&e.load.reset&&e.load.reset()}catch(e){}try{e.load&&e.load.removeAllListeners&&e.load.removeAllListeners()}catch(e){}try{e.scene&&e.scene.get&&e.scene.get("ConversationScene")&&e.scene.remove("ConversationScene")}catch(e){}const t=()=>{if(window.returnToMap)window.returnToMap();else if(window.returnToStageSelect)window.returnToStageSelect();else if(window.returnToMiemachi)window.returnToMiemachi();else{const e=document.getElementById("stage-select"),t=document.getElementById("game-container");e&&(e.style.display="flex"),t&&(t.style.display="none")}};try{requestAnimationFrame((()=>setTimeout(t,0)))}catch(e){t()}}else if("MiemachiStage"===e.scene?.key||"TaketastageStage"===e.scene?.key||"JapanStage"===e.scene?.key){window.returnToMap=null;try{e._suppressMapBgm=!0}catch(e){}try{e._bgmRetry&&e._bgmRetry.remove&&(e._bgmRetry.remove(!1),e._bgmRetry=null)}catch(e){}try{e.input&&e.input.removeAllListeners&&e.input.removeAllListeners("pointerdown")}catch(e){}try{e._htmlBgm&&(e._htmlBgm.pause(),e._htmlBgm=null)}catch(e){}try{e.audioManager&&e.audioManager.stopAll&&e.audioManager.stopAll()}catch(e){}try{e.sound&&e.sound.removeAllListeners&&e.sound.removeAllListeners("unlocked")}catch(e){}const t=()=>{try{if(window.returnToStageSelect)window.returnToStageSelect();else{const e=document.getElementById("stage-select"),t=document.getElementById("game-container");e&&(e.style.display="flex"),t&&(t.style.display="none")}}catch(e){}};try{requestAnimationFrame((()=>setTimeout(t,0)))}catch(e){t()}}else if("taketa_highschool"===e.scene?.key){const t=()=>{window.returnToTaketaMap?window.returnToTaketaMap():e.scene.start("TaketastageStage")};try{requestAnimationFrame((()=>setTimeout(t,0)))}catch(e){t()}}else{const e=()=>{if(window.returnToStageSelect)window.returnToStageSelect();else{const e=document.getElementById("stage-select"),t=document.getElementById("game-container");e&&(e.style.display="flex"),t&&(t.style.display="none")}};try{requestAnimationFrame((()=>setTimeout(e,0)))}catch(t){e()}}})),e.input&&e.input.keyboard&&e.input.keyboard.on("keydown-ESC",(()=>{if(window.returnToStageSelect)window.returnToStageSelect();else{const e=document.getElementById("stage-select"),t=document.getElementById("game-container");e&&(e.style.display="block"),t&&(t.style.display="none")}})),this.backButtonGraphics.on("pointerover",(()=>{this.backButtonGraphics.clear(),this.backButtonGraphics.fillStyle(0,.4),this.backButtonGraphics.fillRoundedRect(4.5,4.5,155,30,8),this.backButtonGraphics.fillStyle(3815994,.98),this.backButtonGraphics.fillRoundedRect(2.5,2.5,155,30,8),this.backButtonGraphics.fillStyle(16777215,.15),this.backButtonGraphics.fillRoundedRect(2.5,2.5,155,15,8)})),this.backButtonGraphics.on("pointerout",(()=>{this.backButtonGraphics.clear(),this.backButtonGraphics.fillStyle(0,.3),this.backButtonGraphics.fillRoundedRect(4.5,4.5,155,30,8),this.backButtonGraphics.fillStyle(2763306,.95),this.backButtonGraphics.fillRoundedRect(2.5,2.5,155,30,8),this.backButtonGraphics.fillStyle(16777215,.1),this.backButtonGraphics.fillRoundedRect(2.5,2.5,155,15,8)})),this.backButtonText=e.add.text(80,25,t,{fontSize:"18px",fill:"#ffffff",fontWeight:"bold",fixedHeight:50,wordWrap:{width:150},align:"center",padding:{x:10,y:10}}),this.backButtonText.setOrigin(.5,.5),this.backButtonText.setScrollFactor(0),this.backButtonText.setDepth(1001),e.scale.on("resize",(()=>{e&&e.cameras&&e.cameras.main&&this.backButtonGraphics}))}updatePlayerPosition(e){(!this.lastPlayerX||!this.lastPlayerY||Math.abs(e.x-this.lastPlayerX)>1||Math.abs(e.y-this.lastPlayerY)>1)&&(this.lastPlayerX=e.x,this.lastPlayerY=e.y),this.playerPosText&&this.playerPosText.setText(`ã²ã‚ã‹ãšä½ç½®: X=${Math.round(e.x)}, Y=${Math.round(e.y)}`)}createMapUI(e,t){this.titleText=e.add.text(5,e.cameras.main.height-25,t,{fontSize:"18px",fill:"#FFD700",fontWeight:"bold",backgroundColor:"rgba(0, 0, 0, 0.7)",padding:{x:12,y:6},borderRadius:8,stroke:"#FF6B35",strokeThickness:2,shadow:{offsetX:3,offsetY:3,color:"#000000",blur:6,fill:!0}}).setOrigin(0,1),this.instructionText=e.add.text(5,e.cameras.main.height-15,"å ´æ‰€ã‚’ã‚¿ãƒƒãƒ—ã—ã¦ç§»å‹•ï¼",{fontSize:"14px",fill:"#FF6B35",backgroundColor:"rgba(0, 0, 0, 0.3)",padding:{x:8,y:4},borderRadius:6,stroke:"#FF00FF",strokeThickness:2,shadow:{offsetX:3,offsetY:3,color:"#FF6B35",blur:8,fill:!0}}).setOrigin(0,1),this.updateMapUI({width:e.cameras.main.width,height:e.cameras.main.height}),"ã‚¹ãƒ†ãƒ¼ã‚¸é¸æŠç”»é¢"===t&&this.createResetButton(e),this.selectedAreaText=e.add.text(e.cameras.main.centerX,e.cameras.main.height-50,"",{fontSize:"14px",fill:"#000000",backgroundColor:"transparent",padding:{x:8,y:4},borderRadius:8}).setOrigin(.5)}createResetButton(e){this.resetButton=e.add.text(10,10,"ã‚²ãƒ¼ãƒ ãƒªã‚»ãƒƒãƒˆ",{fontSize:"14px",fill:"#FF0000",backgroundColor:"rgba(0, 0, 0, 0.8)",padding:{x:10,y:6},borderRadius:6,stroke:"#FFFFFF",strokeThickness:1}).setOrigin(0,0),this.resetButton.setInteractive(),this.resetButton.on("pointerdown",(()=>{if(e.areaSelectionManager&&(e.areaSelectionManager.resetAllCompletions(),console.log("å®Œäº†çŠ¶æ…‹ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã—ãŸ")),window.returnToStageSelect)window.returnToStageSelect();else{const e=document.getElementById("stage-select"),t=document.getElementById("game-container");e&&(e.style.display="flex"),t&&(t.style.display="none")}})),this.resetButton.on("pointerover",(()=>{this.resetButton.setStyle({backgroundColor:"rgba(255, 0, 0, 0.9)"})})),this.resetButton.on("pointerout",(()=>{this.resetButton.setStyle({backgroundColor:"rgba(0, 0, 0, 0.8)"})}))}updateMapUI(e){const t=e.width/2;this.titleText&&this.titleText.setPosition(10,e.height-40),this.instructionText&&(this.instructionText.setPosition(10,e.height-15),console.log(`[UIManager] èª¬æ˜ãƒ†ã‚­ã‚¹ãƒˆã®ä½ç½®ã‚’æ›´æ–°: (10, ${e.height-15})`)),this.selectedAreaText&&this.selectedAreaText.setPosition(t,e.height-50)}showSelectedArea(e,t){this.selectedAreaText&&this.selectedAreaText.setText(`ã‚¨ãƒªã‚¢: ${e}\n${t}`)}createConversationBackButton(e){this.conversationBackButtonGraphics=e.add.graphics(),this.conversationBackButtonGraphics.fillStyle(0,.3),this.conversationBackButtonGraphics.fillRoundedRect(4.5,4.5,155,30,8),this.conversationBackButtonGraphics.fillStyle(2763306,.95),this.conversationBackButtonGraphics.fillRoundedRect(2.5,2.5,155,30,8),this.conversationBackButtonGraphics.fillStyle(16777215,.1),this.conversationBackButtonGraphics.fillRoundedRect(2.5,2.5,155,15,8),this.conversationBackButtonGraphics.setDepth(1e3),this.conversationBackButtonGraphics.setScrollFactor(0),this.conversationBackButtonGraphics.setInteractive(new Phaser.Geom.Rectangle(5,5,150,40),Phaser.Geom.Rectangle.Contains),this.conversationBackButtonGraphics.on("pointerdown",(()=>{e.interruptConversation&&e.interruptConversation()})),this.conversationBackButtonGraphics.on("pointerover",(()=>{this.conversationBackButtonGraphics.clear(),this.conversationBackButtonGraphics.fillStyle(0,.4),this.conversationBackButtonGraphics.fillRoundedRect(4.5,4.5,155,30,8),this.conversationBackButtonGraphics.fillStyle(3815994,.98),this.conversationBackButtonGraphics.fillRoundedRect(2.5,2.5,155,30,8),this.conversationBackButtonGraphics.fillStyle(16777215,.15),this.conversationBackButtonGraphics.fillRoundedRect(2.5,2.5,155,15,8)})),this.conversationBackButtonGraphics.on("pointerout",(()=>{this.conversationBackButtonGraphics.clear(),this.conversationBackButtonGraphics.fillStyle(0,.3),this.conversationBackButtonGraphics.fillRoundedRect(4.5,4.5,155,30,8),this.conversationBackButtonGraphics.fillStyle(2763306,.95),this.conversationBackButtonGraphics.fillRoundedRect(2.5,2.5,155,30,8),this.conversationBackButtonGraphics.fillStyle(16777215,.1),this.conversationBackButtonGraphics.fillRoundedRect(2.5,2.5,155,15,8)})),this.conversationBackButtonText=e.add.text(80,25,"ä¼šè©±ã‚’ä¸­æ–­",{fontSize:"18px",fill:"#ffffff",fontWeight:"bold",fixedHeight:50,wordWrap:{width:150},align:"center",padding:{x:10,y:10}}),this.conversationBackButtonText.setOrigin(.5,.5),this.conversationBackButtonText.setScrollFactor(0),this.conversationBackButtonText.setDepth(1001),e.scale.on("resize",(()=>{this.conversationBackButtonGraphics}))}cleanupConversationBackButton(){this.conversationBackButtonGraphics&&(this.conversationBackButtonGraphics.destroy(),this.conversationBackButtonGraphics=null),this.conversationBackButtonText&&(this.conversationBackButtonText.destroy(),this.conversationBackButtonText=null)}destroy(){if(!this._destroyed){this._destroyed=!0;try{const e=e=>{this[e]&&"function"==typeof this[e].destroy&&(this[e].destroy(),this[e]=null)};e("playerPosText"),e("backButtonGraphics"),e("backButtonText"),e("titleText"),e("instructionText"),e("selectedAreaText"),e("resetButton"),this.cleanupConversationBackButton()}catch(e){console.error("Error during UIManager cleanup:",e)}}}}class p{constructor(e){this.scene=e,this.camera=e.cameras.main,this.zoom=1,this.followTarget=null,this.bounds=null,this.currentScale=null}setupCamera(e,t,a){if(1===arguments.length&&"object"==typeof e&&e.width){const t=e;this.camera.setZoom(this.zoom);const a=this.scene.mapManager?.mapLayer,s=a?a.x:0,r=a?a.y:0,i=this.scene.cameras.main.width,o=this.scene.cameras.main.height;this.camera.setBounds(0,0,i,o),this.camera.centerOn(s+t.scaledWidth/2,r+t.scaledHeight/2)}else if(3===arguments.length){const s=e,r=t.widthInPixels,i=t.heightInPixels;s.cameras.main.setBounds(0,0,r,i),s.cameras.main.startFollow(a),s.physics.world.setBounds(0,0,r,i)}}setZoom(e){this.zoom=e,this.camera.setZoom(e)}centerOn(e,t){this.camera.centerOn(e,t)}setFollowTarget(e,t=.1){this.followTarget=e,this.camera.startFollow(e,!0,t,t)}stopFollow(){this.followTarget=null,this.camera.stopFollow()}setBackgroundColor(e){this.camera.setBackgroundColor(e)}fadeIn(e=1e3,t){this.camera.fadeIn(e,0,0,0,t)}fadeOut(e=1e3,t){this.camera.fadeOut(e,0,0,0,t)}shake(e=100,t=.02){this.camera.shake(e,t)}flash(e=100,t=16777215){this.camera.flash(e,t)}getBounds(){return this.bounds}getZoom(){return this.zoom}getWorldPoint(e,t){return this.camera.getWorldPoint(e,t)}getScreenPoint(e,t){return this.camera.getScreenPoint(e,t)}update(){}setupScrollControls(){let e=!1,t={x:0,y:0},a={x:0,y:0};this.scene.input.on("pointerdown",(s=>{e=!0,t={x:s.x,y:s.y},a={x:this.camera.scrollX,y:this.camera.scrollY}})),this.scene.input.on("pointermove",(s=>{if(e){const e=t.x-s.x,r=t.y-s.y,i=a.x+e,o=a.y+r;this.camera.setScroll(i,o)}})),this.scene.input.on("pointerup",(()=>{e=!1}))}setupPinchZoom(){let e=0,t=1;this.scene.input.on("pointerdown",(()=>{if(this.scene.input.pointers&&2===this.scene.input.pointers.length){const a=this.scene.input.pointers[0],s=this.scene.input.pointers[1];e=Phaser.Math.Distance.Between(a.x,a.y,s.x,s.y),t=this.camera.zoom}})),this.scene.input.on("pointermove",(()=>{if(this.scene.input.pointers&&2===this.scene.input.pointers.length){const a=this.scene.input.pointers[0],s=this.scene.input.pointers[1],r=Phaser.Math.Distance.Between(a.x,a.y,s.x,s.y)/e,i=Math.max(.5,Math.min(3,t*r));this.camera.setZoom(i)}}))}toggleMapScale(){if(1.5===(this.scene.mapManager?.mapScaleX||this.currentScale)){const e=this.scene.cameras.main.width,t=this.scene.cameras.main.height,a=e/this.scene.mapManager.mapWidth,s=t/this.scene.mapManager.mapHeight,r=Math.min(a,s);this.setMapScale(r)}else this.setMapScale(1.5)}setMapScale(e){if(this.currentScale=e,!this.scene.mapManager||!this.scene.mapManager.mapLayer)return;this.scene.mapManager.mapLayer.setScale(e,e),this.scene.mapManager.mapScaleX=e,this.scene.mapManager.mapScaleY=e;const t=this.scene.cameras.main.width,a=this.scene.cameras.main.height,s=this.scene.mapManager.mapWidth*e,r=this.scene.mapManager.mapHeight*e,i=(t-s)/2,o=(a-r)/2;if(this.scene.mapManager.mapLayer.setPosition(i,o),this.scene.mapManager.updateObjectPositions(e),this.scene.areaSelectionManager){const e=this.scene.mapManager.getAreas(),t=this.scene.mapConfig.areas,a=e.map((e=>{const a=t.find((t=>t.name===e.name));return{...e,scene:a?.scene||null}}));this.scene.areaSelectionManager.setupAreas(a)}1.5===e?this.camera.setBounds(i,o,s,r):(this.camera.setBackgroundColor("#87CEEB"),this.camera.setBounds(0,0,t,a)),this.camera.centerOn(i+s/2,o+r/2),console.log(`CameraManager: Scale changed to ${e}, map position: (${i}, ${o}), size: (${s}, ${r})`)}destroy(){this.stopFollow(),this.followTarget=null,this.bounds=null}}class g{constructor(){this.cursors=null,this.wasd=null}setupKeyboard(e,t){this.cursors=e.input.keyboard.createCursorKeys(),this.wasd=e.input.keyboard.addKeys("W,S,A,D"),t.setInputKeys(this.cursors,this.wasd)}destroy(){try{this.cursors&&(this.cursors=null),this.wasd&&(this.wasd=null)}catch(e){console.error("Error during InputManager cleanup:",e)}}}class u{constructor(e){this.scene=e,this.dialogSystem=null,this.collisionGroups={walls:null,npcs:null,items:null,enemies:null}}setDialogSystem(e){this.dialogSystem=e}setupCollisionGroups(){this.collisionGroups.walls=this.scene.physics.add.staticGroup(),this.collisionGroups.npcs=this.scene.physics.add.staticGroup(),this.collisionGroups.items=this.scene.physics.add.group(),this.collisionGroups.enemies=this.scene.physics.add.group()}addObjectToCollision(e,t){const a=t.type||"wall";this.scene.physics.add.existing(e,"item"!==a&&"enemy"!==a);const s=t.width||32,r=t.height||32;switch(e.body.setSize(s,r),a){case"npc":this.collisionGroups.npcs.add(e),e.setInteractive(),e.on("pointerdown",(()=>{this.startConversation(t.name)}));break;case"move":this.collisionGroups.items.add(e),e.setData("moveId",t.name),e.setData("moveType",t.type);break;case"item":this.collisionGroups.items.add(e),e.setData("itemId",t.name);break;case"enemy":this.collisionGroups.enemies.add(e),e.setData("enemyId",t.name);break;default:this.collisionGroups.walls.add(e)}}setupPlayerCollisions(e){this.scene.physics.add.collider(e,this.collisionGroups.walls),this.scene.physics.add.collider(e,this.collisionGroups.npcs),this.scene.physics.add.overlap(e,this.collisionGroups.items,this.collectItem,null,this.scene),this.scene.physics.add.overlap(e,this.collisionGroups.enemies,this.encounterEnemy,null,this.scene)}collectItem(e,t){"move"===t.getData("moveType")?this.handleMoveObject(e,t):t.destroy()}handleMoveObject(e,t){const a=t.getData("moveId");console.log(`[CollisionManager] ç§»å‹•ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«è§¦ã‚Œã¾ã—ãŸ: ${a}`);let s=1;"move"===a&&(1===this.scene.currentFloor?s=2:2===this.scene.currentFloor&&(s=1)),this.scene.changeFloor(s)}startConversation(e){if(this.scene.playerController&&this.scene.playerController.player&&this.scene.mapManager){const t=this.scene.playerController.getPosition();this.scene.mapManager.makeNpcFacePlayer(e,t.x,t.y)}this.scene.conversationTrigger?this.scene.conversationTrigger.startConversation(e):this.dialogSystem&&this.dialogSystem.startDialog(e)}isDialogActive(){return!!this.dialogSystem&&this.dialogSystem.isDialogActive()}getDialogSystem(){return this.dialogSystem}setupAllCollisions(e,t){console.log("[CollisionManager] setupAllCollisionsé–‹å§‹"),console.log(`[CollisionManager] ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼: ${e?"å­˜åœ¨":"null"}, MapManager: ${t?"å­˜åœ¨":"null"}`),this.setupTileCollisions(e,t),this.setupObjectCollisions(e,t),this.setupPlayerCollisions(e),console.log("[CollisionManager] setupAllCollisionså®Œäº†")}setupObjectCollisions(e,t){console.log("[CollisionManager] setupObjectCollisionsé–‹å§‹"),t&&t.objectGroup?(console.log(`[CollisionManager] objectGroupç™ºè¦‹: ${t.objectGroup.children.entries.length}å€‹ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ`),t.objectGroup.children.entries.forEach((t=>{const a=t.getData("objectType"),s=t.getData("objectName");console.log(`[CollisionManager] ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå‡¦ç†: ${s} (${a})`),"wall"===a||"å£"===a||"Wall"===a?this.scene.physics.add.collider(e,t):"npc"===a?this.scene.physics.add.overlap(e,t,(()=>this.startConversation(s)),null,this.scene):"move"===a&&(console.log(`[CollisionManager] moveã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®è¡çªåˆ¤å®šã‚’è¨­å®š: ${s}`),console.log(`[CollisionManager] moveã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®åº§æ¨™: (${t.x}, ${t.y}), ã‚µã‚¤ã‚º: ${t.width}x${t.height}`),console.log(`[CollisionManager] ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®åˆæœŸä½ç½®: (${e.x}, ${e.y})`),console.log("[CollisionManager] moveã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ç‰©ç†ãƒœãƒ‡ã‚£:",t.body),console.log("[CollisionManager] ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®ç‰©ç†ãƒœãƒ‡ã‚£:",e.body),console.log("[CollisionManager] moveã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«overlapã‚¤ãƒ™ãƒ³ãƒˆã‚’è¨­å®šä¸­..."),this.scene.physics.add.overlap(e,t,(()=>{console.log(`[CollisionManager] moveã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«è§¦ã‚Œã¾ã—ãŸ: ${s}`),this.handleMoveObject(e,t)}),null,this.scene),console.log("[CollisionManager] moveã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«overlapã‚¤ãƒ™ãƒ³ãƒˆã‚’è¨­å®šå®Œäº†"))}))):console.warn("[CollisionManager] objectGroupãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“"),console.log("[CollisionManager] setupObjectCollisionså®Œäº†")}setupTileCollisions(e,t){t&&t.layers&&t.layers.forEach((t=>{t&&this.scene.physics.add.collider(e,t)}))}destroy(){this.collisionGroups&&(Object.keys(this.collisionGroups).forEach((e=>{this.collisionGroups[e]&&(this.collisionGroups[e].clear(),this.collisionGroups[e]=null)})),this.collisionGroups=null),this.dialogSystem=null,this.scene=null}}class d{constructor(e){this.scene=e}setupObjectBehavior(e,t){switch(t.type){case"npc":this.setupNpcBehavior(e,t);break;case"item":this.setupItemBehavior(e);break;case"enemy":this.setupEnemyBehavior(e,t)}}setupNpcBehavior(e,t){switch(t.name){case"kuccoro1":this.setupKuccoro1Animation(e);break;case"kuccoro2":this.setupKuccoro2Animation(e);break;case"kuccoro3":this.setupKuccoro3Animation(e);break;case"hanni":this.setupHanniAnimation(e)}}setupItemBehavior(e){this.scene.tweens.add({targets:e,alpha:.7,duration:1e3,yoyo:!0,repeat:-1})}setupEnemyBehavior(e,t){switch(t.name){case"enemy1":this.setupEnemy1Animation(e);break;case"enemy2":this.setupEnemy2Animation(e);break;default:this.setupDefaultEnemyAnimation(e)}}isMobile(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}setupKuccoro1Animation(e){e.hasAnimation||(e.hasAnimation=!0,this.isMobile()?this.scene.tweens.add({targets:e,y:e.y+3,duration:3e3,yoyo:!0,repeat:-1,ease:"Linear"}):this.scene.tweens.add({targets:e,y:e.y+5,duration:1500,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"}))}setupKuccoro2Animation(e){this.isMobile()||this.scene.tweens.add({targets:e,x:e.x+20,duration:2e3,yoyo:!0,repeat:-1,ease:"Power1"})}setupKuccoro3Animation(e){this.isMobile()||this.scene.tweens.add({targets:e,rotation:2*Math.PI,duration:4e3,repeat:-1,ease:"Linear"})}setupHanniAnimation(e){this.scene.tweens.add({targets:e,scale:1.1,duration:1e3,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"})}setupEnemy1Animation(e){this.scene.tweens.add({targets:e,x:e.x+50,duration:2e3,yoyo:!0,repeat:-1,ease:"Power2"})}setupEnemy2Animation(e){this.scene.tweens.add({targets:e,y:e.y+30,duration:1500,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"})}setupDefaultEnemyAnimation(e){this.scene.tweens.add({targets:e,x:e.x+25,duration:3e3,yoyo:!0,repeat:-1,ease:"Linear"})}startConversation(e){this.scene.conversationTrigger?this.scene.conversationTrigger.startConversation(e):this.scene.collisionManager&&this.scene.collisionManager.startConversation(e)}destroy(){this.scene=null}}class m{constructor(e,t){e&&e.scene?(this.scene=e,this.isActive=!1,this.dialogContainer=null,this.dialogText=null,this.currentDialog=null,this.currentTextIndex=0,this.dialogs=t,this.setupUI(),this.setupInput()):console.error("DialogSystem: Invalid scene provided")}setupUI(){if(!this.scene||!this.scene.cameras||!this.scene.cameras.main)return void console.warn("DialogSystem: Scene or camera is not available");this.dialogContainer&&this.dialogContainer.destroy();const e=this.scene.cameras.main,t=e.width||800,a=e.height||600,s=a-120-20-20;this.dialogContainer=this.scene.add.container(0,0),this.dialogContainer.setDepth(1e4),this.dialogContainer.setVisible(!1);const r=this.scene.add.rectangle(t/2,s+60,t-20,120,0,.8);this.dialogText=this.scene.add.text(30,s+60,"",{fontSize:"18px",fill:"#ffffff",metrics:{ascent:15,descent:5,fontSize:18},wordWrap:{width:t-60}}),this.dialogText.setOrigin(0,.5),this.continueIndicator=this.scene.add.text(t-20,s+60-20,"ã‚¿ãƒƒãƒ—ã§ç¶šè¡Œ",{fontSize:"12px",fill:"#ffff00",align:"center"}),this.continueIndicator.setOrigin(1,1),this.scene.tweens.add({targets:this.continueIndicator,alpha:.3,duration:800,yoyo:!0,repeat:-1}),this.dialogContainer.add([r,this.dialogText,this.continueIndicator]),r.removeAllListeners(),r.setInteractive({hitArea:new Phaser.Geom.Rectangle(-t/2,-80,t,160),hitAreaCallback:Phaser.Geom.Rectangle.Contains,useHandCursor:!1}),r.on("pointerdown",((e,t,a,s)=>{s&&s.stopPropagation&&s.stopPropagation(),this.isActive&&this.nextDialog()})),this.dialogContainer.setInteractive({hitArea:new Phaser.Geom.Rectangle(0,0,t,a),hitAreaCallback:Phaser.Geom.Rectangle.Contains}),this.dialogContainer.on("pointerdown",((e,t,a,s)=>{s&&s.stopPropagation&&s.stopPropagation(),this.isActive&&this.nextDialog()})),this.dialogContainer.setScrollFactor(0),this.scene.scale.off("resize",this.handleResize,this),this.scene.scale.on("resize",this.handleResize,this)}handleResize(e){this.scene&&this.scene.cameras&&this.scene.cameras.main&&this.dialogContainer?this.setupUI():console.warn("DialogSystem: Scene, camera, or dialog container is not available for resize")}setupInput(){this.scene&&this.scene.input&&this.scene.input.keyboard?this.scene.input.keyboard.on("keydown-SPACE",(()=>{this.isActive&&this.nextDialog()})):console.warn("DialogSystem: Scene input is not available")}startDialog(e){this.dialogs[e]?(this.currentDialog=this.dialogs[e],this.currentTextIndex=0,this.isActive=!0,this.currentTextIndex=0,this.dialogContainer.setVisible(!0),this.showMessage()):console.error("No dialog found for:",e)}showMessage(){if(!this.currentDialog||!this.currentDialog.messages)return;if(this.currentTextIndex>=this.currentDialog.messages.length)return void this.endDialog();const e=this.currentDialog.messages[this.currentTextIndex];console.log("[DialogSystem] showMessage",{index:this.currentTextIndex,name:this.currentDialog.name,text:e}),this.dialogText.setText(e)}nextDialog(){this.currentTextIndex++,this.showMessage()}endDialog(){this.isActive=!1,this.dialogContainer&&this.dialogContainer.setVisible(!1),this.scene&&this.scene.scale&&this.scene.scale.off("resize",this.handleResize,this)}isDialogActive(){return this.isActive}destroy(){this.endDialog(),this.dialogContainer&&(this.dialogContainer.destroy(),this.dialogContainer=null),this.dialogText&&(this.dialogText.destroy(),this.dialogText=null),this.scene&&this.scene.scale&&this.scene.scale.off("resize",this.handleResize,this),this.scene&&this.scene.input&&this.scene.input.keyboard&&this.scene.input.keyboard.off("keydown-SPACE"),this.currentDialog=null,this.currentTextIndex=0,this.dialogs=null,this.scene=null}}const x={kuccoro1:{name:"ãã£ã“ã‚1",messages:["ã‚¯ãƒ³ãƒ‹ã¡ã‚ï¼","ä»Šæ—¥ã¯ã„ã„å¤©æ°—ã§ã™ã­","ã¾ãŸä¼šã„ã¾ã—ã‚‡ã†ï¼"]},kuccoro2:{name:"ãã£ã“ã‚2",messages:["ãã£ã€ã€ã€æ®ºã›ï¼","ã‚¤ã‚¯ã‚¤ã‚¯ã‚¤ã‚¯ã‚¤ã‚¯ã‚¤ã‚¯ã£ã€ãŠã£ã¡ã‚“ã½ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ï¼"]},kuccoro3:{name:"ã‚¨ãƒƒãƒãªå¥³é¨å£«",messages:["ãã£ã€ã€ã€ã“ã‚ã›ï¼","ã‚¤ã‚°ã‚¤ã‚°ã‚¤ã‚°ã…ã…ï¼"]},enemy1:{name:"æ•µ1",messages:["ã‚°ãƒ«ãƒ«...","é€šã•ãªã„ãï¼"]},enemy2:{name:"æ•µ2",messages:["ã“ã“ã‹ã‚‰å…ˆã¯å±é™ºã ","å¼•ãè¿”ã™ã‚“ã ï¼"]}},k={demo_chinpo:{background:"test_1",bgm:"bgm_demo_chinpo",conversations:[{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ãŠã‚Œã‘ã£ã“ã‚“ã™ã‚“ã ",expression:"a"},{speaker:"ã ã„ã¡",character:"daichi",text:"ãŠå‰ã‚‚ã‹",expression:"a"},{speaker:"æ²³æ‘",character:"hirokazu",text:"ãã‚“ãªã«å›ºããªã‚‰ãªãã¦ã‚‚ã„ã„",expression:"b"},{speaker:"ãªãŠã",character:"naoki",text:"ã¡ã‚“ã½ã‹ãŸã‚ã¾ã™",expression:"a"},{speaker:"ã ã„ã¡",character:"daichi",text:"ã‚„ã£ãŸã­ï¼",expression:"a"},{speaker:"ãªãŠã",character:"naoki",text:"ä¿ºã®ç‰¹æ®Šèƒ½åŠ›ã€ãƒ¡ã‚¿ãƒ«ãƒãƒ³ã‚³ã¯ãŒã­ã®ã‚ˆã†ã«ç¡¬ã„ãœâ˜…",expression:"a"},{speaker:"ãªãŠã",character:"naoki",text:"é‡‘ç‰ã‚‚ã§ã‹ã„ãœï¼",expression:"a"}]},after_chinpo:{background:"test_1",bgm:"bgm_demo_chinpo",conversations:[{speaker:"æ²³å®¤",character:"hirokazu",text:"ï¼ˆæ–°ã—ã„ã‚¯ãƒ©ã‚¹ã‹...å°‘ã—ç·Šå¼µã™ã‚‹ãªï¼‰",expression:"e"},{speaker:"æ²³å®¤",character:"hirokazu",text:"ã‚ã€ã‚ãªãŸãŒè»¢æ ¡ç”Ÿã®æ–¹ã§ã™ã­ï¼",expression:"f"},{speaker:"æ²³å®¤",character:"hirokazu",text:"ã¯ã„ã€ä»Šæ—¥ã‹ã‚‰ãŠä¸–è©±ã«ãªã‚Šã¾ã™",expression:"d"},{speaker:"æ²³å®¤",character:"hirokazu",text:"ç§ã€ç”°ä¸­èŠ±å­ã§ã™ã€‚ã‚ˆã‚ã—ããŠé¡˜ã„ã—ã¾ã™ï¼",expression:"c"},{speaker:"æ²³å®¤",character:"hirokazu",text:"ã“ã¡ã‚‰ã“ãã€‚åˆ†ã‹ã‚‰ãªã„ã“ã¨ãŒã‚ã£ãŸã‚‰æ•™ãˆã¦ãã ã•ã„",expression:"a"},{speaker:"æ²³å®¤",character:"hirokazu",text:"ã¯ã„ï¼ä½•ã§ã‚‚èã„ã¦ãã ã•ã„ã­â™ª",expression:"e"}]}};class y{constructor(){this.conversations=k,this.currentEvent=null}getConversation(e){console.log("[ConversationManager] ä¼šè©±ãƒ‡ãƒ¼ã‚¿å–å¾—è¦æ±‚: "+e),console.log("[ConversationManager] åˆ©ç”¨å¯èƒ½ãªã‚¤ãƒ™ãƒ³ãƒˆ:",Object.keys(this.conversations));const t=this.conversations[e]||null;return console.log("[ConversationManager] å–å¾—çµæœ:",t?"æˆåŠŸ":"å¤±æ•—"),t}getAvailableEvents(){return Object.keys(this.conversations)}addConversation(e,t){this.conversations[e]=t}updateConversation(e,t){return!!this.conversations[e]&&(this.conversations[e]=t,!0)}}class M{constructor(e){this.scene=e,this.conversationManager=new y,this.isConversationActive=!1,this.triggeredEvents=new Set,console.log("[ConversationTrigger] åˆæœŸåŒ–å®Œäº†"),console.log("[ConversationTrigger] åˆ©ç”¨å¯èƒ½ãªä¼šè©±ãƒ‡ãƒ¼ã‚¿:",this.conversationManager.getAvailableEvents())}startConversation(e){console.log(`[ConversationTrigger] ä¼šè©±é–‹å§‹è©¦è¡Œ: ${e}`);const t=this.conversationManager.getConversation(e);console.log("[ConversationTrigger] ä¼šè©±ãƒ‡ãƒ¼ã‚¿å–å¾—çµæœ:",t),t?(console.log(`[ConversationTrigger] ã‚®ãƒ£ãƒ«ã‚²é¢¨ä¼šè©±é–‹å§‹: ${e}`),this.startVisualNovelConversation(t)):(console.log(`[ConversationTrigger] ã‚·ãƒ³ãƒ—ãƒ«ä¼šè©±é–‹å§‹: ${e}`),this.startSimpleDialog(e))}startVisualNovelConversation(e,t=null){if(!this.scene||!this.scene.scene)return void console.warn("[ConversationTrigger] Scene is not available for conversation");this.isConversationActive&&(console.log("[ConversationTrigger] æ—¢å­˜ã®ä¼šè©±ã‚’åœæ­¢ã—ã¦æ–°ã—ã„ä¼šè©±ã‚’é–‹å§‹"),this.scene.scene.stop("ConversationScene"),this.isConversationActive=!1);const a=this.scene.scene.get("ConversationScene");a&&a.scene.isActive()&&this.scene.scene.stop("ConversationScene"),this.isConversationActive=!0;const s={...e,areaName:t};try{const e=this.scene.scene,t=e.get("ConversationScene");if(!t)return console.error("[ConversationTrigger] ConversationScene not found"),void(this.isConversationActive=!1);if(t.scene.isActive())try{try{e.bringToTop("ConversationScene")}catch(e){}t.scene.setVisible(!0),t.scene.setActive(!0),t.startConversation(s)}catch(e){console.error("[ConversationTrigger] start on active error:",e),this.isConversationActive=!1}else e.launch("ConversationScene"),this.scene.time.delayedCall(0,(()=>{try{try{e.bringToTop("ConversationScene")}catch(e){}t.scene.setVisible(!0),t.scene.setActive(!0),t.startConversation(s)}catch(e){console.error("[ConversationTrigger] start after launch error:",e),this.isConversationActive=!1}}));try{t.events.once("conversationEnded",(()=>{try{e.stop("ConversationScene")}catch(e){}this.isConversationActive=!1,console.log("[ConversationTrigger] ä¼šè©±çµ‚äº†: isConversationActive = false")})),t.events.once("conversationInterrupted",(()=>{try{e.stop("ConversationScene")}catch(e){}this.isConversationActive=!1,console.log("[ConversationTrigger] ä¼šè©±ä¸­æ–­: isConversationActive = false")}))}catch(e){}}catch(e){console.error("[ConversationTrigger] startVisualNovelConversation()ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿ:",e),console.error("[ConversationTrigger] ã‚¨ãƒ©ãƒ¼ã‚¹ã‚¿ãƒƒã‚¯:",e.stack),this.isConversationActive=!1}}startSimpleDialog(e){this.scene.collisionManager&&this.scene.collisionManager.getDialogSystem()&&this.scene.collisionManager.getDialogSystem().startDialog(e)}setupNpcClickHandler(e,t){console.log(`[ConversationTrigger] setupNpcClickHandler: sprite=${e.name||"unnamed"}, npcId=${t}`),e.setInteractive(),e.on("pointerdown",(()=>{console.log(`[ConversationTrigger] NPCã‚¯ãƒªãƒƒã‚¯: ${e.name||"unnamed"} -> ${t}`),this.isConversationActive?console.log("[ConversationTrigger] ä¼šè©±ä¸­ã€æ–°ã—ã„ä¼šè©±ã‚’é–‹å§‹ã—ã¾ã›ã‚“"):this.startConversation(t)}))}setupAreaTrigger(e,t,a,s,r){const i=this.scene.add.rectangle(e,t,a,s,0,0);return i.setInteractive(),this.scene.physics.add.existing(i),i.body.setSize(a,s),this.scene.physics.add.overlap(this.scene.playerController.player,i,(()=>{this.isConversationActive||this.triggeredEvents.has(r)||(this.triggeredEvents.add(r),this.startConversation(r))}),null,this.scene),i}setupProximityTrigger(e,t,a,s){const r=this.scene.add.circle(e,t,a,0,0);return this.scene.physics.add.existing(r),r.body.setCircle(a),this.scene.physics.add.overlap(this.scene.playerController.player,r,(()=>{this.isConversationActive||this.triggeredEvents.has(s)||(this.triggeredEvents.add(s),this.startConversation(s))}),null,this.scene),r}isActive(){return this.isConversationActive}destroy(){this.isConversationActive&&(this.scene.scene.stop("ConversationScene"),this.isConversationActive=!1),this.triggeredEvents.clear(),this.scene=null,this.conversationManager&&(this.conversationManager=null)}}class b extends Phaser.Scene{constructor(){super({key:"ConversationScene"}),this.currentConversationIndex=0,this.currentConversation=null,this.isTextAnimating=!1,this.textSpeed=30,this.originalBgm=null,this.eventBgm=null,this.nameboxLeftMargin=30,this._eventBgmStarted=!1,this._originalBgmKey=null,this._eventHtmlBgm=null,this._pausedHtmlMapBgm=!1}init(e){this.audioManager=e.audioManager,this._pendingConversation=e&&e.conversations?e.conversations:null,this.originalSceneKey=e&&e.originalSceneKey?e.originalSceneKey:null,this.areaName=e&&e.areaName?e.areaName:null,this.originalSceneKey&&(this.originalSceneKey=this.originalSceneKey.replace(/\s+/g,""),console.log("[ConversationScene] ã‚·ãƒ¼ãƒ³ã‚­ãƒ¼ã‚’æ­£è¦åŒ–:",e.originalSceneKey,"â†’",this.originalSceneKey)),console.log("[ConversationScene] init called with data:",e),console.log("[ConversationScene] audioManager:",this.audioManager),console.log("[ConversationScene] _pendingConversation set to:",this._pendingConversation),console.log("[ConversationScene] originalSceneKey:",this.originalSceneKey),console.log("[ConversationScene] areaName:",this.areaName)}create(){if(!this.sys)return void console.error("[ConversationScene] this.sys ãŒ undefined ã§ã™");if(!this.sys.game)return void console.error("[ConversationScene] this.sys.game ãŒ undefined ã§ã™");this.cleanupCharacterSprites(),this.currentTextTimer&&(this.currentTextTimer.destroy(),this.currentTextTimer=null);const e=this.sys?.game?.canvas?.width||this.sys?.game?.config?.width||800,t=this.sys?.game?.canvas?.height||this.sys?.game?.config?.height||600,a=t>e;if(this.characterContainer=this.add.container(0,0),this.uiManager=new l,this.uiManager.createConversationBackButton(this),this.textures.exists("textbox"))this.textbox=this.add.image(e/2,t-80,"textbox");else{const s=a?e-20:e-60,r=a?140:90;this.textbox=this.add.rectangle(e/2,t-(a?70:60),s,r,0,.9),this.textbox.setStrokeStyle(2,16777215,1)}if(this.textbox.setOrigin(.5,.5),this.textures.exists("namebox"))this.namebox=this.add.image(this.nameboxLeftMargin,t-123,"namebox");else{const a=Math.min(200,.3*e),s=Math.min(30,.1*t);this.namebox=this.add.rectangle(this.nameboxLeftMargin,t-123,a,s,3355443,.9),this.namebox.setStrokeStyle(2,8947848,.8)}this.namebox.setOrigin(0,.5);try{this.textbox&&void 0!==this.textbox.depth&&this.namebox.setDepth(this.textbox.depth+1)}catch(e){}this.createDecorationsForConversationUI();const s=a?0:20,r=Math.min((this.textbox?.displayWidth||e-60)-(s+20),600),i=e<600?"18px":"24px",o=this.textbox?.displayWidth||e-60,n=this.textbox?.displayHeight||(a?140:90),c=(this.textbox?.x||e/2)-o/2+s,h=(this.textbox?.y||t-(a?70:60))-n/2+7;this.dialogText=this.add.text(c,h,"",{fontSize:i,fill:"#ffffff",lineSpacing:8,padding:{x:10,y:10},wordWrap:{width:r,useAdvancedWrap:!0}}),this.dialogText.setOrigin(0,0),this.dialogText&&this.dialogText.setShadow&&this.dialogText.setShadow(2,2,"#000000",4,!1,!0);try{const t=(this.textbox?.x||e/2)-o/2+s,r=h-10,i=Math.max(1,(this.textbox?.displayWidth||e-60)-(s+20)),n=Math.max(1,(this.textbox?.displayHeight||(a?140:90))-20);this._textMaskGraphics=this.add.graphics(),this._textMaskGraphics.fillStyle(16777215,1),this._textMaskGraphics.fillRect(t,r,i,n);const c=this._textMaskGraphics.createGeometryMask();this.dialogText.setMask(c),this._textMaskGraphics.setVisible(!1)}catch(e){}const p=e<600?"16px":"20px";this.nameText=this.add.text(this.nameboxLeftMargin+(this.namebox.displayWidth||0)/2,t-130,"",{fontSize:p,fill:"#ffffff",fontStyle:"bold",padding:{x:10,y:10},fixedHeight:50}),this.nameText.setOrigin(.5,a?.35:.4);try{this.namebox&&void 0!==this.namebox.depth&&this.nameText.setDepth(this.namebox.depth+1)}catch(e){}this.nameText&&this.nameText.setShadow&&this.nameText.setShadow(1,1,"#000000",3,!1,!0);try{const e=this.namebox?.displayWidth||0;this.nameText.setPosition(this.nameboxLeftMargin+e/2,this.namebox.y)}catch(e){}this._repositionNamebox(e,t),this.redrawNameboxDecorations&&this.redrawNameboxDecorations(),this.input.removeAllListeners("pointerdown"),this.input.on("pointerdown",(()=>{this.nextDialog()})),this.input.keyboard.on("keydown-SPACE",(()=>{this.nextDialog()}));try{!this._onResizeBound&&this.scale&&this.scale.on&&(this.scale.on("resize",this.resize,this),this._onResizeBound=!0),this.events.once("shutdown",(()=>{try{this._onResizeBound&&this.scale&&this.scale.off&&this.scale.off("resize",this.resize,this)}catch(e){}this._onResizeBound=!1}))}catch(e){}if(console.log("[ConversationScene] _pendingConversation check:",this._pendingConversation),this._pendingConversation){try{console.log("[ConversationScene] startConversation called with:",this._pendingConversation),this.startConversation(this._pendingConversation)}catch(e){console.error("[ConversationScene] pending conversation start error:",e)}this._pendingConversation=null}else console.log("[ConversationScene] _pendingConversation is null or undefined")}interruptConversation(){try{try{this._eventHtmlBgm&&(console.log("[ConversationScene] ã‚¤ãƒ™ãƒ³ãƒˆBGMã‚’åœæ­¢"),this._eventHtmlBgm.pause(),this._eventHtmlBgm=null)}catch(e){console.warn("[ConversationScene] ã‚¤ãƒ™ãƒ³ãƒˆBGMåœæ­¢ã‚¨ãƒ©ãƒ¼:",e)}this.restoreOriginalBgm(),this.cleanupCharacterSprites(),this.cleanupBackButton(),this.currentTextTimer&&(this.currentTextTimer.destroy(),this.currentTextTimer=null),this.resetUI(),this.events.emit("conversationInterrupted");try{const e=this.scene.get("Stage1Scene")||this.scene.get("Stage2Scene")||this.scene.get("Stage3Scene")||this.scene.get("MiemachiStage")||this.scene.get("TaketastageStage")||this.scene.get("JapanStage");e&&e.conversationTrigger&&(e.conversationTrigger.isConversationActive=!1,console.log("[ConversationScene] ConversationTriggerã®ãƒ•ãƒ©ã‚°ã‚’ãƒªã‚»ãƒƒãƒˆ"))}catch(e){console.warn("[ConversationScene] ConversationTriggerãƒ•ãƒ©ã‚°ãƒªã‚»ãƒƒãƒˆã‚¨ãƒ©ãƒ¼:",e)}this.returnToOriginalScene()}catch(e){console.error("[ConversationScene] Error in interruptConversation:",e);try{this.returnToOriginalScene()}catch(e){console.error("[ConversationScene] Error returning to original scene:",e)}}}resetUI(){this.dialogText&&this.dialogText.setText(""),this.nameText&&this.nameText.setText(""),this.background&&(this.background.destroy(),this.background=null),this.textboxDecoFrame&&(this.textboxDecoFrame.destroy(),this.textboxDecoFrame=null),this.textboxDecoShine&&(this.textboxDecoShine.destroy(),this.textboxDecoShine=null),this.nameboxDecoFrame&&(this.nameboxDecoFrame.destroy(),this.nameboxDecoFrame=null),this.nameboxDecoShine&&(this.nameboxDecoShine.destroy(),this.nameboxDecoShine=null)}createDecorationsForConversationUI(){this.redrawTextboxDecorations(),this.redrawNameboxDecorations()}redrawTextboxDecorations(){if(!this.textbox)return;const e=this.textbox.displayWidth||this.textbox.width||0,t=this.textbox.displayHeight||this.textbox.height||0,a=(this.textbox.x||0)-e/2,s=(this.textbox.y||0)-t/2,r=Math.max(8,Math.min(20,Math.floor(t/3)));this.textboxDecoFrame||(this.textboxDecoFrame=this.add.graphics());const i=this.textboxDecoFrame;i.clear(),i.lineStyle(3,16758741,.9),i.strokeRoundedRect(a-4,s-4,e+8,t+8,r+6),i.lineStyle(2,12966143,.9),i.strokeRoundedRect(a+2,s+2,e-4,t-4,Math.max(6,r-4)),i.fillStyle(16770802,.95),i.fillCircle(a+10,s+10,3),i.fillCircle(a+e-10,s+10,3),i.fillCircle(a+10,s+t-10,3),i.fillCircle(a+e-10,s+t-10,3),this.textboxDecoShine||(this.textboxDecoShine=this.add.graphics());const o=this.textboxDecoShine;o.clear(),o.fillStyle(16777215,.1);const n=Math.max(8,Math.floor(.22*t));o.fillRoundedRect(a+6,s+6,e-12,n,Math.max(4,r-6))}redrawNameboxDecorations(){if(!this.namebox)return;const e=this.namebox.displayWidth||this.namebox.width||0,t=this.namebox.displayHeight||this.namebox.height||0,a=this.namebox.x||0,s=(this.namebox.y||0)-t/2,r=Math.max(6,Math.min(14,Math.floor(t/2)));this.nameboxDecoFrame||(this.nameboxDecoFrame=this.add.graphics());const i=this.nameboxDecoFrame;i.clear(),i.lineStyle(2,13154047,.9),i.strokeRoundedRect(a-6,s-4,e+12,t+8,r+4),i.lineStyle(2,16758741,.9),i.strokeRoundedRect(a+1,s+1,e-2,t-2,Math.max(4,r-2)),i.fillStyle(16770802,.95),i.fillCircle(a+6,s+t/2,2.5),i.fillCircle(a+e-6,s+t/2,2.5),this.nameboxDecoShine||(this.nameboxDecoShine=this.add.graphics());const o=this.nameboxDecoShine;o.clear(),o.fillStyle(16777215,.12);const n=Math.max(4,Math.floor(.4*t));o.fillRoundedRect(a+4,s+3,e-8,n,Math.max(3,r-3))}startConversation(e){this.currentConversation=e,this.currentConversationIndex=0,this.areaName&&(this.currentConversation.areaName=this.areaName,console.log(`[ConversationScene] ã‚¨ãƒªã‚¢åã‚’è¨­å®š: ${this.areaName}`)),this.events.emit("conversationStarted");try{const e=this.scene.get("Stage1Scene")||this.scene.get("Stage2Scene")||this.scene.get("Stage3Scene")||this.scene.get("MiemachiStage")||this.scene.get("TaketastageStage")||this.scene.get("JapanStage");e&&e.audioManager&&e.audioManager.bgm&&(this._originalBgmKey=e.audioManager.bgm.key,console.log(`[ConversationScene] å…ƒã®BGMã‚­ãƒ¼ã‚’è¨˜æ†¶: ${this._originalBgmKey}`))}catch(e){console.warn("[ConversationScene] å…ƒã®BGMã‚­ãƒ¼å–å¾—ã‚¨ãƒ©ãƒ¼:",e)}console.log("[ConversationScene] èƒŒæ™¯è¨­å®šé–‹å§‹:",e.background),e.background&&this.updateBackground(e.background),console.log("[ConversationScene] BGMè¨­å®šé–‹å§‹:",e.bgm),e.bgm&&this.switchToEventBgm(e.bgm);try{const e=this.scene.get("MiemachiStage")||this.scene.get("TaketastageStage")||this.scene.get("JapanStage");if(e){if(e._suppressMapBgm=!0,e._bgmRetry&&e._bgmRetry.remove){try{e._bgmRetry.remove(!1)}catch(e){}e._bgmRetry=null}try{e._htmlBgm&&!e._htmlBgm.paused&&e._htmlBgm.pause()}catch(e){}}}catch(e){}this.showDialog()}nextDialog(){this.isTextAnimating?this.completeTextAnimation():(this.currentConversationIndex++,this.currentConversationIndex<this.currentConversation.conversations.length?this.showDialog():this.endConversation())}showDialog(){const e=this.currentConversation.conversations[this.currentConversationIndex],t=!e.speaker||"narrator"===e.character;t?this.characterSprites&&Object.values(this.characterSprites).forEach((e=>{e&&e.setVisible&&e.setVisible(!1)})):(this.characterSprites&&Object.values(this.characterSprites).forEach((e=>{e&&e.setVisible&&e.setVisible(!0)})),this.updateCharacterSprite(e.character,e.expression),this.layoutVisibleCharacters()),t?(this.nameText.setText(""),this.namebox&&this.namebox.setVisible(!1),this.nameText&&this.nameText.setVisible(!1),this.nameboxDecoFrame&&this.nameboxDecoFrame.setVisible(!1),this.nameboxDecoShine&&this.nameboxDecoShine.setVisible(!1)):(this.namebox&&this.namebox.setVisible(!0),this.nameText&&this.nameText.setVisible(!0),this.nameText.setText(e.speaker||""),e.speaker&&this.adjustNameboxWidth(e.speaker)),this.animateText(e.text),e.background&&this.updateBackground(e.background),e.se&&this.playDialogSE(e.se)}updateCharacterSprite(e,t){if(this.characterSprites||(this.characterSprites={}),this.characterContainer){if(e&&t){const a=this.resolveExistingSpriteKey(e,t);if(!a)return;const s=this.sys?.game?.canvas?.width||this.sys?.game?.config?.width||800,r=this.sys?.game?.canvas?.height||this.sys?.game?.config?.height||600;let i={x:.5*s,y:.4*r};if(this.characterSprites[e]){const t=this.characterSprites[e];t.texture.key!==a&&(t.setTexture(a),this.applyPortraitScale(t))}else{const t=this.add.image(i.x,i.y,a);t.setOrigin(.5,.5);const s=this.getPortraitTargetScale(t.width,t.height);t.height*s>=.95*r&&(i={...i,y:.5*r},t.setPosition(i.x,i.y)),t.setAlpha(0),t.setScale(Math.max(.1,.9*s)),this.characterContainer.add(t),this.characterSprites[e]=t,this.tweens.add({targets:t,alpha:1,scaleX:s,scaleY:s,duration:500,ease:"Power2"})}this.dimOtherCharacters(e)}}else console.warn("characterContainer is not initialized yet")}resolveExistingSpriteKey(e,t){const a=[];a.push({ch:e,ex:t});const s=["L","A","B","C","D","E","F","G","H","I","J","K","M","N","R","S"];if(s.forEach((s=>{s!==t&&a.push({ch:e,ex:s})})),/_young$/.test(e)){const r=e.replace(/_young$/,"");a.push({ch:r,ex:t}),s.forEach((e=>{e!==t&&a.push({ch:r,ex:e})}))}for(const{ch:e,ex:t}of a){const a=`${e}_${t}`;if(this.textures&&this.textures.exists&&this.textures.exists(a))return a}return null}layoutVisibleCharacters(){if(!this.characterSprites)return;const e=Object.values(this.characterSprites).filter((e=>e&&!1!==e.visible)),t=e.length;if(0===t)return;const a=this.sys?.game?.canvas?.width||this.sys?.game?.config?.width||800,s=this.sys?.game?.canvas?.height||this.sys?.game?.config?.height||600;if(s>a){const r=Math.floor(.32*s),i=Math.floor(.58*s),o=.1*a,n=.9*a,c=t<=2?.8:t<=3?.75:.65,h=Math.min(3,t),l=e=>{if(e<=0)return[];if(1===e)return[.5*a];if(2===e)return[.35*a,.65*a];const t=n-o;return[0,1,2].slice(0,e).map((a=>o+t*(a/(e-1))))},p=l(Math.max(0,t-h)),g=l(h),u=[],d=[];e.forEach(((e,t)=>{const a=this.getPortraitTargetScale(e.width,e.height)*c;if(t<h)e.setPosition(g[t],i),u.push(e);else{const a=t-h;e.setPosition(p[a],r),d.push(e)}e.setScale(a)}));try{u.forEach((e=>{try{this.characterContainer.bringToTop(e)}catch(e){}}))}catch(e){}return}const r=.08*a,i=.92*a,o=.5*a,n=e.map((e=>this.getPortraitTargetScale(e.width,e.height))),c=e.map(((e,t)=>e.width*n[t]));let h=1.05*Math.max.apply(null,c);const l=i-r;t>1&&(h=Math.min(h,l/(t-1)));const p=new Array(t),g=(t-1)/2;for(let e=0;e<t;e++){const t=e-g;p[e]=o+t*h}const u=r,d=i,m=p[0],x=p[t-1];let k=0;if(m<u&&(k=u-m),x>d&&(k=Math.min(k,d-x)),0!==k)for(let e=0;e<t;e++)p[e]+=k;e.forEach(((e,t)=>{const a=n[t],r=e.height*a>=.95*s?.5*s:.4*s,i=Math.max(0,r-30);e.setPosition(p[t],i),this.applyPortraitScale(e)}))}getPortraitTargetScale(e,t){const a=this.sys?.game?.canvas?.width||this.sys?.game?.config?.width||800,s=this.sys?.game?.canvas?.height||this.sys?.game?.config?.height||600,r=Math.max(1,s),i=Math.max(1,a),o=r/Math.max(1,t),n=i/Math.max(1,e);return Math.min(o,n)}applyPortraitScale(e){if(!e||!e.texture)return;const t=e.width,a=e.height,s=this.getPortraitTargetScale(t,a);e.setScale(s)}dimOtherCharacters(e){this.characterSprites&&Object.keys(this.characterSprites).forEach((t=>{const a=this.characterSprites[t];t===e?a.setTint(16777215):a.setTint(8947848)}))}isMobile(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}animateText(e){if(this.isTextAnimating=!0,this.dialogText.setText(""),this.adjustTextDisplayHeight(e),this.isMobile())return this.dialogText.setText(e),void(this.isTextAnimating=!1);let t="",a=0;const s=this.time.addEvent({delay:this.textSpeed,callback:()=>{a<e.length?(t+=e[a],this.dialogText.setText(t),a++):(this.isTextAnimating=!1,s.destroy())},loop:!0});this.currentTextTimer=s}adjustTextDisplayHeight(){}adjustNameboxWidth(e){if(!this.namebox||!this.nameText)return;const t=this.sys?.game?.canvas?.width||this.sys?.game?.config?.width||800,a=Math.min(600,.6*t);this.nameText.setText(e);const s=this.nameText.width,r=Math.max(160,Math.min(a,s+30));if(this.textures.exists("namebox"));else{const e=this.namebox.displayHeight;this.namebox.setDisplaySize(r,e),this.namebox.setStrokeStyle(2,8947848,.8)}const i=this.namebox?.displayWidth||0;this.nameText.setPosition(this.nameboxLeftMargin+i/2,this.namebox.y),this.redrawNameboxDecorations&&this.redrawNameboxDecorations()}completeTextAnimation(){this.currentTextTimer&&this.currentTextTimer.destroy();const e=this.currentConversation.conversations[this.currentConversationIndex];this.dialogText.setText(e.text),this.adjustTextDisplayHeight(e.text),this.isTextAnimating=!1}updateBackground(e){if(console.log("[ConversationScene] updateBackground called with:",e),console.log("[ConversationScene] texture exists check:",this.textures.exists(e)),e&&this.textures.exists(e)){this.background&&this.background.destroy();const t=this.sys?.game?.canvas?.width||this.sys?.game?.config?.width||800,a=this.sys?.game?.canvas?.height||this.sys?.game?.config?.height||600;this.background=this.add.image(t/2,a/2,e),this.background.setOrigin(.5,.5),this._fitConversationBackground(),this.background.setDepth(-1)}}_fitConversationBackground(){if(!this.background)return;const e=this.sys?.game?.canvas?.width||this.sys?.game?.config?.width||800,t=this.sys?.game?.canvas?.height||this.sys?.game?.config?.height||600,a=this.background.texture,s=a&&a.getSourceImage?a.getSourceImage():null,r=s&&s.width||this.background.width,i=s&&s.height||this.background.height;this.background.setScale(1);const o=t/i,n=e/r,c=Math.max(n,o);this.background.setScale(c),this.background.setPosition(e/2,t/2)}async switchToEventBgm(e){console.log("[ConversationScene] switchToEventBgm called with:",e),this.stopOriginalBgm(),e&&this.audioManager&&(await this.audioManager.playConversationBgm(e,void 0,!0)?(this._eventBgmStarted=!0,this.audioManager.bgm?(this._eventHtmlBgm=this.audioManager.bgm,console.log("[ConversationScene] ã‚¤ãƒ™ãƒ³ãƒˆBGMã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä¿å­˜:",this._eventHtmlBgm)):console.warn("[ConversationScene] AudioManagerã‹ã‚‰BGMã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒå–å¾—ã§ãã¾ã›ã‚“"),console.log("[ConversationScene] ã‚¤ãƒ™ãƒ³ãƒˆBGMé–‹å§‹:",e)):console.warn("[ConversationScene] ã‚¤ãƒ™ãƒ³ãƒˆBGMé–‹å§‹å¤±æ•—:",e))}stopOriginalBgm(){try{const e=this.scene.get("Stage1Scene")||this.scene.get("Stage2Scene")||this.scene.get("Stage3Scene")||this.scene.get("MiemachiStage")||this.scene.get("TaketastageStage")||this.scene.get("JapanStage");e&&e.audioManager&&e.audioManager.stopBgm(!1),e&&e._htmlBgm&&(e._htmlBgm.pause(),this._pausedHtmlMapBgm=!0)}catch(e){console.warn("[ConversationScene] stopOriginalBgm error:",e)}}async getOriginalBgmKeyAsync(e){try{if(e&&e.audioManager){const t=await e.audioManager.getDefaultBgmKey();this._originalBgmKey=t,console.log(`[ConversationScene] å…ƒã®BGMã‚­ãƒ¼ã‚’ä¿å­˜ï¼ˆéåŒæœŸï¼‰: ${this._originalBgmKey}`)}}catch(e){console.warn("[ConversationScene] éåŒæœŸBGMã‚­ãƒ¼å–å¾—ã‚¨ãƒ©ãƒ¼:",e),this._originalBgmKey="bgm_default"}}restoreOriginalBgm(){console.log("[ConversationScene] restoreOriginalBgm ãƒ¡ã‚½ãƒƒãƒ‰é–‹å§‹");try{try{this._eventHtmlBgm&&(console.log("[ConversationScene] restoreOriginalBgm: ä¿å­˜ã•ã‚ŒãŸã‚¤ãƒ™ãƒ³ãƒˆBGMã‚’åœæ­¢"),this._eventHtmlBgm.pause(),this._eventHtmlBgm=null),this.audioManager&&this.audioManager.bgm&&(console.log("[ConversationScene] restoreOriginalBgm: AudioManagerã®ç¾åœ¨ã®BGMã‚’åœæ­¢"),this.audioManager.bgm.pause(),this.audioManager.bgm=null),this._eventBgmStarted&&(this._eventBgmStarted=!1,console.log("[ConversationScene] ã‚¤ãƒ™ãƒ³ãƒˆBGMãƒ•ãƒ©ã‚°ã‚’ãƒªã‚»ãƒƒãƒˆ"))}catch(e){console.warn("[ConversationScene] ã‚¤ãƒ™ãƒ³ãƒˆBGMåœæ­¢ã‚¨ãƒ©ãƒ¼:",e)}if(this.originalSceneKey){const e=this.scene.manager;if(e){const t=e.getScene(this.originalSceneKey);if(t&&t.audioManager){console.log("[ConversationScene] å…ƒã®ã‚·ãƒ¼ãƒ³",this.originalSceneKey,"ã®BGMã‚’å¾©å…ƒã—ã¾ã™");try{t.audioManager.playBgm("map",void 0,!0),console.log("[ConversationScene] å…ƒã®ã‚·ãƒ¼ãƒ³ã®BGMã‚’å†é–‹ã—ã¾ã—ãŸ:",this.originalSceneKey)}catch(e){console.warn("[ConversationScene] BGMå†é–‹ã‚¨ãƒ©ãƒ¼:",e)}try{t._suppressMapBgm=!1}catch(e){}}}}else{const e=this.scene.get("Stage1Scene")||this.scene.get("Stage2Scene")||this.scene.get("Stage3Scene")||this.scene.get("MiemachiStage")||this.scene.get("TaketastageStage")||this.scene.get("JapanStage");if(e&&e.audioManager){try{console.log("[ConversationScene] ãƒãƒƒãƒ—BGMã‚’å†é–‹"),e.audioManager.playBgm("map",void 0,!0)}catch(e){console.warn("[ConversationScene] ãƒãƒƒãƒ—BGMå†é–‹å¤±æ•—:",e)}try{e._suppressMapBgm=!1}catch(e){}}}}catch(e){console.error("[ConversationScene] restoreOriginalBgm ã‚¨ãƒ©ãƒ¼:",e)}console.log("[ConversationScene] restoreOriginalBgm ãƒ¡ã‚½ãƒƒãƒ‰å®Œäº†")}endConversation(){try{console.log("[ConversationScene] endConversation é–‹å§‹"),this.events.emit("conversationEnded"),console.log("[ConversationScene] ä¼šè©±çµ‚äº†ã‚¤ãƒ™ãƒ³ãƒˆç™ºç«å®Œäº†"),this.markAreaAsCompleted(),console.log("[ConversationScene] ã‚¨ãƒªã‚¢å®Œäº†è¨­å®šå®Œäº†"),console.log("[ConversationScene] restoreOriginalBgm é–‹å§‹"),this.restoreOriginalBgm(),console.log("[ConversationScene] restoreOriginalBgm å®Œäº†"),this.cleanupCharacterSprites(),console.log("[ConversationScene] ã‚¹ãƒ—ãƒ©ã‚¤ãƒˆã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—å®Œäº†"),this.cleanupBackButton(),console.log("[ConversationScene] æˆ»ã‚‹ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—å®Œäº†"),this.currentTextTimer&&(this.currentTextTimer.destroy(),this.currentTextTimer=null),console.log("[ConversationScene] ãƒ†ã‚­ã‚¹ãƒˆã‚¿ã‚¤ãƒãƒ¼ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—å®Œäº†"),this.resetUI(),console.log("[ConversationScene] UIãƒªã‚»ãƒƒãƒˆå®Œäº†"),console.log("[ConversationScene] returnToOriginalScene é–‹å§‹"),this.returnToOriginalScene()}catch(e){console.error("[ConversationScene] Error in endConversation:",e);try{this.returnToOriginalScene()}catch(e){console.error("[ConversationScene] Error returning to original scene:",e)}}}returnToOriginalScene(){try{if(console.log("[ConversationScene] å…ƒã®ã‚·ãƒ¼ãƒ³",this.originalSceneKey,"ã«æˆ»ã‚Šã¾ã™"),this.originalSceneKey){const e=this.scene.manager;e&&(e.getScene(this.originalSceneKey)?console.log("[ConversationScene] æ—¢å­˜ã®ã‚·ãƒ¼ãƒ³",this.originalSceneKey,"ãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸ"):console.warn("[ConversationScene] ã‚·ãƒ¼ãƒ³",this.originalSceneKey,"ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“")),this.scene.stop(),this.scene.start(this.originalSceneKey),console.log("[ConversationScene] ã‚·ãƒ¼ãƒ³",this.originalSceneKey,"ã‚’é–‹å§‹ã—ã¾ã—ãŸ")}else console.warn("[ConversationScene] å…ƒã®ã‚·ãƒ¼ãƒ³ã®ã‚­ãƒ¼ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“"),this.scene.stop(),this.scene.start("TitleScene")}catch(e){console.error("[ConversationScene] Error returning to original scene:",e),this.scene.stop()}}markAreaAsCompleted(){console.log("[ConversationScene] markAreaAsCompletedå‘¼ã³å‡ºã—é–‹å§‹");try{if(this.currentConversation&&this.currentConversation.areaName){const e=this.currentConversation.areaName;this.completedAreaName=e,console.log(`[ConversationScene] å®Œäº†çŠ¶æ…‹ã‚’ä¸€æ™‚ä¿å­˜: ${e}`),console.log(`[ConversationScene] å®Œäº†çŠ¶æ…‹ã‚’ä¿å­˜å®Œäº†: ${e}`)}}catch(e){console.error("[ConversationScene] ã‚¨ãƒªã‚¢å®Œäº†è¨­å®šã‚¨ãƒ©ãƒ¼:",e)}console.log("[ConversationScene] markAreaAsCompletedå®Œäº†")}cleanupCharacterSprites(){this.characterSprites&&(Object.values(this.characterSprites).forEach((e=>{e&&e.destroy&&e.destroy()})),this.characterSprites={}),this.characterContainer&&this.characterContainer.removeAll()}cleanupBackButton(){this.uiManager&&(this.uiManager.cleanupConversationBackButton(),this.uiManager=null)}resize(e){const{width:t,height:a}=e;if(this.background)try{this._fitConversationBackground()}catch(e){this.background.setPosition(t/2,a/2);const s=t/this.background.width,r=a/this.background.height,i=Math.max(s,r);this.background.setScale(i)}if(this.textbox){const e=a>t;if(this.textures.exists("textbox"))this.textbox.setPosition(t/2,a-(e?70:60));else{const s=e?t-20:t-60,r=e?140:90;this.textbox.setDisplaySize(s,r),this.textbox.setPosition(t/2,a-(e?70:60)),this.textbox.setStrokeStyle(2,16777215,1)}this.redrawTextboxDecorations&&this.redrawTextboxDecorations()}if(this.namebox){if(this.textures.exists("namebox"))this._repositionNamebox(t,a);else{const e=Math.min(200,.3*t),s=Math.min(30,.1*a);this.namebox.setDisplaySize(e,s),this._repositionNamebox(t,a),this.namebox.setStrokeStyle(2,8947848,.8)}this.redrawNameboxDecorations&&this.redrawNameboxDecorations()}if(this.dialogText){const e=a>t,s=e?0:20,r=20,i=Math.min((this.textbox?.displayWidth||t-60)-(s+r),600),o=t<600?"18px":"24px",n=this.textbox?.displayWidth||t-60,c=this.textbox?.displayHeight||(e?140:90),h=(this.textbox?.x||t/2)-n/2+s,l=(this.textbox?.y||a-(e?70:60))-c/2+2;this.dialogText.setPosition(h,l),this.dialogText.setWordWrapWidth(i),this.dialogText.setFontSize(o),this.dialogText.setShadow&&this.dialogText.setShadow(2,2,"#000000",4,!1,!0);try{this._textMaskGraphics&&this._textMaskGraphics.destroy(),this._textMaskGraphics=this.add.graphics(),this._textMaskGraphics.fillStyle(16777215,1);const a=(this.textbox?.x||t/2)-n/2+s,i=l-10,o=Math.max(1,(this.textbox?.displayWidth||t-60)-(s+r)),c=Math.max(1,(this.textbox?.displayHeight||(e?140:90))-20);this._textMaskGraphics.fillRect(a,i,o,c);const h=this._textMaskGraphics.createGeometryMask();this._textMaskGraphics.setVisible(!1),this.dialogText.setMask(h)}catch(e){}}if(this.nameText){const e=t<600?"16px":"20px",a=this.namebox?.displayWidth||0;this.nameText.setPosition(this.nameboxLeftMargin+a/2,this.namebox.y),this.nameText.setFontSize(e),this.nameText.setShadow&&this.nameText.setShadow(1,1,"#000000",3,!1,!0),this.nameText.text&&""!==this.nameText.text&&this.adjustNameboxWidth(this.nameText.text)}}repositionCharacterSprites(){this.layoutVisibleCharacters()}_repositionNamebox(e,t){try{const e=this.textbox;if(!e||!this.namebox)return;const a=e.displayHeight||90,s=(e.y||t-60)-a/2-20;if(this.namebox.setPosition(this.nameboxLeftMargin,s),this.nameText){const e=this.namebox.displayWidth||0;this.nameText.setPosition(this.nameboxLeftMargin+e/2,s)}}catch(e){}}playDialogSE(e){console.log("[ConversationScene] SEå†ç”Ÿã‚’è©¦è¡Œ:",e),this.audioManager?(console.log("[ConversationScene] AudioManagerç™ºè¦‹ã€SEå†ç”Ÿ:",e),this.audioManager.playSe(e)):console.warn("[ConversationScene] AudioManagerãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“:",this.audioManager)}}var f=a(296);class v extends Phaser.Scene{constructor(){super({key:"Stage1Scene"}),this.mapManager=null,this.playerController=null,this.touchControlManager=null,this.uiManager=null,this.cameraManager=null,this.inputManager=null,this.collisionManager=null,this.behaviorManager=null,this.dialogSystem=null,this.audioManager=null,this.conversationTrigger=null,this.updateCounter=0}preload(){this.load.tilemapTiledJSON("map","assets/maps/stage1.tmj"),this.load.image("[A]Grass1_pipo","assets/maps/tilesets/stage1/[A]Grass1_pipo.png"),this.load.image("Tilemap","assets/maps/tilesets/stage1/Tilemap.png"),this.load.audio("bgm_nightbarth","assets/audio/bgm/nightbarth.mp3"),this.load.audio("bgm_demo_chinpo","assets/audio/bgm/stage1/megarovania.mp3");const e={frameWidth:32,frameHeight:32};this.load.spritesheet("ojyama1","assets/characters/enemies/pipo-charachip005a.png",e),this.load.spritesheet("hanni","assets/characters/npcs/pipo-charachip007a.png",e),this.load.spritesheet("kuccoro","assets/characters/npcs/pipo-charachip022e.png",e),this.load.spritesheet("kuccoro1","assets/characters/npcs/pipo-charachip022a.png",e),this.load.spritesheet("kuccoro2","assets/characters/npcs/pipo-charachip022e.png",e),this.load.spritesheet("kuccoro3","assets/characters/npcs/pipo-charachip026.png",e),this.load.spritesheet("kuccoro4","assets/characters/npcs/pipo-charachip024d.png",e),this.load.spritesheet("enemy1","assets/characters/enemies/pipo-charachip005a.png",e),this.load.spritesheet("enemy2","assets/characters/enemies/pipo-charachip005a.png",e),this.load.spritesheet("friend1","assets/characters/npcs/pipo-charachip007a.png",e),this.load.spritesheet("friend2","assets/characters/npcs/pipo-charachip007a.png",e),this.load.spritesheet("kuccoro","assets/characters/npcs/pipo-charachip022a.png",e),this.load.on("fileerror",(()=>{})),this.load.on("complete",(()=>{console.log("Stage 1: ã‚¢ã‚»ãƒƒãƒˆèª­ã¿è¾¼ã¿å®Œäº†")})),this.load.image("hirokazu_a","assets/characters/portraits/hirokazu_a.png"),this.load.image("hirokazu_b","assets/characters/portraits/hirokazu_b.png"),this.load.image("hirokazu_c","assets/characters/portraits/hirokazu_c.png"),this.load.image("hirokazu_d","assets/characters/portraits/hirokazu_d.png"),this.load.image("hirokazu_e","assets/characters/portraits/hirokazu_e.png"),this.load.image("hirokazu_f","assets/characters/portraits/hirokazu_f.png"),this.load.image("daichi_a","assets/characters/portraits/daichi_a.png"),this.load.image("naoki_a","assets/characters/portraits/naoki_a.png"),this.load.image("test_1","assets/backgrounds/background_test.png"),this.load.audio("se_touch_stage1","assets/audio/se/touch_1.mp3")}create(){try{let e=!1;if(this.load.isLoading()?this.load.once("complete",(()=>{e||(e=!0,this.initializeAudioManager())})):e||(e=!0,this.initializeAudioManager()),this.collisionManager=new u(this),this.collisionManager.setupCollisionGroups(),this.dialogSystem=new m(this,x),this.collisionManager.setDialogSystem(this.dialogSystem),this.behaviorManager=new d(this),this.mapManager=new o(this),this.mapManager.createMap(),this.playerController=new n(this),this.playerController.createPlayer(100,100),!this.physics)return void console.error("Stage 1: ç‰©ç†ã‚·ã‚¹ãƒ†ãƒ ãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“");this.inputManager=new g,this.inputManager.setupKeyboard(this,this.playerController),this.touchControlManager=new h(this,this.playerController.player,"se_touch_stage1"),this.uiManager=new l,this.uiManager.createUI(this),this.cameraManager=new p(this),this.cameraManager.setupCamera(this,this.mapManager.map,this.playerController.player),this.collisionManager.setupAllCollisions(this.playerController.player,this.mapManager),console.log("Stage 1: åˆæœŸåŒ–å®Œäº† - ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ä½ç½®:",this.playerController.getPosition()),console.log("Stage 1: ç‰©ç†ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ…‹:",!!this.physics),console.log("Stage 1: å…¥åŠ›ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ…‹:",!!this.input),this.conversationTrigger=new M(this);try{this.scene.manager&&this.scene.manager.keys&&this.scene.manager.keys.ConversationScene||this.scene.add("ConversationScene",b)}catch(e){}this.setupConversationEvents(),this.events.on("shutdown",this.shutdown,this)}catch(e){console.error("Stage 1: create() ã‚¨ãƒ©ãƒ¼:",e)}}initializeAudioManager(){try{this.audioManager=new f.AudioManager(this);const e=()=>{if(this.scene&&this.scene.manager&&this.scene.manager.isActive("ConversationScene"))console.log("Stage 1: ä¼šè©±ä¸­ã€BGMå†é–‹ã‚’ã‚¹ã‚­ãƒƒãƒ—");else try{console.log("Stage 1: BGMå†ç”Ÿé–‹å§‹"),this.audioManager.playBgm("bgm_nightbarth")?console.log("Stage 1: BGMå†ç”ŸæˆåŠŸ"):(console.warn("Stage 1: BGMå†ç”Ÿå¤±æ•—"),console.log("Stage 1: BGMå†ç”Ÿå¤±æ•—ã—ã¾ã—ãŸãŒã€ã‚²ãƒ¼ãƒ ã¯ç¶šè¡Œã—ã¾ã™"))}catch(e){console.error("Stage 1: BGMå†ç”Ÿã‚¨ãƒ©ãƒ¼:",e),console.log("Stage 1: BGMå†ç”Ÿã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸãŒã€ã‚²ãƒ¼ãƒ ã¯ç¶šè¡Œã—ã¾ã™")}};if(this.sound&&this.sound.locked){this.sound.once("unlocked",(()=>{console.log("Stage 1: éŸ³å£°ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ³ãƒ­ãƒƒã‚¯"),e()})),this.input&&this.input.once&&this.input.once("pointerdown",(()=>{try{this.sound.context&&"running"!==this.sound.context.state&&this.sound.context.resume()}catch(e){console.warn("Stage 1: éŸ³å£°ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆå¾©å¸°ã‚¨ãƒ©ãƒ¼:",e)}e()}));try{this.input&&this.input.keyboard&&this.input.keyboard.once("keydown",e)}catch(e){console.warn("Stage 1: ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚¤ãƒ™ãƒ³ãƒˆè¨­å®šã‚¨ãƒ©ãƒ¼:",e)}}else console.log("Stage 1: éŸ³å£°ã‚·ã‚¹ãƒ†ãƒ ã¯æ—¢ã«ã‚¢ãƒ³ãƒ­ãƒƒã‚¯æ¸ˆã¿"),e()}catch(e){console.error("Stage 1: AudioManageråˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:",e)}}shutdown(){if(this.audioManager)try{this.audioManager.stopAll(),this.audioManager.destroy()}catch(e){console.warn("Stage 1: AudioManagerç ´æ£„ã‚¨ãƒ©ãƒ¼:",e)}finally{this.audioManager=null}try{this.sound&&this.sound.context&&(this.sound.context.close(),this.sound.context=null)}catch(e){console.warn("Stage 1: éŸ³å£°ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒªã‚»ãƒƒãƒˆã‚¨ãƒ©ãƒ¼:",e)}if(this.sound)try{this.sound.stopAll(),this.sound.context&&(this.sound.context.state="suspended")}catch(e){console.warn("Stage 1: éŸ³å£°ã‚·ã‚¹ãƒ†ãƒ ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã‚¨ãƒ©ãƒ¼:",e)}try{this.load&&this.load.reset&&this.load.reset()}catch(e){}try{this.load&&this.load.removeAllListeners&&this.load.removeAllListeners()}catch(e){}this.playerController&&(this.playerController.destroy(),this.playerController=null),this.touchControlManager&&(this.touchControlManager.destroy(),this.touchControlManager=null),this.uiManager&&(this.uiManager.destroy(),this.uiManager=null),this.cameraManager&&(this.cameraManager.destroy(),this.cameraManager=null),this.inputManager&&(this.inputManager.destroy(),this.inputManager=null),this.collisionManager&&(this.collisionManager.destroy(),this.collisionManager=null),this.behaviorManager&&(this.behaviorManager.destroy(),this.behaviorManager=null),this.dialogSystem&&(this.dialogSystem.destroy(),this.dialogSystem=null),this.conversationTrigger&&(this.conversationTrigger.destroy(),this.conversationTrigger=null),this.events.off("shutdown",this.shutdown,this)}destroy(){this.shutdown(),super.destroy()}setupConversationEvents(){this.setupNpcConversations(),this.setupAreaTriggers(),this.setupProximityTriggers()}setupNpcConversations(){const e=this.mapManager.getNpcSprite("hanni");e&&this.conversationTrigger.setupNpcClickHandler(e,"demo_chinpo")}setupAreaTriggers(){this.conversationTrigger.setupAreaTrigger(200,200,64,64,"after_chinpo")}setupProximityTriggers(){this.conversationTrigger.setupProximityTrigger(300,300,50,"library_scene")}update(){if(this.updateCounter++,this.updateCounter%2==0){if(this.playerController&&this.playerController.player){if(this.playerController.update(),this.updateCounter%120==0){const e=this.playerController.getPosition();console.log("Stage 1: ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ä½ç½®æ›´æ–° - X:",e.x,"Y:",e.y)}}else console.warn("Stage 1: ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“");this.uiManager&&this.playerController&&this.playerController.player&&this.uiManager.updatePlayerPosition(this.playerController.player)}}resize(e){const{width:t,height:a}=e;this.cameras.resize(t,a)}}class S{constructor(e){this.scene=e}setupObjectBehavior(e,t){switch(t.type){case"npc":this.setupNpcBehavior(e,t);break;case"item":this.setupItemBehavior(e);break;case"enemy":this.setupEnemyBehavior(e,t)}}setupNpcBehavior(e,t){switch(t.name){case"friend2_4":this.setupFriend2Animation(e);break;case"shopkeeper":this.setupShopkeeperAnimation(e);break;case"guard":this.setupGuardAnimation(e);break;case"merchant":this.setupMerchantAnimation(e)}}setupItemBehavior(e){this.scene.tweens.add({targets:e,alpha:.5,scale:1.2,duration:800,yoyo:!0,repeat:-1,ease:"Power2"})}setupEnemyBehavior(e,t){switch(t.name){case"boss_stage2":this.setupBossAnimation(e);break;case"strong_enemy":this.setupStrongEnemyAnimation(e);break;default:this.setupDefaultEnemyAnimation(e)}}setupFriend2Animation(e){this.scene.tweens.add({targets:e,alpha:.8,duration:2e3,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"})}setupShopkeeperAnimation(e){this.scene.tweens.add({targets:e,rotation:.1,duration:1e3,yoyo:!0,repeat:-1,ease:"Power1"})}setupGuardAnimation(e){this.scene.tweens.add({targets:e,x:e.x+40,duration:3e3,yoyo:!0,repeat:-1,ease:"Linear"})}setupMerchantAnimation(e){this.scene.tweens.add({targets:e,y:e.y+8,duration:1200,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"})}setupBossAnimation(e){this.scene.tweens.add({targets:e,scale:1.2,rotation:.2,duration:1500,yoyo:!0,repeat:-1,ease:"Power2"})}setupStrongEnemyAnimation(e){this.scene.tweens.add({targets:e,x:e.x+60,y:e.y+20,duration:1e3,yoyo:!0,repeat:-1,ease:"Back.easeInOut"})}setupDefaultEnemyAnimation(e){this.scene.tweens.add({targets:e,x:e.x+35,rotation:Math.PI/8,duration:2e3,yoyo:!0,repeat:-1,ease:"Power2"})}startConversation(e){this.scene.collisionManager&&this.scene.collisionManager.startConversation(e)}}const C={friend2_4:{name:"ã²ã‚ã‹ãš",messages:["ã‚‚ã“ã†ã«ãƒ‰ãƒ³ã‚­ã‚ã‚‹ã‹ã‚‰","ãã“ã§ã€ï¼•ï¼ä¸‡ã‹ãŸã—ã¦ã‚‚ã‚‰ã£ã¦","ã‚‚ã„ã„ã„ï¼Ÿ"]},friend2_5:{name:"ããš",messages:["ã¯ã‚‰ã‚ãŠã‚‰ã"]},guard:{name:"ãƒãƒ«ãƒã•ã‚“",messages:["ã§ããŸã‚‰æ„›ã—ã¦ãã ãƒ¼ã•ã„","åƒ•ã®è‚©ã§ç¾½ã‚’ä¼‘ã‚ã¦ãŠãã‚Œãƒ¼"]},kuccoro:{name:"å•†äºº",messages:["ã‚„ã‚ã¦ï¼","ãƒ©ãƒ¼ã®ç¿¼ç¥ç«œã®ç‰¹æ®Šèƒ½åŠ›ã§ã€ã‚®ãƒ«ãƒ•ã‚©ãƒ¼ãƒ‰ãƒ»ã‚¶ãƒ»ãƒ©ã‚¤ãƒˆãƒ‹ãƒ³ã‚°ã‚’ç„¼ãæ‰•ã‚ã‚ŒãŸã‚‰ã€","é—‡ã®ã‚²ãƒ¼ãƒ ã§ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã¨ç¹‹ãŒã£ã¦ã‚‹åŸä¹‹å†…ã®ç²¾ç¥ã¾ã§ç‡ƒãˆå°½ãã¡ã‚ƒã†ï¼","ãŠé¡˜ã„ã€æ­»ãªãªã„ã§åŸä¹‹å†…ï¼","ã‚ã‚“ãŸãŒä»Šã“ã“ã§å€’ã‚ŒãŸã‚‰ã€èˆã•ã‚“ã‚„éŠæˆ¯ã¨ã®ç´„æŸã¯ã©ã†ãªã£ã¡ã‚ƒã†ã®ï¼Ÿ","ãƒ©ã‚¤ãƒ•ã¯ã¾ã æ®‹ã£ã¦ã‚‹ã€‚ã“ã“ã‚’è€ãˆã‚Œã°ã€ãƒãƒªã‚¯ã«å‹ã¦ã‚‹ã‚“ã ã‹ã‚‰ï¼","æ¬¡å›ã€ŒåŸä¹‹å†…æ­»ã™ã€ãƒ‡ãƒ¥ã‚¨ãƒ«ã‚¹ã‚¿ãƒ³ãƒã‚¤ï¼"]},kuccoro1:{name:"ãã£ã“ã‚",messages:["ã“ã“ã¾ã§è¾¿ã‚Šç€ãã¨ã¯ãª","ã—ã‹ã—ã€ã“ã“ãŒå›ã®é™ç•Œã ï¼","ã‹ã‹ã£ã¦ã“ã„ï¼","ã“ã“ãŒè²´æ§˜ã®å¢“å ´ã¨ãªã‚ã†"]},kuccoro2:{name:"ã‚¨ãƒƒãƒãªå¥³é¨å£«",messages:["ãã£ã€ã€ã€ã“ã‚ã›ï¼","ã‚¤ã‚°ã‚¤ã‚°ã‚¤ã‚°ã…ã…ï¼"]},kuccoro4:{name:"ï¼’ã‚³ãƒå³è½ã¡å¥³é¨å£«",messages:["ãã£ã€ã€ã€æ®ºã›ï¼","ã‚¤ã‚¯ã‚¤ã‚¯ã‚¤ã‚¯ã‚¤ã‚¯ã‚¤ã‚¯ã£ã€ãŠã£ã¡ã‚“ã½ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ï¼"]}};class w extends Phaser.Scene{constructor(){super({key:"Stage2Scene"}),this.mapManager=null,this.playerController=null,this.touchControlManager=null,this.uiManager=null,this.cameraManager=null,this.inputManager=null,this.collisionManager=null,this.behaviorManager=null,this.dialogSystem=null,this.audioManager=null,this.conversationTrigger=null,this.updateCounter=0}preload(){this.load.tilemapTiledJSON("map","assets/maps/test_map5.tmj"),this.load.audio("bgm_Pollyanna","assets/audio/bgm/stage2/Pollyanna.mp3"),this.load.on("fileerror",(e=>{console.error(`Stage 2: ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼ - ${e.key}: ${e.url}`)})),this.load.on("filecomplete",((e,t)=>{"bgm_Pollyanna"===e&&console.log(`Stage 2: BGMãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿æˆåŠŸ - ${e}: ${t}`)})),this.load.image("GK_A2_C_autotile","assets/maps/tilesets/stage2/GK_A2_JC_autotile.png"),this.load.image("Preview_RPGMakerVXAce","assets/maps/tilesets/stage2/Preview_RPGMakerVXAce.png"),this.load.image("Preview","assets/maps/tilesets/stage2/Preview.png"),this.load.image("GK_JC_A5_2","assets/maps/tilesets/stage2/GK_JC_A5_2.png"),this.load.image("GK_JC_B_2","assets/maps/tilesets/stage2/GK_JC_B_2.png"),this.load.image("Tilemap","assets/maps/tilesets/stage2/Tilemap.png"),this.load.image("pipo-map001_at-kusa","assets/maps/tilesets/stage2/pipo-map001_at-kusa.png");const e={frameWidth:32,frameHeight:32};this.load.spritesheet("enemy1","assets/characters/enemies/pipo-charachip005a.png",e),this.load.spritesheet("friend2_6","assets/characters/npcs/pipo-charachip007a.png",e),this.load.spritesheet("friend2_5","assets/characters/npcs/pipo-charachip007a.png",e),this.load.spritesheet("friend2_4","assets/characters/npcs/pipo-charachip007a.png",e),this.load.spritesheet("friend2_3","assets/characters/npcs/pipo-charachip007a.png",e),this.load.spritesheet("friend2_2","assets/characters/npcs/pipo-charachip007a.png",e),this.load.spritesheet("friend2_1","assets/characters/npcs/pipo-charachip007a.png",e),this.load.spritesheet("kuccoro1","assets/characters/npcs/pipo-charachip022a.png",e),this.load.spritesheet("kuccoro","assets/characters/npcs/pipo-charachip022e.png",e),this.load.spritesheet("kuccoro2","assets/characters/npcs/pipo-charachip024d.png",e),this.load.audio("se_touch_stage2","assets/audio/se/touch_3.mp3"),this.load.on("complete",(()=>{console.log("Stage 2: ã‚¢ã‚»ãƒƒãƒˆèª­ã¿è¾¼ã¿å®Œäº†")}))}create(){try{let e=!1;if(this.load.isLoading()?this.load.once("complete",(()=>{e||(e=!0,this.initializeAudioManager())})):e||(e=!0,this.initializeAudioManager()),this.collisionManager=new u(this),this.collisionManager.setupCollisionGroups(),this.dialogSystem=new m(this,C),this.collisionManager.setDialogSystem(this.dialogSystem),this.behaviorManager=new S(this),this.mapManager=new o(this),this.mapManager.createMap(),this.playerController=new n(this),this.playerController.createPlayer(100,100),!this.physics)return void console.error("Stage 2: ç‰©ç†ã‚·ã‚¹ãƒ†ãƒ ãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“");this.inputManager=new g,this.inputManager.setupKeyboard(this,this.playerController),this.touchControlManager=new h(this,this.playerController.player,"se_touch_stage2"),this.uiManager=new l,this.uiManager.createUI(this),this.cameraManager=new p(this),this.cameraManager.setupCamera(this,this.mapManager.map,this.playerController.player),this.collisionManager.setupAllCollisions(this.playerController.player,this.mapManager),console.log("Stage 2: åˆæœŸåŒ–å®Œäº† - ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ä½ç½®:",this.playerController.getPosition()),console.log("Stage 2: ç‰©ç†ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ…‹:",!!this.physics),console.log("Stage 2: å…¥åŠ›ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ…‹:",!!this.input),this.conversationTrigger=new M(this);try{this.scene.manager&&this.scene.manager.keys&&this.scene.manager.keys.ConversationScene||this.scene.add("ConversationScene",b)}catch(e){}this.setupConversationEvents(),this.events.on("shutdown",this.shutdown,this)}catch(e){console.error("Stage 2: åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:",e)}}initializeAudioManager(){try{this.audioManager=new f.AudioManager(this);const e=()=>{if(this.scene&&this.scene.manager&&this.scene.manager.isActive("ConversationScene"))console.log("Stage 2: ä¼šè©±ä¸­ã€BGMå†é–‹ã‚’ã‚¹ã‚­ãƒƒãƒ—");else try{console.log("Stage 2: BGMå†ç”Ÿé–‹å§‹"),this.audioManager.playBgm("bgm_Pollyanna")?console.log("Stage 2: BGMå†ç”ŸæˆåŠŸ"):(console.warn("Stage 2: BGMå†ç”Ÿå¤±æ•—"),console.log("Stage 2: BGMå†ç”Ÿå¤±æ•—ã—ã¾ã—ãŸãŒã€ã‚²ãƒ¼ãƒ ã¯ç¶šè¡Œã—ã¾ã™"))}catch(e){console.error("Stage 2: BGMå†ç”Ÿã‚¨ãƒ©ãƒ¼:",e),console.log("Stage 2: BGMå†ç”Ÿã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸãŒã€ã‚²ãƒ¼ãƒ ã¯ç¶šè¡Œã—ã¾ã™")}};if(this.sound&&this.sound.locked){this.sound.once("unlocked",(()=>{console.log("Stage 2: éŸ³å£°ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ³ãƒ­ãƒƒã‚¯"),e()})),this.input&&this.input.once&&this.input.once("pointerdown",(()=>{try{this.sound.context&&"running"!==this.sound.context.state&&this.sound.context.resume()}catch(e){console.warn("Stage 2: éŸ³å£°ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆå¾©å¸°ã‚¨ãƒ©ãƒ¼:",e)}e()}));try{this.input&&this.input.keyboard&&this.input.keyboard.once("keydown",e)}catch(e){console.warn("Stage 2: ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚¤ãƒ™ãƒ³ãƒˆè¨­å®šã‚¨ãƒ©ãƒ¼:",e)}}else console.log("Stage 2: éŸ³å£°ã‚·ã‚¹ãƒ†ãƒ ã¯æ—¢ã«ã‚¢ãƒ³ãƒ­ãƒƒã‚¯æ¸ˆã¿"),e()}catch(e){console.error("Stage 2: AudioManageråˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:",e)}}setupConversationEvents(){this.setupNpcConversations(),this.setupAreaTriggers(),this.setupProximityTriggers()}setupNpcConversations(){console.log("Stage 2: NPCä¼šè©±è¨­å®šå®Œäº†")}setupAreaTriggers(){console.log("Stage 2: ã‚¨ãƒªã‚¢ãƒˆãƒªã‚¬ãƒ¼è¨­å®šå®Œäº†")}setupProximityTriggers(){console.log("Stage 2: è¿‘æ¥ãƒˆãƒªã‚¬ãƒ¼è¨­å®šå®Œäº†")}shutdown(){if(this.audioManager)try{this.audioManager.stopAll(),this.audioManager.destroy()}catch(e){console.warn("Stage 2: AudioManagerç ´æ£„ã‚¨ãƒ©ãƒ¼:",e)}finally{this.audioManager=null}try{this.sound&&this.sound.context&&(this.sound.context.close(),this.sound.context=null)}catch(e){console.warn("Stage 2: éŸ³å£°ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒªã‚»ãƒƒãƒˆã‚¨ãƒ©ãƒ¼:",e)}if(this.sound)try{this.sound.stopAll(),this.sound.context&&(this.sound.context.state="suspended")}catch(e){console.warn("Stage 2: éŸ³å£°ã‚·ã‚¹ãƒ†ãƒ ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã‚¨ãƒ©ãƒ¼:",e)}try{this.load&&this.load.reset&&this.load.reset()}catch(e){}try{this.load&&this.load.removeAllListeners&&this.load.removeAllListeners()}catch(e){}this.playerController&&(this.playerController.destroy(),this.playerController=null),this.touchControlManager&&(this.touchControlManager.destroy(),this.touchControlManager=null),this.uiManager&&(this.uiManager.destroy(),this.uiManager=null),this.cameraManager&&(this.cameraManager.destroy(),this.cameraManager=null),this.inputManager&&(this.inputManager.destroy(),this.inputManager=null),this.collisionManager&&(this.collisionManager.destroy(),this.collisionManager=null),this.behaviorManager&&(this.behaviorManager.destroy(),this.behaviorManager=null),this.dialogSystem&&(this.dialogSystem.destroy(),this.dialogSystem=null),this.conversationTrigger&&(this.conversationTrigger.destroy(),this.conversationTrigger=null),this.events.off("shutdown",this.shutdown,this)}update(){if(this.updateCounter++,this.updateCounter%2==0){if(this.dialogSystem&&this.dialogSystem.isDialogActive())return this.playerController.player.setVelocityX(0),void this.playerController.player.setVelocityY(0);if(this.playerController&&this.playerController.player){if(this.playerController.update(),this.updateCounter%120==0){const e=this.playerController.getPosition();console.log("Stage 2: ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ä½ç½®æ›´æ–° - X:",e.x,"Y:",e.y)}}else console.warn("Stage 2: ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“");this.uiManager&&this.playerController&&this.playerController.player&&this.uiManager.updatePlayerPosition(this.playerController.player)}}resize(e){const{width:t,height:a}=e;this.cameras.resize(t,a)}destroy(){this.shutdown(),super.destroy()}}class _ extends Phaser.Scene{constructor(){super({key:"Stage3Scene"}),this.mapManager=null,this.playerController=null,this.touchControlManager=null,this.uiManager=null,this.cameraManager=null,this.inputManager=null,this.collisionManager=null,this.audioManager=null,this.updateCounter=0}preload(){this.load.tilemapTiledJSON("map","assets/test_map5.tmj"),this.load.audio("bgm_stage3","assets/audio/bgm/stage1/kessen_diaruga.mp3"),this.load.audio("se_touch_stage3","assets/audio/se/touch_6.mp3"),this.load.on("complete",(()=>{}))}create(){this.audioManager=new f.AudioManager(this);try{this.audioManager.ensureAudioUnlocked&&this.audioManager.ensureAudioUnlocked()}catch(e){}this.audioManager.playBgm("bgm_stage3"),this.collisionManager=new u(this),this.collisionManager.setupCollisionGroups(),this.mapManager=new o(this),this.mapManager.createMap(),this.playerController=new n(this),this.playerController.createPlayer(100,100),this.touchControlManager=new h(this,this.playerController.player,"se_touch_stage3"),this.uiManager=new l,this.uiManager.createUI(this),this.cameraManager=new p(this),this.cameraManager.setupCamera(this,this.mapManager.map,this.playerController.player),this.inputManager=new g,this.inputManager.setupKeyboard(this,this.playerController),this.collisionManager.setupAllCollisions(this.playerController.player,this.mapManager),this.events.on("shutdown",this.shutdown,this)}shutdown(){this.audioManager&&this.audioManager.stopAll&&(this.audioManager.stopAll(),this.audioManager.bgm&&this.audioManager.bgm.destroy&&(this.audioManager.bgm.destroy(),this.audioManager.bgm=null)),this.sound&&this.sound.stopAll()}update(){this.playerController&&this.playerController.update(),this.updateCounter||(this.updateCounter=0),this.updateCounter++,this.updateCounter%2==0&&this.uiManager&&this.playerController&&this.uiManager.updatePlayerPosition(this.playerController.player)}resize(e){const{width:t,height:a}=e;this.cameras.resize(t,a)}destroy(){this.shutdown(),this.mapManager&&this.mapManager.destroy&&this.mapManager.destroy(),this.audioManager&&this.audioManager.destroy&&this.audioManager.destroy(),this.touchControlManager&&this.touchControlManager.destroy&&this.touchControlManager.destroy(),this.collisionManager&&this.collisionManager.destroy&&this.collisionManager.destroy(),this.dialogSystem&&this.dialogSystem.destroy&&this.dialogSystem.destroy(),super.destroy()}}var A=a(327),B=a(362),T=a(527);class z{constructor(){this.storageKey="event_completed_",this.excludedAreas=["mie_high_school","taketa_high_school"]}isAreaCompleted(e){return!this.excludedAreas.includes(e)&&"true"===localStorage.getItem(this.storageKey+e)}markAreaAsCompleted(e){this.excludedAreas.includes(e)||localStorage.setItem(this.storageKey+e,"true")}resetAllCompletions(){Object.keys(localStorage).forEach((e=>{e.startsWith(this.storageKey)&&localStorage.removeItem(e)}))}getCompletedAreas(){const e=[];return Object.keys(localStorage).forEach((t=>{if(t.startsWith(this.storageKey)){const a=t.replace(this.storageKey,"");this.excludedAreas.includes(a)||e.push(a)}})),e}}class P{constructor(e){this.scene=e,this.areas=[],this.areaSprites=[],this.selectedArea=null,this.completionManager=new z,this.isInteractive=!0,this.hoverEffect=null,this.isMobile=this.scene.sys.game.device.input.touch,this.touchStartTime=0,this.touchThreshold=200,this.visualFeedback=new c(e),this.isConfirmDialogActive=!1,this.currentDialog=null}setupAreas(e){console.log("[AreaSelectionManager] setupAreasé–‹å§‹: areas="+(e?e.length:"undefined")),this.destroy(),this.areaSprites=[],e&&Array.isArray(e)?(this.areas=e.map((e=>({...e,description:this.getAreaDescription(e.name)}))),console.log("[AreaSelectionManager] ã‚¨ãƒªã‚¢ãƒ‡ãƒ¼ã‚¿è¨­å®šå®Œäº†: "+this.areas.length+"å€‹")):(this.areas=[],console.warn("[AreaSelectionManager] ç„¡åŠ¹ãªã‚¨ãƒªã‚¢ãƒ‡ãƒ¼ã‚¿:",e)),console.log("[AreaSelectionManager] ãƒãƒ¼ã‚«ãƒ¼ä½œæˆé–‹å§‹: "+this.areas.length+"å€‹ã®ã‚¨ãƒªã‚¢"),this.areas.forEach(((e,t)=>{if(e){console.log("[AreaSelectionManager] ã‚¨ãƒªã‚¢"+t+"ã®ãƒãƒ¼ã‚«ãƒ¼ä½œæˆ: "+e.name+" (x:"+e.x+", y:"+e.y+", w:"+e.width+", h:"+e.height+")");const a=this.createAreaMarker(e);a?(this.areaSprites.push(a),console.log("[AreaSelectionManager] ãƒãƒ¼ã‚«ãƒ¼ä½œæˆæˆåŠŸ: "+e.name)):console.warn("[AreaSelectionManager] ãƒãƒ¼ã‚«ãƒ¼ä½œæˆå¤±æ•—: "+e.name)}else console.warn("[AreaSelectionManager] ç„¡åŠ¹ãªã‚¨ãƒªã‚¢ãƒ‡ãƒ¼ã‚¿: index="+t)})),console.log("[AreaSelectionManager] ãƒãƒ¼ã‚«ãƒ¼ä½œæˆå®Œäº†: "+this.areaSprites.length+"å€‹ã®ãƒãƒ¼ã‚«ãƒ¼"),this.setupInteractionEvents()}getAreaDescription(e){return{Trial:"ãƒˆãƒ©ã‚¤ã‚¢ãƒ«",Flash_land_mie:"ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ãƒ©ãƒ³ãƒ‰ä¸‰é‡",oreno_koto:"ä¿ºã®ã“ã¨",momoiro_jyogakuenn:"ï¼’åŒ¹ã®ç‹¼ã¨ç²ç‰©",drinking_dutu:"ã¥ã¤",Weeds_burn:"é›‘è‰ãŒã‚‚ãˆã‚‹ã…ã…",mie_high_school:"ä¸‰é‡ä¸­å­¦æ ¡",raizu:"ãƒ©ã‚¤ã‚º",snack_street_night:"ä¸‰é‡ç”ºã®æ­“æ¥½è¡—",souce:"ã‚½ãƒ¼ã‚¹",koutaroupoteto:"ã“ã†ãŸã‚ã†ãƒãƒ†ãƒˆ",seven:"ã‚»ãƒ–ãƒ³",taketa_station:"ç«¹ç”°é§…",taketa_high_school:"ç«¹ç”°é«˜æ ¡",galaxy_water:"éŠ€æ²³ã®æ°´",udefuriojisann:"ã‚¦ãƒ‡ãƒ•ãƒªã‚ªã‚¸ã‚µãƒ³",working_go_to_home_miemachi:"é£²ã¿ä¼šå¾Œä¸‰é‡ç”ºã¾ã§æ­©ã",computer:"ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢",breaking_car:"BMW",special_scam:"ã‚ã‚„ã—ã„ãŠã˜ã•ã‚“",rojyounopenki:"è·¯ä¸Šã®ãƒšãƒ³ã‚­",tereapo:"ãƒ†ãƒ¬ã‚¢ãƒ",first_rising_sun:"åˆæ—¥ã®å‡º",arechi:"è’åœ°",gray_bytes:"ã‚°ãƒ¬ãƒ¼ãƒã‚¤ãƒˆ"}[e]||e}createAreaMarkers(){console.log(`[AreaSelectionManager] createAreaMarkersé–‹å§‹: areas=${this.areas?this.areas.length:"undefined"}`),this.areaSprites=[],this.areas&&0!==this.areas.length?(console.log(`[AreaSelectionManager] ã‚¨ãƒªã‚¢æ•°: ${this.areas.length}`),this.areas.forEach(((e,t)=>{if(e){console.log(`[AreaSelectionManager] ã‚¨ãƒªã‚¢${t}: ${e.name}`);const a=this.createAreaMarker(e);a&&this.areaSprites.push(a)}})),console.log(`[AreaSelectionManager] createAreaMarkerså®Œäº†: ä½œæˆã•ã‚ŒãŸãƒãƒ¼ã‚«ãƒ¼æ•°=${this.areaSprites.length}`)):console.warn("[AreaSelectionManager] ã‚¨ãƒªã‚¢ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“: areas=",this.areas)}createAreaMarker(e){const t=this.scene.add.container(0,0);t.setData("markerType","areaMarker"),t.setData("areaName",e.name),t.setData("markerId",`marker_${e.name}_${Date.now()}_${Math.random().toString(36).substr(2,9)}`);const a=this.scene.mapManager?.mapScaleX||1,s=Math.max(10,Math.floor(10*a))+"px",r=Math.max(15,15*a),i=e.width||100,o=e.height||100,n=e.x,c=e.y,h=e.ellipse||!1,l=e.rotation||0,p=this.completionManager.isAreaCompleted(e.name),g=n+i/2,u=c+o/2;let d,m=g,x=u;if(0!==l){const e=l*Math.PI/180,t=g-n,a=u-c;m=n+(t*Math.cos(e)-a*Math.sin(e)),x=c+(t*Math.sin(e)+a*Math.cos(e))}p?(d=h?this.scene.add.ellipse(m,x,i,o,65280,.3):this.scene.add.rectangle(m,x,i,o,65280,.3),d.setAlpha(.7),this.scene.tweens.add({targets:d,alpha:1,duration:1500,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"})):d=h?this.scene.add.ellipse(m,x,i,o,4286945,0):this.scene.add.rectangle(m,x,i,o,4286945,0),d&&(d.setData("markerType","areaMarker"),d.setData("areaName",e.name),d.setData("isCompleted",p),d.setOrigin(.5,.5),0!==l&&d.setRotation(l*Math.PI/180));const k=this.scene.add.text(n+i/2,c-r,e.description,{fontSize:s,fill:p?"#00AA00":"#000000",backgroundColor:p?"#90EE90":"#FFFFFF",padding:{x:3*a,y:1*a},borderRadius:2*a});if(k.setOrigin(.5,.5),k.setData("markerType","areaMarker"),k.setData("areaName",e.name),k.setData("isCompleted",p),p){const s=Math.max(8,Math.floor(12*a)),o=this.scene.add.text(n+i/2,c-r-s/2,"âœ“",{fontSize:s+"px",fill:"#00FF00",fontWeight:"bold"});o.setOrigin(.5,.5),o.setData("markerType","areaMarker"),o.setData("areaName",e.name),t&&t.add&&t.add(o)}d&&t.add(d),t.add(k),d.setInteractive(),d.setData("area",e),this.setupMarkerHover(d,k),this.setupMarkerClick(d);try{this.scene.add.existing?this.scene.add.existing(t):this.scene.children.add(t)}catch(t){console.error(`[AreaSelectionManager] ãƒãƒ¼ã‚«ãƒ¼ã‚’ã‚·ãƒ¼ãƒ³ã«è¿½åŠ å¤±æ•—: ${e.name}`,t)}return t}setupMarkerHover(e,t){e.on("pointerover",(()=>{this.isMobile||(this.visualFeedback.showButtonHover(e,1.2,16766720,.3),t.setStyle({fill:"#FF0000"}))})),e.on("pointerout",(()=>{this.isMobile||(this.visualFeedback.resetButtonState(e,1,4286945,.1),t.setStyle({fill:"#000000"}))}))}setupMarkerClick(e){e.on("pointerdown",(()=>{if(this.isConfirmDialogActive)return;if(this.isConversationActive())return;this.isMobile&&(this.touchStartTime=Date.now()),this.resetAllObjectColors(),e.setFillStyle(16711680,.7);const t=e.getData("area"),a=t.x+(t.width||100)/2,s=t.y+(t.height||100)/2;this.visualFeedback.showObjectRipple(a,s,t.width||100,t.height||100,16711680)})),e.on("pointerup",(()=>{if(this.isConfirmDialogActive)return;if(this.isConversationActive())return;const t=e.getData("area");this.isMobile?Date.now()-this.touchStartTime<this.touchThreshold&&this.selectArea(t):this.selectArea(t)}))}setupInteractionEvents(){this.scene.input.on("pointerdown",(e=>{try{if(this.scene.sound&&this.scene.sound.locked){try{this.scene.sound.context&&"running"!==this.scene.sound.context.state&&this.scene.sound.context.resume()}catch(e){console.warn("[AreaSelectionManager] éŸ³å£°ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆå¾©å¸°ã‚¨ãƒ©ãƒ¼:",e)}try{const e=this.scene.sound.context;if(e&&"function"==typeof e.createOscillator){const t=e.createOscillator(),a=e.createGain();a.gain.value=1e-4,t.connect(a).connect(e.destination),t.start(),t.stop(e.currentTime+.05)}}catch(e){console.warn("[AreaSelectionManager] ç„¡éŸ³ã‚ªã‚·ãƒ¬ãƒ¼ã‚¿ãƒ¼ä½œæˆã‚¨ãƒ©ãƒ¼:",e)}}}catch(e){console.warn("[AreaSelectionManager] éŸ³å£°ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆå‡¦ç†ã‚¨ãƒ©ãƒ¼:",e)}this.lastTapX=e.x,this.lastTapY=e.y})),this.scene.input.on("pointerup",(e=>{Math.abs(e.x-this.lastTapX),Math.abs(e.y-this.lastTapY)}))}selectArea(e){try{if(!this.isInteractive)return;if(this.isConfirmDialogActive)return;this.selectedArea=e,this.showSelectionEffect(e),this.playSelectionSound()}catch(t){console.error(`[AreaSelectionManager] selectAreaã‚¨ãƒ©ãƒ¼: ${e.name}`,t)}}showSelectionEffect(e){this.showConfirmDialog(e)}resetAllObjectColors(){this.areaSprites.forEach((e=>{const t=e.getAt(0);if(t&&t.setFillStyle){const a=e.getData("areaName");this.completionManager.isAreaCompleted(a)?t.setFillStyle(65280,.3):t.setFillStyle(4286945,.1)}}))}resetSelectedObjectColor(){this.selectedArea&&this.areaSprites.forEach((e=>{const t=e.getAt(0);if(t&&t.setFillStyle){const e=t.getData("area");e&&e.name===this.selectedArea.name&&t.setFillStyle(4286945,.1)}}))}showConfirmDialog(e){if(this.isConfirmDialogActive)return;this.isConfirmDialogActive=!0;const t=this.scene.add.container(this.scene.cameras.main.worldView.centerX,this.scene.cameras.main.worldView.centerY);this.currentDialog=t;const a=this.scene.add.rectangle(0,0,300,150,0,.8);a.setStrokeStyle(2,16777215);const s=this.scene.add.text(0,-40,e.description,{fontSize:"18px",fill:"#FFFFFF",align:"center"});s.setOrigin(.5);const r=this.scene.add.text(0,-10,"ã“ã®å ´æ‰€ã«ç§»å‹•ã—ã¾ã™ã‹ï¼Ÿ",{fontSize:"14px",fill:"#FFFFFF",align:"center"});r.setOrigin(.5);const i=this.scene.add.text(-60,30,"ã¯ã„",{fontSize:"16px",fill:"#00FF00",backgroundColor:"#333333",padding:{x:10,y:5}});i.setOrigin(.5),i.setInteractive();const o=this.scene.add.text(60,30,"ã„ã„ãˆ",{fontSize:"16px",fill:"#FF0000",backgroundColor:"#333333",padding:{x:10,y:5}});o.setOrigin(.5),o.setInteractive(),t.add([a,s,r,i,o]);const n=()=>{t.active&&t.destroy(),this.isConfirmDialogActive=!1,this.currentDialog=null,this.resetSelectedObjectColor()};i.on("pointerdown",(()=>{try{if(this.scene){if(this.scene._suppressMapBgm=!0,this.scene._bgmRetry&&this.scene._bgmRetry.remove){try{this.scene._bgmRetry.remove(!1)}catch(e){}this.scene._bgmRetry=null}try{this.scene._htmlBgm&&!this.scene._htmlBgm.paused&&this.scene._htmlBgm.pause()}catch(e){}}}catch(e){}n(),this.handleAreaSelection(e)})),o.on("pointerdown",(()=>{n()})),this.scene.time.delayedCall(5e3,(()=>{t.active&&n()}))}handleAreaSelection(e){if(this.scene.mapConfig&&"taketa"===this.scene.mapConfig.mapKey)this.handleTaketaConversation(e);else if(this.scene.mapConfig&&"miemachi"===this.scene.mapConfig.mapKey)try{this.handleMiemachiConversation(e)}catch(e){console.error("[AreaSelectionManager] handleAreaSelection: handleMiemachiConversationå‘¼ã³å‡ºã—ã‚¨ãƒ©ãƒ¼:",e)}else this.scene.mapConfig&&"japan"===this.scene.mapConfig.mapKey?this.handleJapanConversation(e):this.scene.time.delayedCall(1e3,(()=>{this.navigateToArea(e)}))}handleTaketaConversation(e){let t=null;if(e.conversationId&&null!==e.conversationId)t=e.conversationId;else switch(e.name){case"taketa_station":t="taketa_station";break;case"galaxy_water":t="galaxy_water";break;case"udefuriojisann":t="udefuriojisann";break;case"working_go_to_home_miemachi":t="working_go_to_home_miemachi";break;default:return void this.scene.time.delayedCall(1e3,(()=>{this.navigateToArea(e)}))}const a=this.scene.mapConfig?.mapKey||"unknown";this.getConversationData(a,t)?this.startDynamicConversation(t):this.scene.time.delayedCall(1e3,(()=>{this.navigateToArea(e)}))}handleJapanConversation(e){console.log("[AreaSelectionManager] handleJapanConversationé–‹å§‹:",e);let t=null;if(e.conversationId&&null!==e.conversationId)t=e.conversationId,console.log("[AreaSelectionManager] conversationIdã‹ã‚‰å–å¾—:",t);else switch(e.name){case"computer":t="computer";break;case"breaking_car":t="breaking_car";break;case"special_scam":t="special_scam";break;case"rojyounopenki":t="rojyounopenki";break;case"tereapo":t="tereapo";break;case"first_rising_sun":t="first_rising_sun";break;case"arechi":t="arechi";break;default:return void this.scene.time.delayedCall(1e3,(()=>{this.navigateToArea(e)}))}const a=this.scene.mapConfig?.mapKey||"unknown";this.getConversationData(a,t)?this.startDynamicConversation(t):this.scene.time.delayedCall(1e3,(()=>{this.navigateToArea(e)}))}handleMiemachiConversation(e){let t=null;if(e.conversationId&&null!==e.conversationId)t=e.conversationId;else switch(e.name){case"oreno_koto":t="oreno_koto";break;case"raizu":t="raizu";break;case"souce":t="souce";break;case"Weeds_burn":t="Weeds_burn";break;case"koutaroupoteto":t="koutaroupoteto";break;case"drinking_dutu":t="drinking_dutu";break;case"snack_street_night":t="snack_street_night";break;case"momoiro_jyogakuenn":t="momoiro_jyogakuenn";break;case"Flash_land_mie":t="flash_land_mie";break;default:return void this.scene.time.delayedCall(1e3,(()=>{this.navigateToArea(e)}))}const a=this.scene.mapConfig?.mapKey||"unknown";this.getConversationData(a,t)?this.startDynamicConversation(t):this.scene.time.delayedCall(1e3,(()=>{this.navigateToArea(e)}))}startDynamicConversation(e){try{a.e(92).then(a.bind(a,92)).then((({DynamicConversationScene:t})=>{this.scene.scene.get(e)&&this.scene.scene.remove(e);try{this.scene.scene.add(e,t,!1,{eventId:e}),this.scene.time.delayedCall(300,(()=>{try{this.scene.scene.get(e)?this.scene.scene.start(e):this.scene.scene.launch(e)}catch(t){try{this.scene.scene.launch(e)}catch(t){console.error(`[AreaSelectionManager] ã‚·ãƒ¼ãƒ³é–‹å§‹å¤±æ•—: ${e}`,t)}}}))}catch(t){console.error(`[AreaSelectionManager] ã‚·ãƒ¼ãƒ³ç™»éŒ²ã‚¨ãƒ©ãƒ¼: ${e}`,t)}})).catch((t=>{console.error(`[AreaSelectionManager] DynamicConversationSceneé–‹å§‹ã‚¨ãƒ©ãƒ¼: ${e}`,t)}))}catch(t){console.error(`[AreaSelectionManager] DynamicConversationSceneé–‹å§‹ã‚¨ãƒ©ãƒ¼: ${e}`,t)}}getConversationData(e,t){let a;switch(e){case"miemachi":a=B.miemachiConversationData[t];break;case"taketa":a=A.taketaConversationData[t];break;case"japan":a=T.japanConversationData[t];break;default:a=B.miemachiConversationData[t]||A.taketaConversationData[t]||T.japanConversationData[t]}return a}navigateToArea(e){if(!e.sceneParam&&e.name){const t=this.scene.mapConfig?.areas?.find((t=>t.name===e.name));t&&(e.sceneParam=t.sceneParam,e.scene=t.scene)}if(e.scene)if("startPhaserGame"===e.scene){const t=this.scene.mapConfig?.mapKey||"unknown",s=e.sceneParam||1;window.returnToMap=()=>{if(!window.__navigating){window.__navigating=!0;try{window.game&&window.game.sound&&window.game.sound.stopAll()}catch(e){}try{if(window.game&&window.game.scene&&window.game.scene.getScenes){const e=window.game.scene.getScenes(!1)||[];for(const t of e){try{t.scene&&t.scene.stop&&t.scene.stop()}catch(e){}try{t.scene&&t.scene.remove&&t.scene.remove()}catch(e){}}}}catch(e){}try{window.game&&window.game.destroy(!0)}catch(e){}window.game=null,window.gameInstance=null,setTimeout((()=>{Promise.resolve().then(a.bind(a,61)).then((({startPhaserGame:e})=>{try{e(t)}finally{window.__navigating=!1}})).catch((()=>{window.__navigating=!1}))}),50)}},this.scene.scene.get("ConversationScene")&&this.scene.scene.remove("ConversationScene");try{this.scene.load&&this.scene.load.reset&&this.scene.load.reset()}catch(e){}try{this.scene.load&&this.scene.load.removeAllListeners&&this.scene.load.removeAllListeners()}catch(e){}try{this.scene.scene.stop()}catch(e){}Promise.resolve().then(a.bind(a,61)).then((({startPhaserGame:e})=>{try{e(s)}catch(e){}}))}else Promise.resolve().then(a.bind(a,61)).then((({startPhaserGame:t})=>{t(e.scene)}))}playSelectionSound(){try{this.scene.audioManager&&this.scene.audioManager.playSe("se_touch",.5)}catch(e){}}enableInteraction(){this.isInteractive=!0}disableInteraction(){this.isInteractive=!1}update(){}handleTouchAt(e,t){try{const a=this.findAreaAtPosition(e,t);if(a){if(this.isConversationActive())return;this.selectArea(a)}else this.scene.audioManager&&this.scene.audioManager.playSe("se_map_touch",.3)}catch(e){console.error("AreaSelectionManager: Error in handleTouchAt:",e)}}findAreaAtPosition(e,t){const a=20*(this.scene.mapManager?.mapScaleX||1);for(let s of this.areas)if(Math.sqrt(Math.pow(e-s.x,2)+Math.pow(t-s.y,2))<=a)return s;return null}getAreas(){return this.areas}findAreaByName(e){return this.areas.find((t=>t.name===e))}markAreaAsCompleted(e){this.completionManager.markAreaAsCompleted(e),this.updateAreaCompletionDisplay(e)}updateAreaCompletionDisplay(e){this.areaSprites.forEach((t=>{if(t&&t.getData("areaName")===e){if(!t.children)return void console.warn(`[AreaSelectionManager] ãƒãƒ¼ã‚«ãƒ¼ ${e} ã®å­è¦ç´ ãŒå­˜åœ¨ã—ã¾ã›ã‚“`);let a=[];try{if(t.children.entries)a=t.children.entries;else if(t.children.list)a=t.children.list;else{if(!Array.isArray(t.children))return void console.warn(`[AreaSelectionManager] ãƒãƒ¼ã‚«ãƒ¼ã®å­è¦ç´ ã®å½¢å¼ãŒä¸æ˜: ${e}`);a=t.children}}catch(t){return void console.warn(`[AreaSelectionManager] ãƒãƒ¼ã‚«ãƒ¼ã®å­è¦ç´ ã®å–å¾—ã«å¤±æ•—: ${e}`,t.message)}const s=t.getAt(0),r=t.getAt(1);if(s&&r){const i=s.getData("area");if(i&&(i.ellipse,s.setFillStyle(65280,.3),this.scene.tweens.add({targets:s,alpha:.6,duration:1500,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"}),s.setData("isCompleted",!0)),r.setStyle({fill:"#00AA00",backgroundColor:"#90EE90"}),r.setData("isCompleted",!0),a.length<3){const a=this.scene.mapManager?.mapScaleX||1,s=Math.max(8,Math.floor(12*a)),r=i.x+(i.width||100)/2,o=this.scene.add.text(r,i.y-Math.max(15,15*a)-s/2,"âœ“",{fontSize:s+"px",fill:"#00FF00",fontWeight:"bold"});o.setOrigin(.5,.5),o.setData("markerType","areaMarker"),o.setData("areaName",e),t&&t.add&&t.add(o)}}}}))}getCompletedAreas(){return this.completionManager.getCompletedAreas()}recreateMarker(e){try{const t=this.areaSprites.find((t=>t&&t.getData("areaName")===e));t&&t.destroy();const a=this.areas.find((t=>t.name===e));if(!a)return;this.createAreaMarker(a)&&this.completionManager.isAreaCompleted(e)&&this.updateAreaCompletionDisplay(e)}catch(t){console.error(`[AreaSelectionManager] ãƒãƒ¼ã‚«ãƒ¼ ${e} ã®å†ä½œæˆã«å¤±æ•—:`,t)}}isConversationActive(){try{if(this.scene&&this.scene.scene){const e=this.scene.scene.get("ConversationScene");if(e&&e.scene&&e.scene.isActive())return!0}return!(!this.scene||!this.scene.conversationTrigger)&&this.scene.conversationTrigger.isActive()}catch(e){return console.warn("[AreaSelectionManager] ä¼šè©±çŠ¶æ…‹ãƒã‚§ãƒƒã‚¯ã‚¨ãƒ©ãƒ¼:",e),!1}}updateAreaPositions(e){e&&0!==e.length?(this.destroy(),this.scene&&this.scene.children&&this.scene.children.entries&&this.scene.children.entries.forEach((e=>{!e||"Container"!==e.type&&"Arc"!==e.type&&"Text"!==e.type||e.destroy&&e.destroy()})),this.areas=e.map((e=>{const t=this.areas.find((t=>t.name===e.name));let a=t?.sceneParam,s=t?.scene,r=t?.conversationId;if(!a||!s){const t=this.scene.mapConfig?.areas?.find((t=>t.name===e.name));t&&(a=t.sceneParam,s=t.scene,r=t.conversationId)}return{...e,sceneParam:a,scene:s,conversationId:r,description:this.getAreaDescription(e.name)}})),this.createAreaMarkers()):console.warn("AreaSelectionManager: No areas provided for marker update")}updateExistingMarkers(e){e&&Array.isArray(e)?(this.areas=e.map((e=>({...e,description:this.getAreaDescription(e.name)}))),this.areaSprites.forEach(((e,t)=>{if(e&&this.areas[t]){const a=this.areas[t];this.updateMarkerPosition(e,a)}}))):console.warn("[AreaSelectionManager] updateExistingMarkers: ç„¡åŠ¹ãªã‚¨ãƒªã‚¢ãƒ‡ãƒ¼ã‚¿")}updateMarkerPosition(e,t){if(!e||!t)return;const a=this.scene.mapManager?.mapScaleX||1,s=Math.max(15,15*a);e.children&&e.children.entries&&e.children.entries.forEach((e=>{if(e&&e.getData&&"areaMarker"===e.getData("markerType"))if("Ellipse"===e.type||"Rectangle"===e.type){const a=t.x+(t.width||100)/2,s=t.y+(t.height||100)/2;e.setPosition(a,s),"Ellipse"===e.type?e.setRadius((t.width||100)/2,(t.height||100)/2):e.setSize(t.width||100,t.height||100)}else if("Text"===e.type){const r=t.x+(t.width||100)/2,i=t.y-s;e.setPosition(r,i);const o=10,n=Math.max(o,Math.floor(10*a))+"px";e.setStyle({fontSize:n})}}))}repositionMarkers(){const e=this.scene.mapManager?.mapScaleX||1,t=15*e;this.areaSprites.forEach(((a,s)=>{if(a&&this.areas[s]){const r=this.areas[s];a.children.entries.forEach((a=>{if("Arc"===a.type)a.setPosition(r.x,r.y),a.setRadius(10*e),a.setStrokeStyle(2*e,16777215);else if("Text"===a.type){a.setPosition(r.x,r.y-t);const s=Math.max(8,Math.floor(10*e))+"px";a.setStyle({fontSize:s})}}))}}))}destroy(){this.currentDialog&&this.currentDialog.active&&this.currentDialog.destroy(),this.isConfirmDialogActive=!1,this.currentDialog=null,this.forceRemoveGreenMarkers(),this.areaSprites&&Array.isArray(this.areaSprites)&&this.areaSprites.forEach(((e,t)=>{if(e)try{e.destroy&&e.destroy()}catch(e){console.warn(`[AreaSelectionManager] ãƒãƒ¼ã‚«ãƒ¼ ${t} å‰Šé™¤ã‚¨ãƒ©ãƒ¼:`,e)}})),this.removeAllMarkerObjects(),this.areaSprites=[],this.selectedArea=null}removeAllMarkerObjects(){if(!this.scene||!this.scene.children||!this.scene.children.list)return;const e=[];[...this.scene.children.list].forEach((t=>{t&&t.getData&&"areaMarker"===t.getData("markerType")?e.push(t):t instanceof Phaser.GameObjects.Container&&t.each((a=>{a&&a.getData&&"areaMarker"===a.getData("markerType")&&(e.includes(t)||e.push(t))}))})),e.forEach((e=>{try{e.destroy&&e.destroy()}catch(e){console.warn("[AreaSelectionManager] ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå‰Šé™¤ã‚¨ãƒ©ãƒ¼:",e)}}))}forceRemoveGreenMarkers(){if(!this.scene||!this.scene.children||!this.scene.children.list)return;const e=[];[...this.scene.children.list].forEach((t=>{if(t&&t.getData&&"areaMarker"===t.getData("markerType")){let a=!1;t instanceof Phaser.GameObjects.Container&&t.each((e=>{if(e&&void 0!==e.fillColor&&(65280!==e.fillColor&&9498256!==e.fillColor||(a=!0)),e&&e.style&&e.style.color){const t=e.style.color.toLowerCase();"#00ff00"!==t&&"#90ee90"!==t&&"#00aa00"!==t||(a=!0)}if(e&&e.style&&e.style.backgroundColor){const t=e.style.backgroundColor.toLowerCase();"#00ff00"!==t&&"#90ee90"!==t&&"#00aa00"!==t||(a=!0)}})),a&&e.push(t)}})),e.forEach((e=>{try{e.destroy&&e.destroy()}catch(e){console.warn("[AreaSelectionManager] ç·‘è‰²ãƒãƒ¼ã‚«ãƒ¼ã‚³ãƒ³ãƒ†ãƒŠå‰Šé™¤ã‚¨ãƒ©ãƒ¼:",e)}}))}}var D=a(364);class G extends Phaser.Scene{constructor(e){super({key:e.sceneKey}),this.mapConfig=e.mapConfig,this.mapId=e.mapId,this.mapManager=null,this.areaSelectionManager=null,this.uiManager=null,this.cameraManager=null,this.audioManager=null,this.visualFeedbackManager=null,this.isMobile=!1,this.scaleToggleButton=null,this.scaleToggleButtonGraphics=null,this._bgmStarted=!1,this._suppressMapBgm=!1,this._bgmRetry=null,this._isInConversation=!1}preload(){const e=this.mapConfig.folderName||this.mapId,t=this.mapConfig.mapFileName||this.mapConfig.mapKey,a=this.mapConfig.tilesetFileName||this.mapConfig.tilesetKey;this.load.tilemapTiledJSON(this.mapConfig.mapKey,`assets/maps/${e}/${t}.tmj`),this.load.image(this.mapConfig.tilesetKey,`assets/maps/${e}/${a}.png`),this.load.on("fileerror",(e=>{console.error(`File not found: ${e.key}, path: ${e.url}`)})),this.load.on("load",(e=>{console.log(`[MapSelectionStage] ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿æˆåŠŸ: ${e.key}, type: ${e.type}`)})),this.load.on("loaderror",(e=>{console.error(`[MapSelectionStage] ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼: ${e.key}, error:`,e)})),this.loadMinimalResources(),this.load.on("fileerror",(e=>{console.warn(`File not found: ${e.key}, using fallback`),this.mapManager?.createFallbackImage(e.key)})),this.load.on("complete",(()=>{console.log(`[MapSelectionStage] ãƒªã‚½ãƒ¼ã‚¹èª­ã¿è¾¼ã¿å®Œäº†: ${this.mapId}`),console.log(`[MapSelectionStage] ãƒãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«: ${this.mapConfig.mapKey}`),console.log(`[MapSelectionStage] ã‚¿ã‚¤ãƒ«ã‚»ãƒƒãƒˆ: ${this.mapConfig.tilesetKey}`);try{this.cache.tilemap&&this.cache.tilemap.entries?console.log("[MapSelectionStage] èª­ã¿è¾¼ã¾ã‚ŒãŸãƒªã‚½ãƒ¼ã‚¹:",this.cache.tilemap.entries):console.log("[MapSelectionStage] ã‚¿ã‚¤ãƒ«ãƒãƒƒãƒ—ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒåˆ©ç”¨ã§ãã¾ã›ã‚“"),this.cache.image&&this.cache.image.entries?console.log("[MapSelectionStage] èª­ã¿è¾¼ã¾ã‚ŒãŸç”»åƒ:",this.cache.image.entries):console.log("[MapSelectionStage] ç”»åƒã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒåˆ©ç”¨ã§ãã¾ã›ã‚“")}catch(e){console.warn("[MapSelectionStage] ã‚­ãƒ£ãƒƒã‚·ãƒ¥æƒ…å ±ã®å–å¾—ã«å¤±æ•—:",e)}this.createMap()}))}setupConversationEventListeners(){this.events.on("conversationStarted",(()=>{this._isInConversation=!0,console.log("[MapSelectionStage] ä¼šè©±é–‹å§‹: ä»–ã®ã‚¨ãƒªã‚¢ã‚’ã‚¿ãƒƒãƒ—ã§ãã¾ã›ã‚“")})),this.events.on("conversationEnded",(()=>{this._isInConversation=!1,console.log("[MapSelectionStage] ä¼šè©±çµ‚äº†: ä»–ã®ã‚¨ãƒªã‚¢ã‚’ã‚¿ãƒƒãƒ—ã§ãã¾ã™")})),this.events.on("conversationInterrupted",(()=>{this._isInConversation=!1,console.log("[MapSelectionStage] ä¼šè©±ä¸­æ–­: ä»–ã®ã‚¨ãƒªã‚¢ã‚’ã‚¿ãƒƒãƒ—ã§ãã¾ã™")}))}loadMinimalResources(){if(console.log("[MapSelectionStage] æœ€å°é™ãƒªã‚½ãƒ¼ã‚¹èª­ã¿è¾¼ã¿é–‹å§‹"),this.loadMapSeFiles(),this.mapConfig.bgm&&"object"==typeof this.mapConfig.bgm){const e=Object.keys(this.mapConfig.bgm)[0];e&&(this.load.audio(`bgm_${e}`,this.mapConfig.bgm[e]),console.log(`[MapSelectionStage] åŸºæœ¬BGMèª­ã¿è¾¼ã¿: ${e}`))}console.log("[MapSelectionStage] æœ€å°é™ãƒªã‚½ãƒ¼ã‚¹èª­ã¿è¾¼ã¿å®Œäº†")}loadMapSeFiles(){this.mapConfig.se?["se_touch","se_map_touch"].forEach((e=>{if(this.mapConfig.se[e]){const t=this.mapConfig.se[e];console.log(`[MapSelectionStage] ãƒãƒƒãƒ—SEèª­ã¿è¾¼ã¿: ${e} -> ${t}`),this.load.audio(e,t)}})):console.warn("[MapSelectionStage] mapConfig.se ãŒå®šç¾©ã•ã‚Œã¦ã„ã¾ã›ã‚“")}createMap(){try{const e=/iPad|iPhone|iPod/i.test(navigator.userAgent);if(this.isMobile=this.sys.game.device.input.touch,this._isShuttingDown=!1,this._suppressMapBgm=!1,this.cameraManager=new p(this),this.cameraManager.setBackgroundColor("#87CEEB"),console.log("[MapSelectionStage] ãƒãƒƒãƒ—ä½œæˆé–‹å§‹: mapKey='"+this.mapConfig.mapKey+"', tilesetKey='"+this.mapConfig.tilesetKey+"'"),this.mapManager=new o(this),this.mapManager.createMap(this.mapConfig.mapKey,this.mapConfig.tilesetKey),console.log("[MapSelectionStage] ãƒãƒƒãƒ—ä½œæˆå®Œäº†"),this.mapManager.scaleMapToScreen(),this.cameraManager.setupCamera(this.mapManager.getMapSize()),this.areaSelectionManager=new P(this),this.visualFeedbackManager=new c(this),"taketa"===this.mapConfig.mapKey||"miemachi"===this.mapConfig.mapKey||"japan"===this.mapConfig.mapKey){this.conversationTrigger=new M(this);try{this.scene.manager&&this.scene.manager.keys&&this.scene.manager.keys.ConversationScene||this.scene.add("ConversationScene",b)}catch(e){}this.setupConversationEventListeners()}const t=this.mapManager.getAreas(),a=this.mapConfig.areas;console.log("[MapSelectionStage] ã‚¨ãƒªã‚¢ãƒ‡ãƒ¼ã‚¿å‡¦ç†é–‹å§‹: mapAreas="+(t?t.length:"undefined")+", configAreas="+(a?a.length:"undefined")),console.log("[MapSelectionStage] mapAreas:",t),console.log("[MapSelectionStage] configAreas:",a);const s=t.map((e=>{const t=a.find((t=>t.name===e.name));return{...e,scene:t?.scene||null,sceneParam:t?.sceneParam||null,conversationId:t?.conversationId||null}}));console.log("[MapSelectionStage] mergedAreas:",s),console.log("[MapSelectionStage] ãƒãƒ¼ã‚¸å¾Œã®ã‚¨ãƒªã‚¢æ•°: "+s.length),this.areaSelectionManager.setupAreas(s),this.uiManager=new l,this.uiManager.createMapUI(this,this.mapConfig.mapTitle),this.time.delayedCall(100,(()=>{try{this.uiManager.createBackButton(this),console.log("[MapSelectionStage] æˆ»ã‚‹ãƒœã‚¿ãƒ³ã‚’ä½œæˆã—ã¾ã—ãŸ")}catch(e){console.error("[MapSelectionStage] æˆ»ã‚‹ãƒœã‚¿ãƒ³ã®ä½œæˆã«å¤±æ•—:",e)}})),this.setupTouchEvents(),this.createScaleToggleButton(),this.checkAndApplyCompletedAreas();try{this.audioManager=new f.AudioManager(this);const t=()=>{try{if(!this.sys||!this.sys.isActive||!this.sys.isActive())return}catch(e){}if(!this._suppressMapBgm)try{try{this.sound&&this.sound.stopAll&&this.sound.stopAll()}catch(e){}try{this.audioManager&&this.audioManager.stopAll&&this.audioManager.stopAll()}catch(e){}if(e&&this.mapConfig?.bgm?.map){if(this._htmlBgm||(this._htmlBgm=new Audio(this.mapConfig.bgm.map),this._htmlBgm.loop=!0,this._htmlBgm.volume=this.audioManager.bgmVolume,this._htmlBgm.onended=()=>{try{this._htmlBgm.currentTime=0;const e=this._htmlBgm.play();e&&e.catch&&e.catch((()=>{}))}catch(e){}}),!this._htmlBgm.paused&&!this._htmlBgm.ended)return;try{this._htmlBgm.currentTime=0}catch(e){}const e=this._htmlBgm.play();e&&"function"==typeof e.then?e.then((()=>{this._bgmStarted=!0})).catch((()=>{this._bgmStarted=!1})):this._bgmStarted=!0}else{const e=()=>{try{this.audioManager.playBgm("bgm_map"),this._bgmStarted=!0}catch(e){}};try{this.time.delayedCall(0,e)}catch(t){e()}}}catch(e){this._bgmStarted=!1}};this.sound&&this.sound.locked?(this.sound.once("unlocked",(()=>{try{this.sound.context&&"running"!==this.sound.context.state&&this.sound.context.resume()}catch(e){}t()})),this.input.once("pointerdown",(()=>{try{this.sound.context&&"running"!==this.sound.context.state&&this.sound.context.resume()}catch(e){}try{const e=this.sound.context;if(e&&"running"!==e.state&&e.resume(),e&&"function"==typeof e.createOscillator){const t=e.createOscillator(),a=e.createGain();a.gain.value=1e-4,t.connect(a).connect(e.destination),t.start(),t.stop(e.currentTime+.05)}}catch(e){}t()}))):(t(),this.input.once("pointerdown",(()=>{try{this.sound.context&&"running"!==this.sound.context.state&&this.sound.context.resume()}catch(e){}try{const e=this.sound.context;if(e&&"running"!==e.state&&e.resume(),e&&"function"==typeof e.createOscillator){const t=e.createOscillator(),a=e.createGain();a.gain.value=1e-4,t.connect(a).connect(e.destination),t.start(),t.stop(e.currentTime+.05)}}catch(e){}this.audioManager?.bgm&&this.audioManager.bgm.isPlaying||t()}))),this._bgmRetry=this.time.addEvent({delay:400,repeat:2,callback:()=>{const a=!(!e||!this._htmlBgm)&&(this._htmlBgm.paused||this._htmlBgm.ended),s=!(e||this.audioManager?.bgm&&this.audioManager.bgm.isPlaying);if(!this._suppressMapBgm&&(a||s)){try{this.sound.context&&"running"!==this.sound.context.state&&this.sound.context.resume()}catch(e){}t()}}})}catch(e){}this.scale.on("resize",this.handleResize,this),this._onResizeBound=!0,this.events.on("shutdown",(()=>{try{this.load&&this.load.reset&&this.load.reset()}catch(e){}try{this.load&&this.load.removeAllListeners&&this.load.removeAllListeners()}catch(e){}this.shutdown()}),this)}catch(e){console.error("[MapSelectionStage] ãƒãƒƒãƒ—ä½œæˆã‚¨ãƒ©ãƒ¼:",e)}}setupTouchEvents(){this.input.on("pointerdown",(e=>{this.handleTouch(e)})),this.cameraManager.setupScrollControls(),this.cameraManager.setupPinchZoom()}handleTouch(e){try{if(this._isInConversation)return void console.log("[MapSelectionStage] ä¼šè©±ä¸­ã¯ä»–ã®ã‚¨ãƒªã‚¢ã‚’ã‚¿ãƒƒãƒ—ã§ãã¾ã›ã‚“");if(this.sound&&this.sound.locked){try{this.sound.context&&"running"!==this.sound.context.state&&this.sound.context.resume()}catch(e){}try{const e=this.sound.context;if(e&&"running"!==e.state&&e.resume(),e&&"function"==typeof e.createOscillator){const t=e.createOscillator(),a=e.createGain();a.gain.value=1e-4,t.connect(a).connect(e.destination),t.start(),t.stop(e.currentTime+.05)}}catch(e){}}if(!this.cameras||!this.cameras.main)return void console.error(`${this.mapConfig.mapTitle}: Camera not available`);const t=this.cameras.main.getWorldPoint(e.x,e.y),a=t.x,s=t.y;this.areaSelectionManager&&this.areaSelectionManager.handleTouchAt(a,s),this.visualFeedbackManager&&this.visualFeedbackManager.showTouchRipple(a,s)}catch(e){console.error(`${this.mapConfig.mapTitle}: Error in handleTouch:`,e)}}createScaleToggleButton(){if(this._isShuttingDown||!this.sys||!this.sys.isActive||!this.add)return;this.scaleToggleButton&&(this.scaleToggleButton.destroy(),this.scaleToggleButton=null),this.scaleToggleButtonGraphics&&(this.scaleToggleButtonGraphics.destroy(),this.scaleToggleButtonGraphics=null);const e=this.add.graphics();this.scaleToggleButtonGraphics=e;const t=(t,a=!1)=>{e.clear();const s=43+(t.length>2?15*(t.length-2)+5:0),r=a?.4:.3,i=a?3815994:2763306,o=a?.98:.95,n=a?.15:.1;e.fillStyle(0,r),e.fillRoundedRect(4.5,40,s,30,8),e.fillStyle(i,o),e.fillRoundedRect(2.5,38,s,30,8),e.fillStyle(16777215,n),e.fillRoundedRect(2.5,38,s,15,8)};t("æ‹¡å¤§"),e.setScrollFactor(0),e.setDepth(1e3);const a=this.add.text(7.5,43,"æ‹¡å¤§",{fontSize:"16px",fill:"#ffffff",fontWeight:"bold",fontFamily:"Arial"});this.scaleToggleButton=a,a.setScrollFactor(0),a.setDepth(1002),a.setInteractive(),a.on("pointerdown",(()=>{this.cameraManager.toggleMapScale(),1.5===(this.cameraManager.scene.mapManager?.mapScaleX||this.cameraManager.currentScale)?(a.setText("å…¨ä½“ãƒãƒƒãƒ—è¡¨ç¤º"),t("å…¨ä½“ãƒãƒƒãƒ—è¡¨ç¤º")):(a.setText("æ‹¡å¤§"),t("æ‹¡å¤§"))})),a.on("pointerover",(()=>{const e=a.text;t(e,!0)})),a.on("pointerout",(()=>{const e=a.text;t(e,!1)})),a.setText("æ‹¡å¤§")}handleResize(e){try{if(this._isShuttingDown||!this.sys||!this.sys.isActive)return;if(!this.cameras||!this.cameras.main)return;if(!this.mapManager)return;if(this.mapManager?.handleResize(e),this.cameraManager&&this.mapManager&&this.cameraManager.setupCamera(this.mapManager.getMapSize()),this.areaSelectionManager){this.areaSelectionManager.destroy(),this.areaSelectionManager=new P(this);const e=this.mapManager.getAreas(),t=this.mapConfig.areas,a=e.map((e=>{const a=t.find((t=>t.name===e.name));return{...e,scene:a?.scene||null}}));this.areaSelectionManager.setupAreas(a)}this.uiManager?.updateMapUI(e),this.createScaleToggleButton()}catch(e){console.error("Error handling resize:",e)}}update(){this.areaSelectionManager?.update(),this.cameraManager?.update()}checkAndApplyCompletedAreas(){try{const e=this.scene.manager.getScene("ConversationScene");if(e&&e.completedAreaName){const t=e.completedAreaName;console.log(`[MapSelectionStage] å®Œäº†çŠ¶æ…‹ã‚’é©ç”¨: ${t}`),this.areaSelectionManager.markAreaAsCompleted(t),e.completedAreaName=null,console.log(`[MapSelectionStage] å®Œäº†çŠ¶æ…‹ã‚’ã‚¯ãƒªã‚¢: ${t}`)}}catch(e){console.error("[MapSelectionStage] å®Œäº†çŠ¶æ…‹é©ç”¨ã‚¨ãƒ©ãƒ¼:",e)}}destroy(){this.shutdown(),super.destroy()}shutdown(){if(this._isShuttingDown=!0,this.audioManager&&(this.audioManager.stopAll(),this.audioManager.destroy(),this.audioManager=null),this._htmlBgm){try{this._htmlBgm.pause()}catch(e){}this._htmlBgm=null}this._bgmStarted=!1,this.mapManager&&(this.mapManager.destroy(),this.mapManager=null),this.areaSelectionManager&&(this.areaSelectionManager.destroy(),this.areaSelectionManager=null),this.uiManager&&(this.uiManager.destroy(),this.uiManager=null),this.cameraManager&&(this.cameraManager.destroy(),this.cameraManager=null),this.visualFeedbackManager&&(this.visualFeedbackManager.destroy(),this.visualFeedbackManager=null),this.conversationTrigger&&(this.conversationTrigger.destroy(),this.conversationTrigger=null),this.scaleToggleButton&&(this.scaleToggleButton.destroy(),this.scaleToggleButton=null),this.scaleToggleButtonGraphics&&(this.scaleToggleButtonGraphics.destroy(),this.scaleToggleButtonGraphics=null);try{this.sound&&this.sound.stopAll&&this.sound.stopAll()}catch(e){}try{this._onResizeBound&&this.scale&&this.scale.off&&this.scale.off("resize",this.handleResize,this)}catch(e){}this._onResizeBound=!1}}function E(e,t){const a=D.AreaConfig[e];return a?new G({sceneKey:t,mapConfig:a,mapId:e}):(console.error(`Map config not found for: ${e}`),null)}const I={taketa_highschool:{stageKey:"taketa_highschool",stageTitle:"ç«¹ç”°é«˜æ ¡",folderName:"taketa/taketa_highschool",mapId:"taketa",bgm:{map:"assets/audio/bgm/Pollyanna.mp3"},se:{se_touch:"assets/audio/se/touch_7.mp3",se_floor_change:"assets/audio/se/touch_2.mp3"},floors:[{number:1,mapKey:"taketa_highschool_1",mapFileName:"taketa_highschool_1.tmj",title:"ç«¹ç”°é«˜æ ¡ 1éš",implemented:!0,tilesets:["pika_nos_tiles03_A2","pika_nos_tiles03_A3","pika_nos_tiles03_A5","pika_nos_tiles03_B","pika_nos_tiles03_C","pika_nos_tiles03_D","pika_nos_in_tiles02_A2","pika_nos_in_tiles02_A4","pika_nos_in_tiles02_A5","pika_nos_in_tiles02_B","pika_nos_in_tiles02_C","pika_nos_in_tiles02_D","pika_nos_in_tiles02_E","pika_objset_school_01"]},{number:2,mapKey:"taketa_highschool_2",mapFileName:"taketa_highschool_2.tmj",title:"ç«¹ç”°é«˜æ ¡ 2éš",implemented:!0,tilesets:["pika_nos_tiles03_A2","pika_nos_tiles03_A3","pika_nos_tiles03_A5","pika_nos_tiles03_B","pika_nos_tiles03_C","pika_nos_tiles03_D","pika_nos_in_tiles02_A2","pika_nos_in_tiles02_A4","pika_nos_in_tiles02_A5","pika_nos_in_tiles02_B","pika_nos_in_tiles02_C","pika_nos_in_tiles02_D","pika_nos_in_tiles02_E"]}]}};class $ extends Phaser.Scene{constructor(e){super({key:e.stageKey}),this.stageConfig=I[e.stageKey],this.stageConfig?(this.mapManager=null,this.uiManager=null,this.cameraManager=null,this.audioManager=null,this.currentFloor=1):console.error(`Stage config not found for: ${e.stageKey}`)}preload(){const e=this.stageConfig.folderName;this.stageConfig.floors.forEach((t=>{t.implemented&&this.load.tilemapTiledJSON(t.mapKey,`assets/maps/${e}/${t.mapFileName}`)})),this.stageConfig.floors.forEach((t=>{t.implemented&&t.tilesets.forEach((t=>{this.load.image(t,`assets/maps/${e}/${t}.png`)}))})),this.stageConfig.bgm&&"object"==typeof this.stageConfig.bgm&&Object.keys(this.stageConfig.bgm).forEach((e=>{this.load.audio(e,this.stageConfig.bgm[e])})),this.stageConfig.se&&Object.keys(this.stageConfig.se).forEach((e=>{this.load.audio(e,this.stageConfig.se[e])}))}create(){console.log("[StageScene] === create() é–‹å§‹ ==="),console.log("[StageScene] ã‚·ãƒ¼ãƒ³ã‚­ãƒ¼:",this.scene.key),console.log("[StageScene] ã‚¹ãƒ†ãƒ¼ã‚¸è¨­å®š:",this.stageConfig);try{this.mapManager=new o(this),console.log("[StageScene] åŸºæœ¬çš„ãªãƒãƒƒãƒ—è¡¨ç¤ºé–‹å§‹");const e=this.stageConfig.floors[0];this.mapManager.currentMapKey=e.mapKey,this.mapManager.createMap(),console.log("[StageScene] åŸºæœ¬çš„ãªãƒãƒƒãƒ—è¡¨ç¤ºå®Œäº†"),this.collisionManager=new u(this),this.collisionManager.setupCollisionGroups(),console.log("[StageScene] CollisionManageråˆæœŸåŒ–å®Œäº†"),this.playerController=new n(this),this.playerController.createPlayer(100,100),console.log("[StageScene] ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ä½œæˆå®Œäº†");const t=this.playerController.getPosition();console.log("[StageScene] ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ä½ç½®:",t),console.log("[StageScene] ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ:",this.playerController.player),console.log("[StageScene] ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®å¯è¦–æ€§:",this.playerController.player.visible),this.touchControlManager=new h(this,this.playerController.player,"se_touch"),console.log("[StageScene] ã‚¿ãƒƒãƒã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ä½œæˆå®Œäº†"),this.cameraManager=new p(this),this.cameraManager.setBackgroundColor("#87CEEB"),this.cameraManager.setupCamera(this,this.mapManager.map,this.playerController.player),console.log("[StageScene] ã‚«ãƒ¡ãƒ©è¨­å®šå®Œäº† (stage2ã¨åŒã˜æ–¹æ³•)"),this.uiManager=new l,this.uiManager.createMapUI(this,this.stageConfig.stageTitle),this.uiManager.createBackButton(this),this.audioManager=new f.AudioManager(this),window.returnToTaketaMap=()=>{window.startPhaserGame?window.startPhaserGame("taketa"):console.error("startPhaserGame not found")},this.stageConfig.bgm&&this.stageConfig.bgm.map?(this.audioManager.stopAll(),this.scene.sound&&this.scene.sound.stopAll(),this._htmlBgm&&this._htmlBgm.pause(),this.audioManager.playBgm("map")):console.warn("[StageScene] BGMè¨­å®šãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“"),this.setupTouchEvents(),this.collisionManager.setupAllCollisions(this.playerController.player,this.mapManager),console.log("[StageScene] å½“ãŸã‚Šåˆ¤å®šè¨­å®šå®Œäº†"),this.cameraManager=new p(this),this.cameraManager.setupCamera(this,this.mapManager.map,this.playerController.player),console.log("[StageScene] ã‚«ãƒ¡ãƒ©è¨­å®šå®Œäº†"),console.log("[StageScene] === create() å®Œäº† ===")}catch(e){console.error("[StageScene] create() ã‚¨ãƒ©ãƒ¼:",e)}}shutdown(){console.log("[StageScene] shutdown() ãƒ¡ã‚½ãƒƒãƒ‰å®Ÿè¡Œé–‹å§‹");try{if(this.audioManager&&(this.audioManager.stopAll(),console.log("[StageScene] AudioManageråœæ­¢å®Œäº†")),this.sound&&(this.sound.stopAll(),console.log("[StageScene] PhaseréŸ³å£°ã‚·ã‚¹ãƒ†ãƒ åœæ­¢å®Œäº†"),this.sound.context&&(this.sound.context.state="suspended",console.log("[StageScene] éŸ³å£°ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆçŠ¶æ…‹ãƒªã‚»ãƒƒãƒˆå®Œäº†"))),this.sound&&this.sound.context)try{this.sound.context.close&&this.sound.context.close(),this.sound.context=null,console.log("[StageScene] éŸ³å£°ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆå®Œå…¨ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—å®Œäº†")}catch(e){console.warn("[StageScene] éŸ³å£°ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã‚¨ãƒ©ãƒ¼:",e)}}catch(e){console.warn("[StageScene] éŸ³å£°ã‚·ã‚¹ãƒ†ãƒ ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã‚¨ãƒ©ãƒ¼:",e)}try{this.load&&this.load.reset&&this.load.reset()}catch(e){}try{this.load&&this.load.removeAllListeners&&this.load.removeAllListeners()}catch(e){}this.playerController&&(this.playerController.destroy(),this.playerController=null),this.touchControlManager&&(this.touchControlManager.destroy(),this.touchControlManager=null),this.uiManager&&(this.uiManager.destroy(),this.uiManager=null),this.cameraManager&&(this.cameraManager.destroy(),this.cameraManager=null),this.collisionManager&&(this.collisionManager.destroy(),this.collisionManager=null),this.audioManager&&(this.audioManager.destroy(),this.audioManager=null),this.events.off("shutdown",this.shutdown,this),console.log("[StageScene] shutdown() ãƒ¡ã‚½ãƒƒãƒ‰å®Ÿè¡Œå®Œäº†")}changeFloor(e){if(e!==this.currentFloor){console.log(`[StageScene] ãƒ•ãƒ­ã‚¢å¤‰æ›´é–‹å§‹: ${this.currentFloor} â†’ ${e}`);try{const t=this.stageConfig.floors.find((t=>t.number===e));if(!t||!t.implemented)return void console.error(`[StageScene] ãƒ•ãƒ­ã‚¢è¨­å®šãŒè¦‹ã¤ã‹ã‚‰ãªã„ã‹ã€æœªå®Ÿè£…: ${e}`);this.mapManager.map&&(console.log("[StageScene] æ—¢å­˜ãƒãƒƒãƒ—ã‚’å‰Šé™¤ä¸­..."),this.mapManager.destroy(),console.log("[StageScene] æ—¢å­˜ãƒãƒƒãƒ—å‰Šé™¤å®Œäº†")),this.currentFloor=e,this.mapManager.currentMapKey=t.mapKey,this.mapManager.createMap(),console.log(`[StageScene] ãƒ•ãƒ­ã‚¢${e}ã®ãƒãƒƒãƒ—ä½œæˆå®Œäº†`),this.uiManager&&(this.uiManager.updateMapTitle(t.title),console.log("[StageScene] UIã‚¿ã‚¤ãƒˆãƒ«æ›´æ–°å®Œäº†")),this.stageConfig.se&&this.stageConfig.se.se_floor_change&&this.audioManager.playSe("se_floor_change"),console.log("[StageScene] ãƒ•ãƒ­ã‚¢å¤‰æ›´å®Œäº†: "+e)}catch(e){console.error("[StageScene] ãƒ•ãƒ­ã‚¢å¤‰æ›´ã‚¨ãƒ©ãƒ¼:",e)}}}createFloorButtons(){this.floorButtons=[],this.stageConfig.floors.forEach(((e,t)=>{const a=this.add.text(20+80*t,50,`${e.number}éš`,{fontSize:"18px",fill:"#ffffff",backgroundColor:e.implemented?"#333333":"#666666",padding:{x:10,y:5}});e.implemented&&(a.setInteractive(),a.on("pointerdown",(()=>this.changeFloor(e.number)))),this.floorButtons.push(a)})),this.updateFloorButtonHighlight()}updateFloorButtonHighlight(){this.floorButtons.forEach(((e,t)=>{const a=this.stageConfig.floors[t];a.number===this.currentFloor?e.setBackgroundColor("#333333"):e.setBackgroundColor(a.implemented?"#666666":"#999999")}))}setupTouchEvents(){this.input.on("pointerdown",(()=>{this.handleTouch()})),this.cameraManager.setupScrollControls(),this.cameraManager.setupPinchZoom()}handleTouch(){try{if(this.scene&&this.scene.sound&&this.scene.sound.context){const e=this.scene.sound.context;"suspended"===e.state&&e.resume()}}catch(e){console.warn("[StageScene] éŸ³å£°ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆå‡¦ç†ã‚¨ãƒ©ãƒ¼:",e)}}update(){this.cameraManager?.update(),this.playerController&&this.playerController.update()}destroy(){this.shutdown(),super.destroy()}resize(e){const{width:t,height:a}=e;this.cameras.resize(t,a),this.touchControlManager&&this.touchControlManager.updatePosition(t,a)}}let j=null;function F(e){try{if(window.game&&window.game.scene&&window.game.scene.getScenes){const e=window.game.scene.getScenes(!1)||[];for(const t of e){try{t.load&&t.load.reset&&t.load.reset()}catch(e){}try{t.load&&t.load.removeAllListeners&&t.load.removeAllListeners()}catch(e){}try{t.sound&&t.sound.stopAll&&t.sound.stopAll()}catch(e){}try{t.audioManager&&t.audioManager.stopAll&&t.audioManager.stopAll()}catch(e){}try{t.scene&&t.scene.isActive&&t.scene.isActive()&&t.scene.stop()}catch(e){}try{t.scene&&t.scene.remove&&t.scene.remove()}catch(e){}}}}catch(e){}const t=function(){if(window.game)return window.game;const e={...i,scene:[]};j=new Phaser.Game(e),window.game=j,window.gameInstance=j;try{j.events.on("destroy",(()=>{try{j.isDestroyed=!0}catch(e){}}))}catch(e){}try{if(!window.__audioUnlockInstalled){const e=()=>{try{const t=window.gameInstance&&window.gameInstance.sound,a=t&&t.context;if(a){"running"!==a.state&&a.resume().catch((()=>{}));try{const e=a.createOscillator(),t=a.createGain();t.gain.value=1e-4,e.connect(t).connect(a.destination),e.start(),e.stop(a.currentTime+.05)}catch(e){}}t&&!t.locked&&(window.removeEventListener("pointerdown",e,!0),window.removeEventListener("touchstart",e,!0),window.removeEventListener("click",e,!0))}catch(e){}};window.addEventListener("pointerdown",e,!0),window.addEventListener("touchstart",e,!0),window.addEventListener("click",e,!0),window.__audioUnlockInstalled=!0}}catch(e){}return j}();let a,s;switch(e){case 1:default:a=v,s="Stage1Scene";break;case 2:a=w,s="Stage2Scene";break;case 3:a=_,s="Stage3Scene";break;case"miemachi":case"bunngo_mie_city":a=E("miemachistage","MiemachiStage"),s="MiemachiStage";break;case"taketa":case"taketa_city":a=E("taketastage","TaketastageStage"),s="TaketastageStage";break;case"japan":case"zenkoku":a=E("japanstage","JapanStage"),s="JapanStage";break;case"taketa_highschool":a=function(e){const t=I[e];return t?new $({stageKey:e,stageConfig:t}):(console.error(`Stage config not found for: ${e}`),null)}("taketa_highschool"),s="taketa_highschool"}try{t.sound&&t.sound.stopAll(),t.scene&&t.scene.getScenes&&(t.scene.getScenes(!0)||[]).forEach((e=>{try{e.sound&&e.sound.stopAll&&e.sound.stopAll()}catch(e){}try{e._htmlBgm&&(e._htmlBgm.pause(),e._htmlBgm=null)}catch(e){}try{e.scene&&e.scene.stop&&e.scene.stop()}catch(e){}}))}catch(e){}try{const e=t.scene&&(t.scene.scenes||t.scene.getScenes&&t.scene.getScenes(!1))||[];(Array.isArray(e)?e:[]).forEach((e=>{try{e&&e.sound&&e.sound.stopAll&&e.sound.stopAll()}catch(e){}try{e&&e._htmlBgm&&(e._htmlBgm.pause(),e._htmlBgm=null)}catch(e){}try{e&&e._eventHtmlBgm&&(e._eventHtmlBgm.pause(),e._eventHtmlBgm=null)}catch(e){}try{e&&e.scene&&e.scene.isActive&&e.scene.isActive()&&e.scene.stop()}catch(e){}try{e&&e.scene&&e.scene.remove&&e.scene.remove()}catch(e){}}))}catch(e){}try{t.scene.getScene&&t.scene.getScene(s)&&t.scene.remove(s),t.scene.getScene&&t.scene.getScene("ConversationScene")&&t.scene.remove("ConversationScene")}catch(e){}t.scene.add(s,a,!0)}window.startPhaserGame=F},296:(e,t,a)=>{a.r(t),a.d(t,{AudioManager:()=>s});class s{constructor(e){this.scene=e,this.bgm=null,this.bgmVolume=.3,this.seVolume=.7,this.voiceVolume=.8,this.isBgmMuted=!1,this.isSeMuted=!1,this.isVoiceMuted=!1,this.loadedSounds=new Set}ensureAudioUnlocked(){try{if(!this.scene)return console.warn("[AudioManager] ã‚·ãƒ¼ãƒ³ãŒå­˜åœ¨ã—ã¾ã›ã‚“"),!1;if(!this.scene.sound)return console.warn("[AudioManager] ã‚·ãƒ¼ãƒ³ã®ã‚µã‚¦ãƒ³ãƒ‰ã‚·ã‚¹ãƒ†ãƒ ãŒå­˜åœ¨ã—ã¾ã›ã‚“"),!1;const e=this.scene.sound;if(void 0===e.locked&&(console.log("[AudioManager] ã‚µã‚¦ãƒ³ãƒ‰ã‚·ã‚¹ãƒ†ãƒ ã®lockedãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒå­˜åœ¨ã—ã¾ã›ã‚“ï¼ˆstageç³»ã®ãƒãƒƒãƒ—ï¼‰"),e.context&&"running"===e.context.state))return console.log("[AudioManager] éŸ³å£°ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã¯åˆ©ç”¨å¯èƒ½ã€ç¶šè¡Œ"),!0;const t=e.context;if(!t){console.log("[AudioManager] éŸ³å£°ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€å¼·åˆ¶å†åˆæœŸåŒ–ã‚’è©¦è¡Œ...");try{if(this.scene&&this.scene.sound){if(this.scene.sound.context)try{this.scene.sound.context.close()}catch(e){}try{const e=new(window.AudioContext||window.webkitAudioContext);this.scene.sound.context=e,console.log("[AudioManager] æ–°ã—ã„éŸ³å£°ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’ä½œæˆã—ã¾ã—ãŸ"),"suspended"===e.state&&(e.resume(),console.log("[AudioManager] æ–°ã—ã„éŸ³å£°ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’é–‹å§‹ã—ã¾ã—ãŸ")),"running"!==e.state&&(e.onstatechange=()=>{"running"===e.state&&console.log("[AudioManager] æ–°ã—ã„éŸ³å£°ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãŒå‹•ä½œé–‹å§‹ã—ã¾ã—ãŸ")})}catch(e){console.warn("[AudioManager] æ–°ã—ã„éŸ³å£°ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆä½œæˆã‚¨ãƒ©ãƒ¼:",e)}}}catch(e){console.warn("[AudioManager] éŸ³å£°ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆå¼·åˆ¶å†åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:",e)}return!1}if(console.log("[AudioManager] éŸ³å£°ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆçŠ¶æ…‹:",t.state),e.locked){console.log("[AudioManager] éŸ³å£°ãŒãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ã¾ã™ã€è§£é™¤ã‚’è©¦è¡Œ");try{"running"!==t.state&&(console.log("[AudioManager] éŸ³å£°ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’å†é–‹ä¸­..."),t.resume()),"suspended"===t.state&&(console.log("[AudioManager] éŸ³å£°ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãŒåœæ­¢ä¸­ã€å¼·åˆ¶å†é–‹ã‚’è©¦è¡Œ"),t.resume())}catch(e){console.warn("[AudioManager] Audio context resume error:",e)}try{if("function"==typeof t.createOscillator&&!this._oscillatorCreated){console.log("[AudioManager] ç„¡éŸ³ã‚ªã‚·ãƒ¬ãƒ¼ã‚¿ãƒ¼ã§éŸ³å£°ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆèµ·å‹•");const a=t.createOscillator(),s=t.createGain();s.gain.value=1e-4,a.connect(s).connect(t.destination),a.start(),a.stop(t.currentTime+.05),this._oscillatorCreated=!0,setTimeout((()=>{e.locked?console.log("[AudioManager] ã‚ªã‚·ãƒ¬ãƒ¼ã‚¿ãƒ¼å¾Œã‚‚ãƒ­ãƒƒã‚¯çŠ¶æ…‹ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œã‚’å¾…æ©Ÿä¸­..."):console.log("[AudioManager] éŸ³å£°ãƒ­ãƒƒã‚¯ãŒè§£é™¤ã•ã‚Œã¾ã—ãŸ")}),100)}}catch(e){console.warn("[AudioManager] Oscillator creation error:",e)}try{console.log("[AudioManager] å¼·åˆ¶ãƒ­ãƒƒã‚¯è§£é™¤ã‚’è©¦è¡Œ..."),t&&"function"==typeof t.close&&t.close(),this.scene&&this.scene.sound&&(this.scene.sound.context=null,setTimeout((()=>{try{const e=new(window.AudioContext||window.webkitAudioContext);this.scene.sound.context=e,"suspended"===e.state&&e.resume(),console.log("[AudioManager] æ–°ã—ã„éŸ³å£°ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’ä½œæˆã—ã¾ã—ãŸ"),setTimeout((()=>{this.scene.sound.locked?console.log("[AudioManager] å¼·åˆ¶ãƒ­ãƒƒã‚¯è§£é™¤å¤±æ•—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œãŒå¿…è¦"):console.log("[AudioManager] å¼·åˆ¶ãƒ­ãƒƒã‚¯è§£é™¤æˆåŠŸ")}),300)}catch(e){console.warn("[AudioManager] æ–°ã—ã„éŸ³å£°ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆä½œæˆã‚¨ãƒ©ãƒ¼:",e)}}),100))}catch(e){console.warn("[AudioManager] å¼·åˆ¶ãƒ­ãƒƒã‚¯è§£é™¤ã‚¨ãƒ©ãƒ¼:",e)}return!1}return console.log("[AudioManager] éŸ³å£°ã¯ãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ã¾ã›ã‚“"),!0}catch(e){return console.warn("[AudioManager] Audio unlock error:",e),!1}}isSceneUsable(){try{return!(!this.scene||!this.scene.sound)}catch(e){return console.warn("[AudioManager] Scene usability check error:",e),!1}}loadSound(e,t){this.loadedSounds.has(e)||(this.scene.load.audio(e,t),this.loadedSounds.add(e))}playBgm(e,t=this.bgmVolume,a=!0){if(console.log(`[AudioManager] playBgmé–‹å§‹: ${e}, éŸ³é‡: ${t}`),!this.isSceneUsable())return console.warn("[AudioManager] ã‚·ãƒ¼ãƒ³ãŒä½¿ç”¨ã§ãã¾ã›ã‚“"),!1;try{const e=this.scene&&this.scene.sound,t=e&&e.context;console.log("[AudioManager] éŸ³å£°ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ…‹:",{scene:!!this.scene,sound:!!e,context:!!t,contextState:t?t.state:"undefined",locked:e?e.locked:"unknown"})}catch(e){console.warn("[AudioManager] éŸ³å£°ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ…‹ç¢ºèªã‚¨ãƒ©ãƒ¼:",e)}return this.ensureAudioUnlocked()?this.bgm?this.bgm.isPlaying&&this.bgm.key===e?(console.log(`[AudioManager] åŒã˜BGM ${e} ã¯å®Ÿéš›ã«å†ç”Ÿä¸­ã€ã‚¹ã‚­ãƒƒãƒ—`),!0):(console.log(`[AudioManager] æ—¢å­˜BGM ${this.bgm.key} ã®çŠ¶æ…‹: isPlaying=${this.bgm.isPlaying}, åœæ­¢ã—ã¦ã‹ã‚‰ ${e} ã‚’å†ç”Ÿ`),this.stopBgm(a,(()=>{this.isSceneUsable()&&this.startNewBgm(e,t,a)})),!0):!!this.isSceneUsable()&&this.startNewBgm(e,t,a):(console.warn("[AudioManager] éŸ³å£°ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€å°‘ã—å¾…æ©Ÿã—ã¦ã‹ã‚‰å†è©¦è¡Œ..."),setTimeout((()=>{this.ensureAudioUnlocked()?(console.log("[AudioManager] éŸ³å£°ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆå†åˆæœŸåŒ–å®Œäº†ã€BGMå†ç”Ÿã‚’å†è©¦è¡Œ"),this.playBgm(e,t,a)):console.warn("[AudioManager] éŸ³å£°ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆå†åˆæœŸåŒ–å¤±æ•—ã€BGMå†ç”Ÿã‚’ã‚¹ã‚­ãƒƒãƒ—")}),1e3),!1)}startNewBgm(e,t,a){if(console.log(`[AudioManager] startNewBgmé–‹å§‹: ${e}, éŸ³é‡: ${t}, ãƒ•ã‚§ãƒ¼ãƒ‰ã‚¤ãƒ³: ${a}`),this.isBgmMuted)return console.log("[AudioManager] BGMãŒãƒŸãƒ¥ãƒ¼ãƒˆã•ã‚Œã¦ã„ã¾ã™"),!1;if(this.isSceneUsable())try{if(!this.scene||!this.scene.sound)return void console.warn("[AudioManager] Scene or sound system is not available for BGM:",e);console.log(`[AudioManager] éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«è¿½åŠ : ${e}`),this.bgm=this.scene.sound.add(e,{loop:!0,volume:a?0:t}),this.bgm.key=e,console.log(`[AudioManager] BGMå†ç”Ÿé–‹å§‹: ${e}`);try{const e=this.bgm.play();if(console.log("[AudioManager] BGMå†ç”Ÿçµæœ:",e),this.bgm&&this.bgm.isPlaying)console.log("[AudioManager] BGMå†ç”ŸçŠ¶æ…‹ç¢ºèª: isPlaying = true");else if(console.warn("[AudioManager] BGMå†ç”ŸçŠ¶æ…‹ç¢ºèª: isPlaying = false"),this.bgm&&!this.bgm.isPlaying){console.warn("[AudioManager] BGMå†ç”Ÿå¤±æ•—ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ãƒªã‚»ãƒƒãƒˆ");try{this.bgm.destroy()}catch(e){console.warn("[AudioManager] BGMã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆç ´æ£„ã‚¨ãƒ©ãƒ¼:",e)}return this.bgm=null,this._bgmPlayFailed=!0,!1}}catch(t){if(console.error(`[AudioManager] BGMå†ç”Ÿã‚¨ãƒ©ãƒ¼: ${e}`,t),this.bgm){try{this.bgm.destroy()}catch(e){console.warn("[AudioManager] BGMã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆç ´æ£„ã‚¨ãƒ©ãƒ¼:",e)}this.bgm=null}throw this._bgmPlayFailed=!0,t}return a?(console.log("[AudioManager] ãƒ•ã‚§ãƒ¼ãƒ‰ã‚¤ãƒ³é–‹å§‹"),this.scene.tweens.add({targets:this.bgm,volume:t,duration:500})):(console.log(`[AudioManager] éŸ³é‡è¨­å®š: ${t}`),this.bgm.setVolume(t)),console.log(`[AudioManager] BGMå†ç”Ÿå®Œäº†: ${e}`),this.scene&&this.scene.time?this.scene.time.delayedCall(1e3,(()=>{this.bgm&&this.bgm.isPlaying?console.log(`[AudioManager] BGMå†ç”ŸçŠ¶æ…‹ç¢ºèªï¼ˆ1ç§’å¾Œï¼‰: ${e} ã¯å†ç”Ÿä¸­`):this.bgm?console.warn(`[AudioManager] BGMå†ç”ŸçŠ¶æ…‹ç¢ºèªï¼ˆ1ç§’å¾Œï¼‰: ${e} ã¯åœæ­¢ä¸­`):console.warn("[AudioManager] BGMå†ç”ŸçŠ¶æ…‹ç¢ºèªï¼ˆ1ç§’å¾Œï¼‰: BGMã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒå­˜åœ¨ã—ã¾ã›ã‚“")})):console.warn("[AudioManager] ã‚·ãƒ¼ãƒ³ã®ã‚¿ã‚¤ãƒ ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ãŒåˆ©ç”¨ã§ãã¾ã›ã‚“ã€çŠ¶æ…‹ç›£è¦–ã‚’ã‚¹ã‚­ãƒƒãƒ—"),!0}catch(t){return console.error(`[AudioManager] BGM ${e} ã®å†ç”Ÿã«å¤±æ•—ã—ã¾ã—ãŸ:`,t),!1}else console.warn("[AudioManager] ã‚·ãƒ¼ãƒ³ãŒä½¿ç”¨ã§ãã¾ã›ã‚“")}stopBgm(e=!0,t){if(this.bgm)try{if(!this.isSceneUsable())return this.bgm=null,void(t&&t());if(!this.scene||!this.scene.sound)return console.warn("[AudioManager] Scene or sound system is not available for stopping BGM"),this.bgm=null,void(t&&t());if(!this.bgm||!(this.bgm.isPlaying||this.bgm.isPaused||this.bgm.key||this.bgm.context))return console.debug("[AudioManager] BGM object may not be in expected state, proceeding with cleanup"),this.bgm=null,void(t&&t());if(e)this.scene.tweens.add({targets:this.bgm,volume:0,duration:500,onComplete:()=>{try{this.bgm&&this.bgm.isPlaying&&(this.bgm.pause(),this.bgm.stop()),this.bgm=null}catch(e){console.warn("[AudioManager] Error during BGM stop:",e),this.bgm=null}t&&t()}});else{try{this.bgm&&this.bgm.isPlaying&&(this.bgm.pause(),this.bgm.stop()),this.bgm=null}catch(e){console.warn("[AudioManager] Error during BGM stop:",e),this.bgm=null}t&&t()}}catch(e){console.warn("[AudioManager] Error in stopBgm:",e),this.bgm=null,t&&t()}else t&&t()}async playSe(e,t=this.seVolume){if(this.isSceneUsable()&&!this.isSeMuted)try{let s;const{SE_MAPPING:r}=await a.e(557).then(a.bind(a,557));if(r[e])s=`assets/audio/se/${r[e]}`;else{const{AreaConfig:t}=await Promise.resolve().then(a.bind(a,364));let r="miemachistage";if(this.scene&&this.scene.scene&&this.scene.scene.key){const e=this.scene.scene.key;e.includes("Miemachi")||e.includes("miemachi")?r="miemachistage":e.includes("Taketa")||e.includes("taketa")?r="taketastage":(e.includes("Japan")||e.includes("japan"))&&(r="japanstage")}const i=t[r];s=i&&i.se&&i.se[e]?i.se[e]:`assets/audio/se/${e}.mp3`}const i=new Audio(s);i.volume=t;const o=i.play();void 0!==o&&o.catch((t=>{console.error(`SE ${e} ã®å†ç”Ÿã«å¤±æ•—ã—ã¾ã—ãŸ:`,t)})),i.addEventListener("ended",(()=>{i.remove()}))}catch(t){console.error(`SE ${e} ã®å†ç”Ÿã«å¤±æ•—ã—ã¾ã—ãŸ:`,t)}}playVoice(e,t=this.voiceVolume){if(this.isSceneUsable()&&(this.ensureAudioUnlocked(),!this.isVoiceMuted))if(this.scene&&this.scene.sound)try{const a=this.scene.sound.add(e,{volume:t});a.play(),a.once("complete",(()=>{a.destroy()}))}catch(t){console.error(`Voice ${e} ã®å†ç”Ÿã«å¤±æ•—ã—ã¾ã—ãŸ:`,t)}else console.warn("[AudioManager] Scene or sound system is not available for Voice:",e)}setBgmVolume(e){this.bgmVolume=e,this.bgm&&this.bgm.setVolume(e)}setSeVolume(e){this.seVolume=e}setVoiceVolume(e){this.voiceVolume=e}muteBgm(e){this.isBgmMuted=e,this.bgm&&this.bgm.setMute(e)}muteSe(e){this.isSeMuted=e}muteVoice(e){this.isVoiceMuted=e}muteAll(e){this.muteBgm(e),this.muteSe(e),this.muteVoice(e)}stopAll(){try{this.stopBgm(!1)}catch(e){}try{if(this.scene&&this.scene.sound){try{this.scene.sound.stopAll()}catch(e){}try{((this.scene.sound.getAllPlaying?this.scene.sound.getAllPlaying():[])||[]).forEach((e=>{try{e&&e.stop&&e.stop()}catch(e){}try{e&&e.destroy&&e.destroy()}catch(e){}}))}catch(e){}}}catch(e){}}destroy(){try{this.stopAll()}catch(e){}try{if(this.bgm){try{this.bgm.stop&&this.bgm.stop()}catch(e){}try{this.bgm.destroy&&this.bgm.destroy()}catch(e){}}}finally{this.bgm=null}try{const e=this.scene&&this.scene.cache&&this.scene.cache.audio?this.scene.cache.audio:null;e&&this.loadedSounds.forEach((t=>{try{e.exists(t)&&e.remove(t)}catch(e){}}))}catch(e){}this.loadedSounds.clear(),this.scene=null}async getDefaultBgmKey(){try{if(this.bgm&&this.bgm.key)return this.bgm.key;if(this.scene&&this.scene.scene&&this.scene.scene.key){const e=this.scene.scene.key;try{const{AreaConfig:t}=await Promise.resolve().then(a.bind(a,364));if(e.includes("Stage")&&"MapSelectionStage"!==e){const a=`stage${e.replace("Stage","").replace("Scene","")}`;if(t.stages&&t.stages[a]&&t.stages[a].bgm){const e=t.stages[a].bgm.map;if(e){const t=this.pathToBgmKey(e);if(t)return t}}}if("MapSelectionStage"===e&&this.scene.mapConfig){const e=this.scene.mapConfig.bgm;if(e){if(Object.prototype.hasOwnProperty.call(e,"map"))return"bgm_map";{const t=Object.keys(e)[0];if(t)return`bgm_${t}`}}}}catch(e){console.warn("[AudioManager] AreaConfig import error:",e)}}if(this.scene&&this.scene.mapConfig&&"object"==typeof this.scene.mapConfig.bgm){const e=this.scene.mapConfig.bgm;if(Object.prototype.hasOwnProperty.call(e,"map"))return"bgm_map";{const t=Object.keys(e)[0];if(t)return`bgm_${t}`}}return"bgm_default"}catch(e){return console.warn("[AudioManager] getDefaultBgmKey ã‚¨ãƒ©ãƒ¼:",e),"bgm_default"}}pathToBgmKey(e){try{if(!e)return null;const t=e.split("/").pop();return t?`bgm_${t.replace(/\.[^/.]+$/,"")}`:null}catch(e){return console.warn("[AudioManager] pathToBgmKey ã‚¨ãƒ©ãƒ¼:",e),null}}async loadConversationAudio(e){try{console.log(`[AudioManager] loadConversationAudioé–‹å§‹: ${e}`);const{getEventConfig:t}=await a.e(557).then(a.bind(a,557)),s=t(e);if(!s||!s.required)return console.warn(`[AudioManager] Event config not found for: ${e}`),!1;const{bgm:r,se:i}=s.required;if(console.log(`[AudioManager] å¿…è¦ãªãƒªã‚½ãƒ¼ã‚¹: BGM=${r}, SE=${i}`),r&&r.length>0)for(const e of r){const t=`bgm_${e}`;if(this.loadedSounds.has(t))console.log(`[AudioManager] BGMæ—¢ã«èª­ã¿è¾¼ã¿æ¸ˆã¿: ${t}`);else{const a=this.getBgmPathFromAreaConfig(e);if(a)this.scene.load.audio(t,a),console.log(`[AudioManager] BGMèª­ã¿è¾¼ã¿ã‚­ãƒ¥ãƒ¼è¿½åŠ : ${t} -> ${a}`);else{const a=`assets/audio/bgm/${e}.mp3`;this.scene.load.audio(t,a),console.log(`[AudioManager] BGMèª­ã¿è¾¼ã¿ã‚­ãƒ¥ãƒ¼è¿½åŠ ï¼ˆãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼‰: ${t} -> ${a}`)}}}if(i&&i.length>0)for(const e of i){const t=`se_${e}`;if(this.loadedSounds.has(t))console.log(`[AudioManager] SEæ—¢ã«èª­ã¿è¾¼ã¿æ¸ˆã¿: ${t}`);else{const a=`assets/audio/se/${e}.mp3`;this.scene.load.audio(t,a),console.log(`[AudioManager] SEèª­ã¿è¾¼ã¿ã‚­ãƒ¥ãƒ¼è¿½åŠ : ${t} -> ${a}`)}}return console.log(`[AudioManager] loadConversationAudioå®Œäº†: ${e}`),!0}catch(e){return console.error("[AudioManager] loadConversationAudio error:",e),!1}}getBgmPathFromAreaConfig(e){const t=`assets/audio/bgm/${e}.mp3`;return console.log(`[AudioManager] æ¨™æº–ãƒ‘ã‚¹ä½¿ç”¨: ${e} -> ${t}`),t}async playConversationBgm(e,t=this.bgmVolume,a=!0){try{this.stopBgm(!1);const s=`bgm_${e}`;if(!this.loadedSounds.has(s))return console.warn(`[AudioManager] BGMãƒ•ã‚¡ã‚¤ãƒ«ãŒèª­ã¿è¾¼ã¾ã‚Œã¦ã„ã¾ã›ã‚“: ${s}`),!1;try{const r=`assets/audio/bgm/${e}.mp3`;this.bgm=new Audio(r),this.bgm.loop=!0,this.bgm.volume=a?0:t;const i=this.bgm.play();return void 0!==i&&i.then((()=>{if(a){let e=0;const a=t,s=setInterval((()=>{e+=.02,e>=a&&(e=a,clearInterval(s)),this.bgm.volume=e}),25)}})).catch((e=>{console.error(`[AudioManager] HTMLAudio BGMå†ç”Ÿã‚¨ãƒ©ãƒ¼: ${s}`,e)})),this.bgm.key=s,!0}catch(e){return console.error(`[AudioManager] HTMLAudio BGMå†ç”Ÿã‚¨ãƒ©ãƒ¼: ${s}`,e),!1}}catch(t){return console.error(`[AudioManager] playConversationBgm error: ${e}`,t),!1}}}},327:(e,t,a)=>{a.r(t),a.d(t,{TaketaConversationManager:()=>r,taketaConversationData:()=>s});const s={lunch_tag:{background:"classroom",bgm:"Fantasy",conversations:[{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ãªã‚“ã‹ã€ä»Šé¬¼ã”ã£ã“ã—ãŸãã­ï¼Ÿ",expression:"a"},{speaker:"ã ã„ã¡",character:"daichi",text:"ã„ã‚„ã£ã€ã†ãƒ¼ã‚“ã€ã€ã€ã—ãŸã„ãªãã€ã€",expression:"b"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ãŠã‚‰ãã€ã€ã€ãŸã£ã¡",expression:"a"},{speaker:"ãªãŠã",character:"naoki",text:"ãˆã£ï¼Ÿï¼Ÿï¼Ÿï¼Ÿã„ããªã‚Šï¼Ÿ",expression:"a"},{speaker:"ãªãŠã",character:"naoki",text:"ãªã‚‰ã€ã‚ã€ã€ã¯ã„",expression:"a"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ãŠãŠã£ã¨ã€é †å¿œã¯ãˆãƒ¼ã‚“ã ã‚ˆ",expression:"a"},{speaker:"ã²ã‚ã‹ãšã€ãªãŠãã€ã“ã†ãŸã‚ã†ã€ã ã„ã¡ã€ã‚ãã–ã‚ã€ã—ã‚…ã†ã¸ã„",character:"hirokazu",text:"ã«ã’ã‚ã‰ã‰ã‰ï¼ï¼ï¼ï¼ï¼",expression:"c"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ãŠã‚‰ããããï¼ï¼ï¼ï¼ï¼",expression:"c"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã°ã‚Šã‚ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ï¼ï¼ï¼ï¼",expression:"d"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ãã‚Œã ã‘ã¯ã€ã—ã¡ã‚ƒã ã‚ã ã‚ã‰ã‰ã‰ï¼ï¼",expression:"c"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ã‚ãƒ¼ãƒ¼ããã‰ã€ã€ãªã‚“ã§ã€é«˜æ ¡ç”Ÿã«ãªã£ã¦é¬¼ã”ã£ã“ã—ãªãã‚ƒãªã‚‰ã‚“ã®ã ",expression:"c"},{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:"ã°ã‚Šã‚ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ï¼ï¼ï¼ï¼",expression:"d"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ã ã‹ã‚‰ã€ã ã‚ã ã‚ï¼ï¼ï¼ï¼",expression:"c"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ã€ã€ã€ã€ã€ã€ã€ã€",expression:"e"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ã“ã‚Œã¯ã€ã‚²ãƒ¼ãƒ ã˜ã‚ƒãªã„ã€ã„ã˜ã‚ã ã€ã€ã€",expression:"f"}]},gospellers_song:{background:"classroom",bgm:"Fantasy",conversations:[{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã‚´ã‚¹ãƒšãƒ©ãƒ¼ã‚ºã®ã€Œã²ã¨ã‚Šã€ã‚’æ­Œã†ãã€ã€ã€",expression:"a"},{speaker:"ã ã„ã¡",character:"daichi",text:"ãˆã£ã€ãªã‚“ã§ï¼Ÿ",expression:"a"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ã¾ãã€ã‚„ã‚‹ã‹ã€ã€ã€",expression:"b"},{se:"hitori"},{speaker:"ã²ã‚ã‹ãš,ã ã„ã¡,ã“ã†ãŸã‚ã†,ã‹ãªã¨",character:"hirokazu,daichi,koutarou,kanato",text:"ã€ã€ã€ã€ã€ã‚„ã‚ã‚ˆã†",expression:"b"}]},climbing_injury:{background:"classroom",bgm:"Fantasy",conversations:[{speaker:"ã‹ãªã¨",character:"kanato",text:"ã‚ã‚Œã€ã²ã‚ã‹ãšã©ã†ã—ãŸï¼Ÿãã®æŒ‡ï¼Ÿ",expression:"b"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã‚¯ãƒ©ã‚¤ãƒŸãƒ³ã‚°ã§ã‚±ã‚¬ã—ãŸ",expression:"d"}]},classroom_lock_incident:{background:"classroom_door",bgm:"Jounetsu_Tairiku",conversations:[{speaker:"å®‰è—¤å…ˆç”Ÿ",character:"ando_sensei",text:"ãªã‚“ã‹ã—ã¾ã£ã¦ã‚‹",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"åå¯¾å´ã«è¡Œãã€ã“ã£ã¡ã‚‚ã—ã¾ã£ã¦ã„ã‚‹",expression:"b"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã¡ã‚‡ã£ã¨ã€å·¥è—¤ã‚ã‘ã¦",expression:"c"},{speaker:"å·¥è—¤",character:"kudo",text:"ãƒ´ã‰ã€‚",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ï¼ˆã‚ã‘ã¦é–‰ã‚ã‚ï¼‰",expression:"d"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ãŒã¡ã‚ƒãŒã¡ã‚ƒã‚Šï¼ˆï¼’å›ãªã‚‹ï¼‰",expression:"e"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã‚ã„ã¦ãªã„ãï¼ã‚‚ã†ä¸€åº¦",expression:"f"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"åå¯¾å´ã¯ï¼Ÿ",expression:"c"},{speaker:"å·¥è—¤",character:"kudo",text:"ãƒ´ã‰ã€‚",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ï¼ˆã‚ã‘ã¦é–‰ã‚ã‚ï¼‰",expression:"d"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ãŒã¡ã‚ƒãŒã¡ã‚ƒã‚Šï¼ˆï¼’å›ãªã‚‹ï¼‰",expression:"e"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã“ã“ã‚‚ç©ºã„ã¦ãªã„ã€ã‚ã‘ã¦",expression:"f"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ãŠã„ï¼ã‚ã–ã¨ã—ã‚ãŸã ã‚",expression:"g"},{speaker:"å·¥è—¤",character:"kudo",text:"ã€‚ã€‚ã€‚",expression:"b"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ï¼ˆå·¥è—¤é–‰ã‚ã‚ï¼‰",expression:"d"},{speaker:"å·¥è—¤",character:"kudo",text:"ãƒ´ã‰ã€‚",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ãŸã£ãŸã£ãŸãƒƒï¼ˆãŒãƒãƒ£ãƒªï¼‰",expression:"e"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã„ã¾ã€ã—ã‚ãŸã ã‚ï¼ï¼ï¼",expression:"g"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã²ã‚ã‹ãšã€é€ƒèµ°",expression:"h"},{speaker:"å·¥è—¤",character:"kudo",text:"å·¥è—¤ã€€é€ƒã’é…ã‚Œã‚‹",expression:"d"}]},koutarou_toilet:{background:"classroom",bgm:"Fantasy",conversations:[{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:"ä¿ºãŠã—ã£ã“è¿‘ã„ã‚“ã‚ˆã­ã€",expression:"a"},{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:"ãŠã—ã£ã“è¡Œã£ã¦ãã‚‹ã‚",expression:"b"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ï¼‘é™ç›®ä¼‘æ†©",expression:"c"},{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:"ãŠã—ã£ã“è¡Œã£ã¦ãã‚‹ã‚",expression:"b"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ï¼’é™ç›®ä¼‘æ†©",expression:"c"},{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:"æ°´é£²ã ã‹ã‚‰ã‹ãªã€ãŠã—ã£ã“è¡Œã£ã¦ãã‚‹ã‚",expression:"b"},{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:"ã†ã‚“ã“ã‚‚ã€è¡Œã£ã¦ãã‚‹ã‚",expression:"b"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã€ã€ã€",expression:"d"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ï¼“åˆ†å¾Œ",expression:"c"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"æ—©ãã­ï¼Ÿ",expression:"b"},{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:"ãŠã‚Œã€ã†ã‚“ã“ã‚ã£ã¡ã‚ƒæ—©ã„ã‚“ã‚ˆã­",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"3é™ç›®ä¼‘æ†©",expression:"c"},{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:"ãŠã—ã£ã“è¡Œã£ã¦ãã‚‹ã‚",expression:"b"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã“ã†ãŸã‚ã†ã€ä¿ºã‚‚è¡Œã£ã¦ãã‚‹ã‚",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã„ã‚„ã€ãŠå‰ã¯è¡Œã£ã¡ã‚ƒãƒ€ãƒ¡ã ",expression:"c"},{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:"ãªã‚“ã§ï¼Ÿ",expression:"b"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"è†€èƒ±ã§ã‹ã„ã‹ã‚‰",expression:"d"},{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:"ã‹ã‚“ã‘ã„ãªã„ã ã‚ã€‚ã€‚ã€",expression:"e"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ï¼”é™ç›®çµ‚äº†æ˜¼ä¼‘ã¿",expression:"c"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã‚ˆã—ã€ã“ã†ãŸã‚ã†ã€ã„ã£ã¦ã„ã„ã",expression:"a"},{speaker:"ä»–",character:"others",text:"ï¼ˆã“ã†ãŸã‚ã†ã¯è†€èƒ±å¤§ãã„ã‚“ã ãªï¼‰",expression:"b"},{speaker:"ãƒŠãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³",character:"narrator",text:"ã²ã‚ã‹ãšã«ã‚ˆã‚Šã€ã“ã®æ—¥ã‹ã‚‰ã“ã†ãŸã‚ã†ã¯æ˜¼ä¼‘ã¿ã¾ã§ãŠã—ã£ã“ã«ã„ã‘ãªããªã£ãŸ",expression:"a"}]},culture_festival_apology:{background:"classroom",bgm:"Nagisa_Moderato",conversations:[{speaker:"å…ˆç”Ÿ",character:"teacher",text:"ã¨ã‚Šã‚ãˆãšã€æ•™è·å“¡ã®ä¼šè­°ãŒã‚ã‚‹ã‹ã‚‰ã€ã„ã£ãŸã‚“æ•™å®¤ã§å¾…æ©Ÿã—ã¨ã„ã¦",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã€ã€ã€ã€ã€ã€ã€ã€",expression:"b"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ä»Šå¸°ã£ãŸã‚‰ã€ï¼”ï¼šï¼“ï¼ã®é›»è»Šã«ã¾ã«ã‚ã†ï¼",expression:"c"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ç«¹ç”°ã¯ä¸€æ™‚é–“ã«ï¼‘æœ¬ã—ã‹é›»è»ŠãŒãªã„",expression:"d"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ãŠã„ã€è¡Œããï¼",expression:"e"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ãŸã£ãŸã£ãŸã£ï¼ˆï½“Eï¼‰",expression:"f"},{speaker:"å…ˆç”Ÿ",character:"teacher",text:"æ¬¡ã®æ—¥",expression:"a"},{speaker:"å…ˆç”Ÿ",character:"teacher",text:"ãˆãƒ¼ã€ã¿ã‚“ãªãŒã¡ã‚ƒã‚“ã¨å¾…ã£ã¦ã„ã‚‹é–“è¼ªã‚’ã¿ã ã—ã¦ã€å…ˆã«å¸°ã£ãŸè€…ãŒã„ã¾ã™ã€",expression:"c"},{speaker:"å…ˆç”Ÿ",character:"teacher",text:"å‰ã«ã§ã¦ã€ä¸€äººã¥ã¤åçœã®è¨€è‘‰ã‚’è¨€ã£ã¦ãã ã•ã„",expression:"d"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"å…ˆã«ã‹ãˆã£ã¦ç”³ã—è¨³ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸï¼",expression:"e"},{speaker:"å…ˆç”Ÿ",character:"teacher",text:"ãˆãƒ¼ã€å…ˆã«å¸°ã£ãŸã®ã§è²¬ä»»ã¨ã£ã¦ã€ä»Šå›ã®å¸­æ›¿ãˆã¯å¸°ã£ãŸäººå…¨å“¡ä¸€ç•ªå‰ã®å¸­ã«ãªã‚Šã¾ã™",expression:"f"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ãã£ã€ã€ã€",expression:"g"}]},train_no_poop_man:{background:"station",bgm:"Nagisa_Moderato",conversations:[{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"é›»è»Šå†…ã†ã‚“ã“ãŠã˜ã•ã‚“äº‹ä»¶",expression:"a"}]},galaxy_water:{background:"galaxy",bgm:"nightbarth",conversations:[{text:"éŠ€æ²³ã¨æ›¸ã„ã¦ã„ã‚‹æ°´ãŒã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã«ç½®ã„ã¦ã‚ã‚‹",expression:"a"},{text:"ãã®ä¸‹ã«ï¼‘ï¼•ï¼ï¼å††ã¨æ›¸ã„ã¦ã‚ã‚‹ã€ã€ã€",expression:"a"},{speaker:"ã ã„ã¡",character:"daichi",text:"ãŸã£ã‹ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼",expression:"b"}]},taketa_station:{background:"station",bgm:"nightbarth",conversations:[{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ç«¹ç”°é§…ã ",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"é›»è»Šã§æ¥ãŸãª",expression:"b"}]},videocamera_broken:{background:"classroom",bgm:"Fantasy",conversations:[{speaker:"ã‹ãªã¨",character:"kanato",text:"ã¡ã‚‡ã£ã¨ã€ã¿ã—ã‚ãƒ¼",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ãªã«ãƒ¼ï¼Ÿ",expression:"a"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ã”ã‚ã‚“ã€ãƒ“ãƒ‡ã‚ªã‚«ãƒ¡ãƒ©è½ã¨ã—ãŸã€ãã—ã¦ã€å‰²ã‚ŒãŸã€ã€ã€",expression:"c"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ä»Šåº¦ã€ä¿®ç†ä»£æ‰•ã†ã‚ã€ã€ã€",expression:"d"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ã¾ã˜ã‹ãƒ¼ãƒ¼ã€ã—ã‚ƒãƒ¼ãªã„ãªãã€ã€ã€",expression:"c"},{speaker:"ãƒŠãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³",character:"narrator",text:"12å¹´å¾Œã€ã„ã¾ã ã«ãƒ“ãƒ‡ã‚ªã‚«ãƒ¡ãƒ©ãŒç›´ã‚‹ã“ã¨ã¯ãªã„ã‚ˆã†ã ",expression:"a"}]},drama_filming:{background:"classroom",bgm:"nightbarth",conversations:[{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã›ã£ã‹ããƒ“ãƒ‡ã‚ªã‚«ãƒ¡ãƒ©ã‚ã‚‹ã—ã€ãªã‚“ã‹ã€ãƒ‰ãƒ©ãƒã‚’æ’®ã‚ã†",expression:"a"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ã¾ãã€ãˆãˆã‘ã©ä½•ã‚’ã¨ã‚‹ï¼Ÿ",expression:"b"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã˜ã‚ƒã‚ã€å„ã€…åº§ã£ã¦ãã‚Œã€ã»ã‚‰",expression:"a"},{speaker:"ã ã„ã¡ã€ã“ã†ãŸã‚ã†ã€ã—ã‚…ã†ã¸ã„ã€ã¾ã•ã¨ã€ã‹ãªã¨",character:"daichi,koutarou,shuuhei,masato,kanato",text:"ã¾ãã€äº†è§£",expression:"b"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ãŠã‚Œã«ã¯è‡ªä¿¡ã®ã‚ã‚‹ã€ã‚¢ã‚¤ãƒ‡ã‚¢ãŒã‚ã‚‹ã‚“ã ",expression:"a"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ã‚¢ã‚¤ãƒ‡ã‚¢ã¨ã¯ï¼Ÿ",expression:"b"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã¾ã•ã¨ãŒæ•™å¸«è¨³ã§ã€é †ç•ªã«å½“ã¦ã¦ã„ãã‹ã‚‰æœ€å¾Œã¿ã—ã‚ã¯â–¢ã£ã¦ã¾ã™ã£ã¦ã„ã£ã¦ã€ç«‹ã¤ãª",expression:"a"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»",expression:"c"},{speaker:"ã ã„ã¡ã€ã“ã†ãŸã‚ã†ã€ã—ã‚…ã†ã¸ã„ã€ã¾ã•ã¨",character:"daichi,koutarou,shuuhei,masato",text:"äº†è§£ï¼",expression:"b"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ãˆã£ã€ãªã‚“ã‚‚ã€ç†è§£ã§ããªã‹ã£ãŸã‚“ã ã‘ã©ï¼Ÿ",expression:"c"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã¯ã„ä½ç½®ã«ã¤ã„ã¦ãƒ¼",expression:"a"},{speaker:"ã¾ã•ã¨",character:"masato",text:"ãã‚Šãƒ¼ã¤ã€ç¤¼ï¼",expression:"a"},{speaker:"ã ã„ã¡ã€ã—ã‚…ã†ã¸ã„ã€ã“ã†ãŸã‚ã†",character:"daichi,shuuhei,koutarou",text:"ãŠã­ãŒã„ã—ã¾ãƒ¼ã™ï¼",expression:"b"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ã¡ã‚‡ã£ã€ã¾ã¦ã‚ˆã€ã€",expression:"c"},{speaker:"ã¾ã•ã¨",character:"masato",text:"ãã‚‡ã†ã¯ã‚­ãƒã‚³ã«ã¤ã„ã¦ã€æˆæ¥­ã‚’ã™ã‚‹",expression:"a"},{speaker:"ã¾ã•ã¨",character:"masato",text:"ãã®ã“ã¨ã¯ãªã‚“ã ï¼Ÿã ã„ã¡ã€‚å¸­ã‚’ç«‹ã£ã¦ã“ãŸãˆã¦ã¿ã‚",expression:"a"},{speaker:"ã‹ãªã¨",character:"kanato",text:"æ‹’å¦ã¯ã§ããªã„ã‚“ã§ã™ã‹ã­ï¼Ÿ",expression:"c"},{speaker:"ã ã„ã¡",character:"daichi",text:"èŒã§ã™ã€‚",expression:"b"},{speaker:"ã¾ã•ã¨",character:"masato",text:"ãã†ã ã€ã§ã¯ã‚­ãƒã‚³ã¯ã©ã“ã«ã¯ãˆã‚‹ï¼Ÿã“ã†ãŸã‚ã†ã“ãŸãˆã¦ã¿ã‚",expression:"a"},{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:"æ£®ãªã©ã˜ã‚ã˜ã‚ã—ãŸã¨ã“ã‚ã«ç”Ÿãˆã‚‹ã“ã¨ãŒå¤šã„ã§ã™",expression:"b"},{speaker:"ã‹ãªã¨",character:"kanato",text:"æ‹’å¦æ¨©ã¯ãªã„ã‚“ã§ã™ã‹ã­ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿ",expression:"c"},{speaker:"ã¾ã•ã¨",character:"masato",text:"æ­£è§£ã ã€ã˜ã‚ƒã€ã“ã®ãã®ã“ã¯ãªã‚“ã¦ã„ã†ã‚“ã ï¼Ÿã—ã‚…ã†ã¸ã„",expression:"a"},{speaker:"ã—ã‚…ã†ã¸ã„",character:"shuuhei",text:"ã—ã„ãŸã‘ã§ã™",expression:"b"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ãªã„ã‚“ã§ã™ã­ï¼ãããŒã£",expression:"c"},{speaker:"ã¾ã•ã¨",character:"masato",text:"ãã†ã ãªã€ã“ã‚Œã¯ã‚ˆãé£Ÿå“ãªã©ã§é£Ÿã¹ã‚‰ã‚Œã‚‹ãã®ã“ã ",expression:"a"},{speaker:"ã¾ã•ã¨",character:"masato",text:"ã˜ã‚ƒã‚ã€æ¬¡ã¯ã€ã“ã‚Œã¯ä½•ã¦ã„ã†ã‚“ã ï¼Ÿã¿ã—ã‚ãƒ¼",expression:"a"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ã€ã€ã€ã€ã€",expression:"c"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ã€ã€ã€ã€ã€ã€ã€ã€ã€ã€ã™ã¿ã¾ã›ã‚“ã€â–¢ã£ã¦ã¾ã™ã€‚",expression:"c"},{speaker:"ã¾ã•ã¨",character:"masato",text:"ã©ã†ã—ãŸãƒ¼ï¼Ÿã¿ã—ã‚ãƒ¼",expression:"b"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ã‚ã£ã€ã„ã‚„ã€â–¢ã£ã¦ã¾ã™ã€‚",expression:"c"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ãƒŸã‚·ãƒ­ã©ã†ã—ãŸï¼Ÿã¡ã‚ƒã‚“ã¨ç«‹ã¦ã‚ˆ",expression:"d"},{speaker:"ã ã„ã¡",character:"daichi",text:"ã‹ãªã¨ã©ã†ã—ãŸï¼Ÿã»ã‚‰ç«‹ã¦ã‚ˆ",expression:"b"},{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:"ã»ã‚‰ã",expression:"b"},{speaker:"ã—ã‚…ã†ã¸ã„",character:"shuuhei",text:"ã¿ã—ã‚ã©ã†ã—ãŸï¼Ÿ",expression:"b"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ã ã‹ã‚‰ã€â–¢ã£ã¦ã¾ã™ã€‚ã‚‚ã†ã™ã§ã«â–¢ã£ã¦ã¾ã™ã€‚",expression:"c"},{speaker:"ã²ã‚ã‹ãšã€ã ã„ã¡ã€ã“ã†ãŸã‚ã†ã€ã—ã‚…ã†ã¸ã„ã€ã¾ã•ã¨",character:"hirokazu,daichi,koutarou,shuuhei,masato",text:"ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»",expression:"c"},{speaker:"ã—ã‚…ã†ã¸ã„",character:"shuuhei",text:"ã†ã‚ãƒ¼ãƒ¼ãƒ¼",expression:"c"},{speaker:"ã ã„ã¡",character:"daichi",text:"ãƒ»ãƒ»ãƒ»",expression:"c"},{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:"ã€ã€ã€ã€ã€",expression:"c"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ãã‚‚ã¡ã‚ã‚‹ã„ãªã",expression:"d"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ã²ã‚ã‹ãšã•ã‚“ã€ã‚ªãƒ–ãƒ©ãƒ¼ãƒˆã£ã¦çŸ¥ã£ã¦ã¾ã™ï¼Ÿ",expression:"c"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"å½“ãŸã‚Šå‰ã ã‚ã€‚è–¬ã‚‚è¨€è‘‰ã‚‚åŒ…ã‚ã‚‹ä¾¿åˆ©ãªã‚‚ã®ã•",expression:"a"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ã˜ã‚ƒã‚ã€åŒ…ã‚ã‚ˆï¼ï¼ï¼ãã®ã€è¨€è‘‰ã®åˆƒã‚’ã•ãã€ã‚„ã‚‰ã›ãŸã®ã€ãŠå‰ã˜ã‚ƒã­ãƒ¼ã‹ï¼",expression:"c"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ãƒ»ãƒ»ãƒ»",expression:"c"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ã‚„ã‚‰ã›ã¨ã„ã¦ã€å¼•ãã®ã‚„ã‚ã¦ã‚‚ã‚‰ãˆã¾ã™ï¼Ÿ",expression:"c"},{speaker:"ã¾ã•ã¨",character:"masato",text:"ã¿ã—ã‚ã€ä¸æ­£è§£",expression:"d"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ã†ã‚‹ã›ãƒ¼ã‚ˆï¼",expression:"c"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ã£ã¦ã‹ã€æã™ã‚‹ã®ä¿ºã ã‘ã˜ã‚ƒã­ãƒ¼ã‹ã‚ˆã€‚",expression:"c"},{speaker:"ã ã„ã¡",character:"daichi",text:"ãã†ã ã‚ˆ",expression:"b"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã¾ãã€åº§ã‚Œã‚ˆ",expression:"a"},{speaker:"ã‹ãªã¨",character:"kanato",text:"æœ€åˆã‹ã‚‰ã€ç«‹ã£ã¦ã­ãƒ¼ã‚ˆï¼ï¼Ÿ",expression:"c"}]},kannnamu_kudou:{background:"train",bgm:"Fantasy",conversations:[{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã“ã‚Œã„ã„ãª",expression:"a"},{speaker:"ãã©ã†",character:"kudo",text:"ãµã‚“ã£ãµã‚“ã£ãµã‚“ã£",expression:"a"},{speaker:"ãªãŠã",character:"naoki",text:"ä½•ã—ã¦ã‚“ã®ï¼Ÿ",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ãã©ã†ã«ã‚«ãƒ³ãƒŠãƒ ã‚¹ã‚¿ã‚¤ãƒ«ã‚’èºã‚‰ã›ã¦ã„ã‚‹",expression:"a"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ãªã‚“ã§ï¼Ÿ",expression:"b"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ãŠã‚‚ã—ã‚ã„ã‹ã‚‰",expression:"a"},{speaker:"ãªãŠãã€ã‹ãªã¨ã€ã ã„ã¡",character:"naoki,kanato,daichi",text:"ãƒ»ãƒ»ãƒ»",expression:"c"}]},udefuriojisann:{background:"street",bgm:"Fantasy",conversations:[{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ãªã‚“ã‹ç«¹ç”°ã‹ã‚‰å¸°ã‚‹ã¨ãã•ã€è…•ã‚’ã•ã’ãªã„ã§ã£ã¦ã‹çªãä¸Šã’ã¦ã€æ­©ã„ã¦ã‚‹äººã„ã‚‹ã‚ˆãª",expression:"a"},{speaker:"ãƒ€ã‚¤ãƒ",character:"daichi",text:"ãªã‚“ã‹è¦‹ãŸã“ã¨ã‚ã‚‹ãªã€ã€",expression:"b"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ãã®äººã€ã‚ã£ã¡ã‚ƒæ­©ãã®ã¯ãˆãƒ¼ã‚“ã ã‚ˆãªã€ç«¹ç”°ã§ã‚„ã£ã¦ã‚‹å¡¾ã®å…ˆç”Ÿã‚‰ã—ã„ã‘ã©",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã¡ã‚ƒã‚“ã¨ã—ãŸã€æ­©ãæ–¹ãŠã—ãˆã¦ã‚‚ã‚‰ã£ã¦ãªã„ã‚“ã‹ãª",expression:"b"},{speaker:"ã ã„ã¡",character:"daichi",text:"ã¡ã‚ƒã‚“ã¨ã—ãŸæ­©ãæ–¹ã£ã¦ãªã‚“ã ã‚ˆ",expression:"b"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ã€ã€ã€ã¾ãã€è¶³ã¯ã€æ­£ã—ã„å‹ã ã‚ˆ",expression:"a"}]},working_go_to_home_miemachi:{background:"street",bgm:"Nagisa_Moderato",conversations:[{speaker:"ã‹ãªã¨",character:"kanato",text:"ã¯ã˜ã‚ã¦ã ãªã€é«˜æ ¡ã®ãƒ¡ãƒ³ãƒãƒ¼ã§é£²ã¿ä¼šã™ã‚‹ã®ã¯",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ä¸‰é‡ã®äººé–“ã¯ä¸‰é‡ç”ºã§é£²ã‚€ã‹ã‚‰ãª",expression:"a"},{speaker:"ã ã„ã¡",character:"daichi",text:"ãã†ã„ãˆã°ã€ã€ã€ã€ã€ç«¹ç”°ã®çµ‚é›»ã£ã¦ã©ã†ãªã£ã¦ã„ã‚‹ã€ã€ã€",expression:"b"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ä»Šä½•æ™‚ã ï¼Ÿï¼Ÿï¼Ÿ",expression:"c"},{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:"ã‚‚ã†ã€11æ™‚ã™ããŸãªã€ã€ã€",expression:"b"},{speaker:"ãªãŠã",character:"naoki",text:"ï¼’ï¼’æ™‚ã«ã¯ã‚‚ã†çµ‚é›»ãªã‹ã£ãŸã",expression:"b"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ãªãœè¨€ã‚ãªã„",expression:"c"},{speaker:"ãªãŠã",character:"naoki",text:"ãã‹ã‚Œãªã‹ã£ãŸã‹ã‚‰",expression:"b"},{speaker:"ã ã„ã¡",character:"daichi",text:"é¦¬é¹¿ã‚„ã‚ãƒ¼",expression:"c"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã©ã†ã™ã‚‹ã‚ˆã€ç«¹ç”°ã¯ã©ã“ã«ã‚‚æ³Šã¾ã‚‹ã‚ã¦ã‚‚ãªã„ã",expression:"d"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ã‚¿ã‚¯ã‚·ãƒ¼ã¯ï¼Ÿ",expression:"b"},{speaker:"ãªãŠã",character:"naoki",text:"è»Šã§ï¼“ï¼åˆ†ä»¥ä¸Šã‹ã‹ã‚‹ã‹ã‚‰ã€ã„ãã‚‰ã‹ã‹ã‚‹ã‹ã‚ã‹ã‚‰ãªã„ã",expression:"b"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ãã‚‚ãã‚‚ã€ä¸€å°ã®ã‚¿ã‚¯ã‚·ãƒ¼ã«ï¼•äººã‚‚ä¹—ã‚Œãªã„ã‹ã‚‰ã€2-3ã§åˆ¥ã‚Œã‚‹ã—ã‹ãªã„ã—ãª",expression:"b"},{speaker:"ã ã„ã¡",character:"daichi",text:"ï¼’å°ã„ã‚‹ã¨ã„ã†ã“ã¨ã‹ã€ã€ã€",expression:"b"},{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:"ã©ã†ã™ã‚‹ã‹ã€ã€ã€ã€ã€",expression:"b"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"æ­©ã„ã¦å¸°ã‚‹ãï¼ï¼ï¼",expression:"a"},{speaker:"ã ã„ã¡",character:"daichi",text:"ã€ã€ã€æ­©ããï¼ï¼ï¼",expression:"a"},{speaker:"ãªãŠã",character:"naoki",text:"ãã†ã™ã‚‹ã—ã‹ãªã„ã‹ï¼ï¼ï¼",expression:"a"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ä»•æ–¹ãªã„ãªã€ã‚„ã‚‹ã—ã‹ã­ãƒ¼ãªï¼ï¼ï¼",expression:"a"},{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:"ã‚„ã‚‹ã‹ã£ï¼ï¼",expression:"a"},{speaker:"ç«¹ç”°ã®ãƒ¡ãƒ³ãƒãƒ¼",character:"others",text:"ã“ã„ã¤ã‚‰ãƒã‚¸ã‹ã€ã€ã€ã€ã€å¤§ä¸ˆå¤«ã‹ï¼Ÿ",expression:"b"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ãŠã‚‰ãï¼ï¼ï¼ï¼ï¼",expression:"a"},{speaker:"ç«¹ç”°ã®ãƒ¡ãƒ³ãƒãƒ¼",character:"others",text:"ä»Šã€ï¼‘ï¼’æœˆã ã‘ã©ã€å¤§ä¸ˆå¤«ã‹ï¼Ÿ",expression:"b"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ã„ã‘ã‚‹ã„ã‘ã‚‹",expression:"a"},{speaker:"ã ã„ã¡",character:"daichi",text:"å¤§ä¸ˆå¤«ï¼ï¼ï¼ï¼ã„ã‘ã‚‹ï¼ï¼ï¼ï¼",expression:"a"},{speaker:"ãªãŠã",character:"naoki",text:"ã‚ˆã‚†ãƒ¼ã‚ˆã‚†ãƒ¼",expression:"a"},{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:"ãƒã‚¸ã€ã‚ˆã‚†ãƒ¼",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ãŠã‚‰ãã€ã„ããï¼ï¼ï¼ï¼",expression:"a"},{speaker:"ç«¹ç”°ã®ãƒ¡ãƒ³ãƒãƒ¼",character:"others",text:"ãŠã£ã€ã€ã€ãŠã£ã€ã€ã¾ãã€é ‘å¼µã‚Œ",expression:"b"},{speaker:"ãƒŠãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³",character:"narrator",text:"ï¼‘æ™‚é–“å¾Œ",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ãªã‚“ã‹å¯’ãã­ãƒ¼ã‹ï¼Ÿ",expression:"b"},{speaker:"ãªãŠã",character:"naoki",text:"ã‚ã‚Œã€ãªã‚“ã‹å¯’ã„ãª",expression:"b"},{speaker:"ã‹ãªã¨",character:"kanato",text:"å¯’ã„æ°—ãŒã™ã‚‹ãª",expression:"b"},{speaker:"ã ã„ã¡",character:"daichi",text:"ã‚‚ã—ã‹ã—ã¦ã€ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«ã®ãŠã‹ã’ã ã£ãŸã‹ï¼Ÿ",expression:"b"},{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:"ãã†ã‹ã‚‚ã€ã—ã‚Œãªã„",expression:"b"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã‚ã£ã€è¨€ã£ã¦ãªã‹ã£ãŸã‚“ã ã‘ã©ã€",expression:"b"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ãŠã‚Œã€è¶³ã«ã²ã³ãŒå…¥ã£ã¦ã„ã¦ã‚ã‚“ã¾ã‚Šã€ã†ã¾ãæ­©ã‘ãªã„ã‚“ã ã‚ˆã­ã€ä»Š",expression:"d"},{speaker:"ã ã„ã¡",character:"daichi",text:"ã„ã¾ã„ã†ï¼Ÿ",expression:"c"},{speaker:"ãƒŠãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³",character:"narrator",text:"ï¼’æ™‚é–“å¾Œ",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã‚ã£ã€ã“ã‚Œã‚„ã¹ãƒ¼ã•ã‚€ã„ã‚ã€è¶³ã„ã¦ãƒ¼ã‚",expression:"d"},{speaker:"ã ã„ã¡",character:"daichi",text:"ã“ã‚Œã¯ã„ã‹ã‚“ã",expression:"c"},{speaker:"ãªãŠã",character:"naoki",text:"ãªã‚ã¦ãŸã‹ã‚‚ã—ã‚Œã‚“",expression:"b"},{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:"ãã‚Œã«ã—ã¦ã‚‚ã€å¤œç©ºã¯ãã‚Œã„ã ãª",expression:"a"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ã“ã‚“ãªã«å¤œç©ºã‚’çœºã‚ã‚‹ã®ã¯ä¹…ã—ã¶ã‚Šã ãªã€ãã‚Œã„ã ",expression:"a"},{speaker:"ãƒŠãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³",character:"narrator",text:"ï¼“æ™‚é–“å¾Œ",expression:"a"},{speaker:"ã‹ãªã¨",character:"kanato",text:"å¤§ä¸ˆå¤«ã‹ï¼Ÿãªã‚“ã‹ã€è¶³ã‚’å¼•ããšã‚ŠãªãŒã‚‰ã€æ­©ã„ã¦ã„ã‚‹ã‘ã©",expression:"b"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã‚ã‚“ã¾ã‚Šå¤§ä¸ˆå¤«ã˜ã‚ƒãªã„",expression:"d"},{speaker:"ãªãŠã",character:"naoki",text:"ã•ã‚€ã„ã€ã€ã€ã€äººãŒæ­»ã¬ãƒ¬ãƒ™ãƒ«ã€ã€ã€",expression:"d"},{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:"å¤œç©ºãŒãã‚Œã„ã ãªã€ã€ã€ã‚¹ãƒ†ã‚­ã€ã€ã€",expression:"a"},{speaker:"ã ã„ã¡",character:"daichi",text:"ã¡ã‚‡ã£ã¨ã€ã‚„ã°ã„ã€ã¨ã£ã€ã¨ã‚Šã‚ãˆãšã€æš–ã‚’å–ã‚‰ã­ãƒ¼ã¨æ­»ã¬",expression:"c"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ã‚‚ã†ã¡ã‚‡ã£ã¨ã„ã£ãŸã‚‰ã€ã‚³ãƒ³ãƒ“ãƒ‹ãŒã‚ã‚‹ã¯ãšã€é–‹ã„ã¦ã„ã‚‹ã¨ã¯æ€ã†ã‘ã©ã€ã€ã€",expression:"b"},{speaker:"ãƒŠãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³",character:"narrator",text:"ï¼”æ™‚é–“å¾Œ",expression:"a"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ã‚³ãƒ³ãƒ“ãƒ‹é–‹ã„ã¦ã„ãŸãªã€ã€åŠ©ã‹ã£ãŸã€ã€ãƒã‚¸ã§",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã‚ã€ã€ã€ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«è²·ã†ã",expression:"a"},{speaker:"ãªãŠã",character:"naoki",text:"ãƒ»ãƒ»ãƒ»",expression:"c"},{speaker:"ã ã„ã¡",character:"daichi",text:"ãªãŠããŒã—ã‚ƒã¹ã‚‰ãªã„ã€ã€ã€",expression:"b"},{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:"é…’ã€ã€ã€é…’ã€ã€ã€ã€å¯’ã„ã€ã€ç©ºãŒãã‚Œã„ã€ã€ã€ãã‚Œã„ã€ã€ï¼Ÿ",expression:"c"},{speaker:"ãƒŠãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³",character:"narrator",text:"ï¼•æ™‚é–“å¾Œ",expression:"a"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ãªãŠãã©ã†ã—ãŸï¼Ÿ",expression:"b"},{speaker:"ãªãŠã",character:"naoki",text:"ã‚„ã°ã„ã‹ã‚‚ã€ä¿ºã‚‚è¶³ãŒç—›ã„ã‹ã‚‚",expression:"d"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ä¿ºã“ã®å‰ã€åŒ»è€…ã«ã„ã£ãŸã‚“ã ã‚ˆãª",expression:"b"},{speaker:"ã ã„ã¡",character:"daichi",text:"ãªã‚“ã§ã€æ­©ã„ã¦å¸°ã‚‹ã¨ã‹ã„ã£ãŸã‚“ã ã‚ˆ",expression:"c"},{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:"ãªã‚“ã‹ã€å¤œç©ºãŒã‚­ãƒ¬ã‚¤ãªã®ãŒãƒ ã‚«ã¤ã„ã¦ããŸ",expression:"c"},{speaker:"ãªãŠã",character:"naoki",text:"ã²ã‚ã‹ãšãã‚“ã€ã¡ã‚‡ã£ã¨è‚©ã‚’è²¸ã—ã‚ãŠã†ã€ã€",expression:"b"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ãã†ã ãªã€ã€ã€",expression:"b"},{speaker:"ãªãŠãã€ã²ã‚ã‹ãš",character:"naoki,hirokazu",text:"ã„ã¡ã€ã«ã€ã„ã¡ã€ã«ã€ã„ã¡ã€ã«ã€ã€ã€ã€ã€ã€",expression:"b"},{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:"ã‚ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ã€ããï¼ï¼ï¼ç©ºãŒã‚­ãƒ¬ã‚¤ã ãªããƒ¼ãƒ¼ãƒ¼ãƒ¼ã€ãããŒ",expression:"c"},{speaker:"ãƒŠãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³",character:"narrator",text:"ï¼–æ™‚é–“å¾Œ",expression:"a"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ã‚ã£ã€ã¿ã‚“ãªã‚ãã‚‰ã‚ã‚‹ãªã€ã€ã€æ­©ãã‚’æ­¢ã‚ãŸã‚‰ã€æ­»ã¬ã",expression:"c"},{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:"ã¡ã‚‡ã£ã¨ã€ãƒã‚¸ã§æ­»ã¬ã",expression:"c"},{speaker:"ã ã„ã¡",character:"daichi",text:"ãˆãã„ã€ãˆãã„ãˆãã„ã€å·æ²¿ã„ãˆãã„ãã€å†—è«‡æŠœãã§å‡ãˆæ­»ã¬ã",expression:"c"},{speaker:"ã²ã‚ã‹ãšã€ãªãŠã",character:"hirokazu,naoki",text:"ãƒ»ãƒ»ãƒ»",expression:"c"},{speaker:"ã ã„ã¡",character:"daichi",text:"ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«ãŒã€ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«ãŒã€ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«ãŒã€ã€ã€ã€ã€ã€ã€ã€",expression:"c"},{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:"ã“ã“ã«ãã¦ã€å¤œç©ºãŒã€ã‚ã£ã¡ã‚ƒãã‚Œã„ã«è¦‹ãˆã‚‹ã®ã‚ã£ã¡ã‚ƒã‚€ã‹ã¤ã„ã¦ããŸ",expression:"c"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ã•ã‚€ã„ã•ã‚€ã„ã•ã‚€ã„ã€ã¡ã‚‡ã£ã¨ã€å†—è«‡ã˜ã‚ƒãªã„ã",expression:"c"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ã¡ã‚‡ã£ã¨ã€çš†ã¿ã¦ã¿ã‚ï¼ï¼ãªã«ã‹ã€ã€ã€ãªã«ã‹ã®å…‰ãŒè¦‹ãˆã‚‹ã",expression:"a"},{speaker:"ã ã„ã¡ã€ã“ã†ãŸã‚ã†ã€ã²ã‚ã‹ãšã€ãªãŠã",character:"daichi,koutarou,hirokazu,naoki",text:"ï¼Ÿï¼Ÿï¼Ÿ",expression:"b"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ã‚ã‚Œã¯ã€ã€ã€ã€ã€ã€ã€",expression:"b"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ã‚³ã‚¤ãƒ³ãƒ©ãƒ³ãƒ‰ãƒªãƒ¼ã ã€ã€ã‚³ã‚¤ãƒ³ãƒ©ãƒ³ãƒ‰ãƒªãƒ¼ãŒã‚ã£ãŸãï¼ï¼ï¼ï¼ï¼",expression:"a"},{speaker:"ã ã„ã¡",character:"daichi",text:"æš–ãŒã¨ã‚Œã‚‹ã‹ã‚‚ã—ã‚Œãªã„",expression:"a"},{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:"ã¨ã‚Šã‚ãˆãšã€ã‚ãã“ã¾ã§ã‹ã‚“ã°ã‚‹ã",expression:"a"},{speaker:"ã²ã‚ã‹ãšã€ãªãŠã",character:"hirokazu,naoki",text:"ã¯ãã€ã€ã€ã¯ãã€ã€",expression:"c"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ã‚ã¨ã€ã¡ã‚‡ã£ã¨ã®è¾›æŠ±ã ã€é ‘å¼µã‚Œï¼ï¼ï¼ï¼",expression:"a"},{speaker:"ãƒŠãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³",character:"narrator",text:"ãƒ»ãƒ»ãƒ»",expression:"a"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ã‚ˆã‹ã£ãŸã€ã‚³ã‚¤ãƒ³ãƒ©ãƒ³ãƒ‰ãƒªãƒ¼ã«ã¤ã„ãŸã€é–‹ã„ã¦ã„ã‚‹ã¿ãŸã„ã ãª",expression:"a"},{speaker:"ã ã„ã¡",character:"daichi",text:"ã“ã‚Œã§ã€æš–ãŒå–ã‚Œã‚‹",expression:"a"},{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:"ã¨ã‚Šã‚ãˆãšã€å°‘ã—ä¼‘æ†©ã—ã‚ˆã†",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã‚‚ã†ã ã‚ã‹ã¨æ€ã£ãŸ",expression:"b"},{speaker:"ãªãŠã",character:"naoki",text:"é£²ã¿ç‰©ã‚’è²·ãŠã†",expression:"a"},{speaker:"ã‹ãªã¨",character:"kanato",text:"è½ã¡ç€ã„ãŸã‚‰ã€ã„ãã‹ã€ã€ã€",expression:"b"},{speaker:"ãƒŠãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³",character:"narrator",text:"ï¼—æ™‚é–“å¾Œ",expression:"a"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ã¿ã€ã€ã€è¦‹ãˆãŸãã€ã“ã‚Œã¯ã€ã€",expression:"a"},{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:"ä¸‰é‡ç”ºã ã€ã€ã€ã€",expression:"a"},{speaker:"ã ã„ã¡",character:"daichi",text:"ã‚„ã£ãŸãã€ã€ã€ã‚„ã£ãŸãã€ã€ã€",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã†ãŠãŠãŠãŠãŠãŠãŠ",expression:"a"},{speaker:"ãªãŠã",character:"naoki",text:"ã‚ˆã‹ã£ãŸã€ã€ã€ã‚ˆã‹ã£ãŸã€ã€ã€",expression:"a"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ã‚ã¨ã€ã‚‚ã†ä¸€æ¯ã ",expression:"a"},{speaker:"ãƒŠãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³",character:"narrator",text:"ï¼˜æ™‚é–“å¾Œ",expression:"a"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ãªã‚“ã‹ã€ã€ã€æ—¥ãŒæ˜‡ã£ã¦ããŸãª",expression:"a"},{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:"ãã‚Œã„ã ã£ãŸã€æ˜Ÿã€…ã‚‚ã¿ãˆãªããªã£ãŸ",expression:"a"},{speaker:"ã ã„ã¡",character:"daichi",text:"å¯’ã•ã‚‚å‡ãˆã‚‹ã»ã©ã§ã¯ãªããªã£ã¦ããŸãª",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"æ—¥ã®å…‰ã‚’ã“ã‚Œã»ã©ã€ã‚ã‚ŠãŒãŸã„ã¨æ€ã†ã¨ã¯ã€ã€ã€",expression:"a"},{speaker:"ãªãŠã",character:"naoki",text:"ã‚„ã‚Šã¨ã’ãŸã‚“ã ãªã€ã€ã€ãŠã‚ŒãŸã¡ã€ã€ã€",expression:"a"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ã‚‚ã—ã‹ã—ã¦ã€ã‚‚ã†å°‘ã—ã—ãŸã‚‰ã€ã‚¸ãƒ§ã‚¤ãƒ•ãƒ«ãŒé–‹ã„ã¦ã„ã‚‹ã‚“ã˜ã‚ƒãªã„ã®ã‹ï¼Ÿ",expression:"a"},{speaker:"ã ã„ã¡",character:"daichi",text:"æœã”é£¯é£Ÿã¹ã‚‹ã‹ã€ã€",expression:"a"},{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:"ãã†ã ãªã€ã€ã€",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã›ã£ã‹ãã ã—è¡Œãã‹ã€ã€ã€ã€",expression:"a"},{speaker:"ãªãŠã",character:"naoki",text:"ã†ã‚“ã€ã€ã€ã€",expression:"a"},{speaker:"ãƒŠãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³",character:"narrator",text:"ã‚¸ãƒ§ã‚¤ãƒ•ãƒ«åˆ°ç€",expression:"a"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ãªã‚“ã‹ã€æ¶™å‡ºã¦ããŸ",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã“ã‚“ãªã«ã†ã¾ã„ã€ã‚¸ãƒ§ã‚¤ãƒ•ãƒ«ã¯åˆã‚ã¦ã ã€ã€",expression:"a"},{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:"é”æˆæ„ŸãŒã‚„ã°ã„ãª",expression:"a"},{speaker:"ãªãŠã",character:"naoki",text:"ä¿ºãŸã¡ç”Ÿãã¦ãŸã‚“ã ãªã€ã€ã€",expression:"a"},{speaker:"å…¨å“¡",character:"all",text:"ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»",expression:"c"},{speaker:"ã ã„ã¡",character:"daichi",text:"ã¨ã“ã‚ã§ã€ã“ã“ã¾ã§çµæ§‹æ­©ã„ã¦å¸°ã‚‹ã®ã«ãŠé‡‘ä½¿ã£ã¦ããŸã‘ã©",expression:"b"},{speaker:"ã ã„ã¡",character:"daichi",text:"ãŠé…’ã¨ã‹ã€è‡ªå‹•è²©å£²æ©Ÿã§æ¸©ã‹ã„é£²ã¿ç‰©ã¨ã‹ã€ã‚¸ãƒ§ã‚¤ãƒ•ãƒ«ã¨ã‹ã§ã€ã€ã€",expression:"b"},{speaker:"ã ã„ã¡",character:"daichi",text:"ã‚¿ã‚¯ã‚·ãƒ¼ä»£ã‚’å‰²ã‚Šå‹˜ã—ãŸã¨ãã®é‡‘é¡ã¨å¤‰ã‚ã‚‰ãªã„ã£ã¦ã“ã¨ã¯ãªã„ã‚ˆãªã€ã€ã€",expression:"b"},{speaker:"å…¨å“¡",character:"all",text:"ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»",expression:"c"},{speaker:"ã‹ãªã¨",character:"kanato",text:"é‡æš®ãªã“ã¨ã‚’è€ƒãˆã‚‹ã®ã¯ã‚ˆãã†ãœã€ã€ã€",expression:"b"},{speaker:"ãªãŠã",character:"naoki",text:"ç„¡äº‹å¸°ã‚ŒãŸã‚“ã ã‹ã‚‰ãªã€ã€ã€",expression:"a"},{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:"ãã†ã ãª",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã†ã€ã€ã€ã‚€ã€ã€ã€",expression:"b"},{speaker:"ã ã„ã¡",character:"daichi",text:"ã‚ã‚‹ã„ã€å¿˜ã‚Œã¦ãã‚Œ",expression:"b"},{speaker:"ãƒŠãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³",character:"narrator",text:"ã‚„ã£ã±ã‚Šã€æ­©ã„ã¦å¸°ã£ãŸã»ã†ãŒã€é«˜ãã¤ã„ãŸã®ã¯çŸ¥ã‚‰ãªã„ã»ã†ãŒã‚ˆã‹ã£ãŸè©±",expression:"a"}]}};class r{constructor(){this.conversations=s,this.currentEvent=null,this.resourceManager=null}setResourceManager(e){this.resourceManager=e}async loadMap(e="taketa"){if(!this.resourceManager)throw new Error("ResourceManager not set");try{return console.log(`ç«¹ç”°ãƒãƒƒãƒ—ã€Œ${e}ã€ã‚’èª­ã¿è¾¼ã¿ä¸­...`),await this.resourceManager.loadMapResources(e),console.log(`ç«¹ç”°ãƒãƒƒãƒ—ã€Œ${e}ã€ã®èª­ã¿è¾¼ã¿å®Œäº†`),!0}catch(e){throw console.error("ãƒãƒƒãƒ—èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:",e),e}}getConversation(e){return this.conversations[e]||null}getAvailableEvents(){return Object.keys(this.conversations)}async startEvent(e){if(!this.resourceManager)throw new Error("ResourceManager not set");try{return await this.resourceManager.loadEventResources(e,this.conversations),this.currentEvent=e,!0}catch(e){throw console.error("Failed to start event:",e),e}}endEvent(){this.resourceManager&&this.resourceManager.unloadResources(),this.currentEvent=null}addConversation(e,t){this.conversations[e]=t}updateConversation(e,t){return!!this.conversations[e]&&(this.conversations[e]=t,!0)}}},362:(e,t,a)=>{a.r(t),a.d(t,{MiemachiConversationManager:()=>r,miemachiConversationData:()=>s});const s={oreno_koto:{background:"orenokoto",bgm:"Fantasy",conversations:[{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ä¿ºã®ã“ã¨ã«ã¤ã„ã¦ã¯ãªã™ãœâ˜†",expression:"g"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ç”Ÿã¾ã‚ŒãŸæ™‚é–“ã¯ï¼‘ï¼™ï¼™ï¼–å¹´ï¼™æœˆï¼’ï¼™å¹´æ—¥æ›œæ—¥ã§æ™´ã‚Œã®æ—¥ã ãœâ˜†",expression:"g"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ç”Ÿã¾ã‚ŒãŸç—…é™¢ã¯ä½è—¤ç”£å©¦äººç§‘ã§ã†ã¾ã‚ŒãŸãœ",expression:"g"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"åå‰ã®ç”±æ¥ã¯ã€Œå¯›ã€ã®å­—ã¯çˆ¶è¦ªãŒæ°—ã«å…¥ã£ã¦ãŸå­—ã§ã€å’Œã¯æ¯ã•ã‚“ã‹ã‚‰å–ã£ãŸãœ",expression:"g"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"å‡ºç”£ã¯äºˆå®šæ—¥ã‹ã‚‰ï¼‘ï¼™æ—¥å‰ã«ï¼’ï¼–ï¼”ï¼˜gã§ç”Ÿã¾ã‚ŒãŸãœâ˜†",expression:"g"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"è¡€æ¶²å‹ã¯ABå‹ã ãœâ˜†",expression:"g"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"å®‰ç”£ã ã£ãŸã‚‰ã—ã„ãœ",expression:"g"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ç”Ÿã¾ã‚ŒãŸæ™‚é«ªã®æ¯›ã¯æ¯”è¼ƒçš„å¤šã‹ã£ãŸãœ",expression:"g"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ç”Ÿã¾ã‚ŒãŸã¨ãã®ç¬¬ä¸€å£°ãŒã€Œã‚ªã‚®ãƒ£ãƒ¼ã€ã ãœ",expression:"g"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"æœ€å¾Œã«ä¿ºã®è‡ªä¿¡ä½œã®æ¼«ç”»ã‚’ç´¹ä»‹ã™ã‚‹ãœ",expression:"g"},{speaker:"è‡ªä¿¡ä½œã®æ¼«ç”»",character:"mannga",expression:"a"},{speaker:"è‡ªä¿¡ä½œã®æ¼«ç”»",character:"mannga",expression:"b"},{speaker:"è‡ªä¿¡ä½œã®æ¼«ç”»",character:"mannga",expression:"c"},{speaker:"è‡ªä¿¡ä½œã®æ¼«ç”»",character:"mannga",expression:"d"},{speaker:"è‡ªä¿¡ä½œã®æ¼«ç”»",character:"mannga",expression:"e"},{speaker:"è‡ªä¿¡ä½œã®æ¼«ç”»",character:"mannga",expression:"f"}]},raizu:{background:"raizu",bgm:"metoroido",conversations:[{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"æ˜”ã•ãã€ã€ã€ãƒ©ã‚¤ã‚ºã£ã¦ã„ã†ã‚„ã°äººãŒã„ãŸå¡¾ã‚ã£ãŸã˜ã‚ƒã‚“ã€ä»Šã©ã‚“ãªæ„Ÿã˜ï¼Ÿ",expression:"e"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ã©ã†ã‚‚ã“ã†ã‚‚ã€ã¾ã ã‚„ã£ã¦ã‚‹ã‚ˆã­ï¼Ÿ",expression:"c"},{speaker:"ã ã„ã¡",character:"daichi",text:"ã‚„ã£ã¦ã‚‹ãªã€ãã®å¡¾ã¯ã¾ã ã‚„ã£ã¦ã‚‹ã€ä»Šã¯ãƒ©ã‚¤ã‚ºï¼‘ã¨ã‹ã„ã†åå‰ã§ã‚„ã£ã¦ã‚‹ã‘ã©",expression:"e"},{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:"ãªã¤ã„ãªã€ã€ã€å…ƒæ°—ã‹ãªï¼Ÿ",expression:"a"},{speaker:"ã‹ãªã¨",character:"koutarou",text:"ã‚ã‚ã€ä¸€æ—¥ï¼’ç®±ã‚­ãƒ¡ã¦ã‚‹ã€ãƒ˜ãƒ“ãƒ¼ã‚¹ãƒ¢ãƒ¼ã‚«ãƒ¼ã®ã‚„ã°äººãª",expression:"c"},{speaker:"ãªãŠã",character:"naoki",text:"ã¾ã ã€å…ƒæ°—ãªã‚“ã ã‚ã‹",expression:"c"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ã¡ã‚‡ã£ã¨ã€ä»Šåº¦ç¢ºèªã—ã¦ãã‚‹ã‚",expression:"c"},{character:"narrator",text:"æ•°æ—¥å¾Œ",expression:"a"},{speaker:"ã‚„ã°ã˜ã‚“",character:"yabajinn",text:"ãŠã‚‰ãããï¼ï¼ï¼ï¼ï¼",expression:"a"},{speaker:"ãªãŠã",character:"naoki",text:"ã§ãŸãª",expression:"c"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ã§ãŸãª",expression:"c"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ãªã‚“ã‹ã€å®‰å¿ƒã—ãŸã‚",expression:"c"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ã‹ã‚ã‚‰ãªã„ã€è‰¯ã•ã¨ã„ã†ã‚‚ã®ãŒã‚ã‚‹ãª",expression:"c"},{speaker:"ãªãŠã",character:"naoki",text:"ãƒ©ã‚¤ã‚ºã ãªãƒ¼",expression:"c"}]},souce:{background:"souce",bgm:"nightbarth",conversations:[{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ãŠç›†ã§æš‡ã ãªã€å–œä¹…ã§ã¡ã‚‡ã£ã¨é£²ã‚‚ã†ã‹",expression:"e"},{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:"ã¾ãã€ãˆãˆã‚ˆã€ã›ã£ã‹ããã‚ã£ãŸã—ãª",expression:"a"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ãˆãƒ¼ã¨ã€ã­ã€ã‚ã®ã€ã†ãƒ¼ã‚“ã€ãˆã£ã¨ã­",expression:"c"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã©ã—ãŸï¼Ÿï¼Ÿ",expression:"e"},{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:"ï¼Ÿï¼Ÿ",expression:"a"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ãŠã‚Œã‚‰ã€å®Ÿã¯å–œä¹…ã€å‡ºç¦ã«ãªã£ãŸã‚“ã‚ˆã­ã€ã€",expression:"c"},{speaker:"ã²ã‚ã‹ãšã€ã“ã†ãŸã‚ã†",character:"hirokazu",text:"ï¼ï¼Ÿ",expression:"e"},{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:"ã‚“ï¼Ÿã©ã†ã„ã†ã“ã¨ï¼Ÿ",expression:"a"},{speaker:"ã²ã‚ã‹ãšã€ã“ã†ãŸã‚ã†",character:"hirokazu",text:"ã¾ã£ãŸãã€ãŠã‚Œã‚‰å¿ƒå½“ãŸã‚Šã¯ãªã„ã‚“ã ãŒï¼Ÿ",expression:"e"},{speaker:"ã ã„ã¡",character:"daichi",text:"ã„ã‚„ã€èª¬æ˜ã™ã‚‹ã¨ã€ã“ã®å‰ã€ã€Œã‹ãªã¨ã€ä¿ºã€ãªãŠãã€ãã®ä»–ã®ãƒ¡ãƒ³ãƒãƒ¼ã§é£²ã¿ã«è¡Œã£ãŸã‚“ã‚„ã‘ã©ã€",expression:"e"},{speaker:"ã ã„ã¡",character:"daichi",text:"ãã®æ™‚ã«æ¥ãŸã€æ—¥æœ¬é…’ã®ãŠé…’ã®ä¸­ã«ãªãœã‹æ—¥æœ¬é…’ã¨é†¤æ²¹ãŒæ··ã–ã£ã¦ãŸã‚“ã‚ˆ",expression:"e"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ã‚‚ã¡ã‚ã‚“ã€ä¿ºã‚‰ãŒã„ã‚ŒãŸã‚ã‘ã§ã¯ãªã„ã‚ˆ",expression:"c"},{speaker:"ã ã„ã¡",character:"daichi",text:"ã§ã€ä¿ºã‚‰ã‚‚ã•ã™ãŒã«é£²ã‚ãªã„ã‹ã‚‰ã€ä½•ã‚‚ã„ã‚ãšã«ãƒ†ãƒ¼ãƒ–ãƒ«ã®ä¸Šã«ãŠã„ã¦å¸°ã£ãŸã‚“ã ã‘ã©",expression:"e"},{speaker:"ã ã„ã¡",character:"daichi",text:"ãã‚Œã‚’ã€ä¿ºã‚‰ãŒã„ãŸãšã‚‰ã§å…¥ã‚ŒãŸã£ã¦è©±ã«ãªã£ã¦å†¤ç½ªã§å‡ºç¦ã«ãªã‚Šã¾ã—ãŸã€‚",expression:"e"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ä¸€å¿œã€æ¬¡ã®æ—¥ã«è¬ã‚Šã«ã„ã£ãŸã‘ã©é–€å‰æ‰•ã„ã‚’é£Ÿã‚‰ã„ã¾ã—ãŸã€‚",expression:"c"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ã¶ã£ã¡ã‚ƒã‘ã€ä¿ºã‚‰ä½•ã‚‚æ‚ªã„ã“ã¨ã—ã¦ãªã„ã‹ã‚‰ä½•ã‚’åçœã—ã¦ã„ã„ã®ã‹ã‚ã‹ã‚‰ã‚“ã‹ã£ãŸã‘ã©",expression:"b"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ä¿ºã¨ã“ã†ãŸã‚ã†ã¯ã¨ã°ã£ã¡ã‚Šã™ãã‚“ï¼Ÿ",expression:"b"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ã„ã‚„ã€ã€ã€ã€ã¾ã",expression:"c"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ãã†",expression:"c"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ãªã‚“ã§ã ã‚ˆã€ã€",expression:"d"},{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:"é£›ã³ç«ã™ãã‚‹ã‚",expression:"e"},{speaker:"ã ã„ã¡",character:"daichi",text:"ï½—ï½—ï½—ï½—ï½—ï½—ï½—ï½—ï½—ï½—ï½—",expression:"f"},{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:"ã©ã†ã™ã‚“ã ã‚ˆã€ã€ã€ã©ã“ã§ã®ã‚€ã‚ˆ",expression:"g"},{speaker:"ãªãŠã",character:"naoki",text:"ã€Œã‹ãã‚Œã‚“ã¼ã€ã€ãªã‚‰ã„ã‘ã‚‹ã¨ãŠã‚‚ã†ã",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã‹ãã‚Œã‚“ã¼ã«ã™ã‚‹ã‹ã€ã€ã€",expression:"l"},{speaker:"ãªãŠã",character:"naoki",text:"ã¡ã‚‡ã†ã©ã€æ”¹è£…ã—ã¦ã„ã‚‹ã‹ã‚‰è¡Œã‘ã‚‹ã‹ã©ã†ã‹ã€ã€",expression:"c"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã¾ãã€ã‚ãã“ã¯ã„ã‘ã‚‹ã‚„ã‚ã€ã‚ãã“ã¯ã€ãªã‚“ã‹çŸ¥ã‚‰ã‚“ã‘ã©ã„ã¤ã‚‚ç©ºã„ã¦ã‚‹ã‚„ã‚“",expression:"l"},{speaker:"ãªãŠã",character:"naoki",text:"ãŸã—ã‹ã«ãƒã€ã€",expression:"b"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ãˆã£ã¨ã€ã©ã†ã™ã‚‹ï¼Ÿ",expression:"l"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ä½•ãŒï¼Ÿ",expression:"d"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã‚‚ã†ã€ãŠã‚Œã‚‰ã®ã‚°ãƒ«ãƒ¼ãƒ—åã—ã‚‡ã†ã‚†ã«ã™ã‚‹ã‹",expression:"l"},{speaker:"ã ã„ã¡",character:"daichi",text:"ã€ã€ã€ã™ã‚‹ã‹ã€ã€ã€ã€é†¤æ²¹ã«",expression:"b"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ã˜ã‚ƒã‚ã€ï¼¬ï¼©ï¼®ï¼¥ã®ã‚°ãƒ«ãƒ¼ãƒ—åã¯é†¤æ²¹ã«ã—ã¨ãã¾ã™",expression:"d"},{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:"é†¤æ²¹ã‹ã€ã€ã€ã€ã€ãŠã‚Œã¯é–¢ä¿‚ãªã„ã‘ã©",expression:"c"},{speaker:"ã ã„ã¡",character:"daichi",text:"æ±ºå®šã ",expression:"a"},{character:"line_group_syouyu",text:"ã“ã†ã—ã¦ã€lineã‚°ãƒ«ãƒ¼ãƒ—ã¯ã—ã‚‡ã†ã‚†ã«ãªã£ãŸã€‚",expression:"a"}]},seven:{background:"seven",bgm:"Last_Summer_In_Rio",conversations:[{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"å¸°ã‚‹ã‹ã€ã€ã€",expression:"e"},{speaker:"ã ã„ã¡",character:"daichi",text:"ã©ã†ã‚„ã£ã¦å¸°ã‚Šã¾ã™ï¼Ÿ",expression:"e"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã‚“ï¼Ÿï¼Ÿãã‚Šã‚ƒã€ã‚¿ã‚¯ã‚·ãƒ¼ã§ã€ã€",expression:"e"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ã‚¿ã‚¯ã‚·ãƒ¼ï¼Ÿ",expression:"c"},{speaker:"ãªãŠã",character:"naoki",text:"ä¸‰é‡ç”ºã«ãã‚“ãªä¾¿åˆ©ãªç‰©ãªã„ã",expression:"c"},{speaker:"ã ã„ã¡",character:"daichi",se:"dededon",text:"ã‚ã£ï¼ï¼ï¼",expression:"e"},{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:"ä¸‰é‡ç”ºã«ã¯ãã‚“ãªã‚‚ã®ãªã„ãã€ã“ã‚“ãªæ™‚é–“ã¯",expression:"a"},{speaker:"ãªãŠã",character:"naoki",text:"æ®‹å¿µã ã£ãŸãªï½—",expression:"c"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"æ­©ã„ã¦å¸°ã‚‹ã®ã‹ã€ã€ã€",expression:"e"},{speaker:"ã ã„ã¡",character:"daichi",text:"ä¸‰é‡ç”ºã ã‹ã‚‰ãªã€ã€ã€",expression:"e"},{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:"ä»•æ–¹ãªã„ã¤ãã‚ã£ã¦ã‚„ã‚‹ã‹",expression:"a"},{speaker:"ã‹ãªã¨,ãªãŠã",character:"kanato",text:"ã¯ã˜ã¾ã£ãŸã€ã€åå¯¾æ–¹å‘ãªã®ã«ã€ã€ã€",expression:"c"},{speaker:"ãƒŠãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³",character:"narrator",text:"ç§»å‹•ä¸­",expression:"a"},{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:"ã€ã€ã€ã€ã€",expression:"N"},{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:"ã€ã€ã€ã€ã€ãŠã‚Œçµå©šã™ã‚‹ã‚“ã ã‚ˆãªã€ã€ã€",expression:"N"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã‚“ï¼Ÿï¼Ÿ",expression:"e"},{speaker:"ã ã„ã¡",character:"daichi",text:"ãŠã£ã¨ã€ã€ã€ãªã‚“ã‹è¨€ã£ãŸï¼Ÿ",expression:"e"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ãªã‚“ã‹ã€èã“ãˆãŸãª",expression:"c"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ãŠã„ã€ã‚„ã£ã±ã‚ŠãŠã£ã±ã„ã‹ã€ãŠã£ã±ã„ãªã‚“ã ãªã€å«ã•ã‚“ãŠã£ã±ã„å¤§ãã„ã£ã¦è¨€ã£ã¦ãŸã‚‚ã‚“ãªï¼",expression:"e"},{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:"ã‚“ã€ã€ã€ã€ã€ï¼Ÿ",expression:"a"},{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:"ãã†",expression:"a"},{speaker:"ãªãŠã",character:"naoki",text:"ãŠã‚‰ãããï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼",expression:"c"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ãˆã£ã¨ã€ã©ã†ã™ã‚‹ï¼Ÿå‡¦ã™ã‹ï¼Ÿ",expression:"e"},{speaker:"ã ã„ã¡",character:"daichi",text:"å‡¦ã—ã¾ã™",expression:"e"},{speaker:"ã‹ãªã¨",character:"kanato",text:"æ‹·å•ã—ã¦ã€ã€ã€ã€æ­»åˆ‘ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼",expression:"c"},{speaker:"ãªãŠã",character:"naoki",text:"è³›æˆã§ã™",expression:"c"},{speaker:"ã ã„ã¡",character:"daichi",text:"ã‚†ã‚‹ã•ã‚“ãï¼ï¼ï¼",expression:"e"},{speaker:"ãƒŠãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³",character:"narrator",text:"ãƒ¼ï¼’å¹´å¾Œãƒ¼",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ãŠã‚Œã€çµå©šã™ã‚‹ã‚“ã ã‚ˆãªã€ã€ã€",expression:"e"},{speaker:"ã‹ãªã¨ã€ãªãŠã",character:"kanato",text:"ã¯ã„ã€æ­»åˆ‘",expression:"c,c"}]},Weeds_burn:{background:"Fire",bgm:"metoroido",conversations:[{speaker:"ã ã„ã¡å°‘å¹´",character:"daichi_young",text:"ç«éŠã³ã—ãŸã„ãª",expression:"a"},{speaker:"ã²ã‚ã‹ãšå°‘å¹´",character:"hirokazu_young",text:"ã“ã‚Œã‚’ä½¿ãˆã°ã€ç«éŠã³ã§ãã‚‹ã‚ˆ",expression:"g"},{speaker:"ã ã„ã¡å°‘å¹´",character:"daichi_young",text:"ã‚ˆã—ï¼ã„ã‘ï¼",expression:"c"},{speaker:"ã²ã‚ã‹ãšå°‘å¹´",character:"hirokazu_young",text:"ã„ã‚„ã€ã¾ã¦ã•ã™ãŒã«ã“ã“ã§ã¯å‘¨ã‚Šã«ç«ãŒä»˜ããã†ãªã‚‚ã®ãŒãŠãŠã„",expression:"g"},{speaker:"ã²ã‚ã‹ãšå°‘å¹´",character:"hirokazu_young",text:"ãªã®ã§ã€è·é›¢ã‚’ãŠã„ã¦ç«ã‚’ã¤ã‘ã‚ˆã†",expression:"g"},{speaker:"ã ã„ã¡å°‘å¹´",character:"daichi_young",text:"ã“ã“ãªã‚‰å¤§ä¸ˆå¤«ã ã‚ã€ã“ã®å·ã®åˆ¥ã‚Œã¦ã€é™¸ã¿ãŸã„ã«ãªã£ã¦ã‚‹ã¨ã“ï¼ï¼ï¼",expression:"c"},{speaker:"ã ã„ã¡å°‘å¹´",character:"daichi_young",text:"æ–°å¤§é™¸ã ï¼ï¼ï¼ï¼",expression:"c"},{speaker:"ã²ã‚ã‹ãšå°‘å¹´",character:"hirokazu_young",text:"ã“ã“ãªã‚‰ã„ã‘ã‚‹ï¼ï¼ï¼ï¼",expression:"g"},{speaker:"ã ã„ã¡å°‘å¹´",character:"daichi_young",text:"ã‚ˆã—ã€ã‚„ã‚‹ã‚“ã ï¼ï¼ï¼",expression:"c"},{speaker:"ãƒŠãƒ¬ãƒ¼ã‚¿ãƒ¼",character:"narrator",se:"sei_ge_matti_tukeru01",expression:"a"},{speaker:"ãƒŠãƒ¬ãƒ¼ã‚¿ãƒ¼",character:"narrator",text:"ãƒ‘ãƒãƒ‘ãƒã£ã€ã€ã€",se:"takibi_tan",expression:"a"},{speaker:"ãƒ€ã‚¤ãƒå°‘å¹´",character:"daichi_young",text:"ç«ã¤ã„ãŸãªã€ã€ã€",expression:"d"},{speaker:"ã²ã‚ã‹ãšå°‘å¹´",character:"hirokazu_young",text:"ãŠãŠã£ã€ã€ã‚ãŸãŸã‘ã‡ã€ã€ã€",expression:"b"},{speaker:"ãƒ€ã‚¤ãƒå°‘å¹´",character:"daichi_young",text:"ãˆãˆãªã€ã€ã€ã€",expression:"e"},{speaker:"ãƒŠãƒ¬ãƒ¼ã‚¿ãƒ¼",character:"narrator",text:"ã³ã‚…ã…ã…ã…ã…ã€ã€ã€‚",se:"wind2",expression:"a"},{speaker:"ãƒ€ã‚¤ãƒå°‘å¹´",character:"daichi_young",text:"ãªã‚“ã‹é¢¨ãŒã€ã€ã€ãªãã€ã€ã€ï¼ï¼Ÿï¼ï¼Ÿï¼ï¼ï¼ï¼ï¼ï¼Ÿï¼ï¼Ÿï¼ï¼Ÿ",expression:"e"},{speaker:"ãƒ€ã‚¤ãƒå°‘å¹´",character:"daichi_young",text:"ã‚‚ãˆãŸã€ç‰©ãŒã€ã€ã€ã€ã€é¢¨ã«é£›ã‚“ã§ã€ã€",expression:"e"},{speaker:"ãƒ€ã‚¤ãƒå°‘å¹´ã€ã²ã‚ã‹ãšå°‘å¹´",character:"daichi_young",text:"ã‚ã£ã£ã£ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼",se:"takibi_tan",background:"moeru",expression:"g,g"},{speaker:"ãƒ€ã‚¤ãƒå°‘å¹´",character:"daichi_young",text:"ãˆã£ã¨ã€ãªã‚“ã‹ã‚„ã°ãã­",expression:"g"},{speaker:"ãƒ€ã‚¤ãƒå°‘å¹´",character:"daichi_young",text:"ã‚„ã°ãã­ï¼Ÿãªã‚“ã‹ã‚„ã°ãã­ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿ",expression:"g"},{speaker:"ã²ã‚ã‹ãšå°‘å¹´",character:"hirokazu_young",text:"ã€ã€ã€ã€ã€ã‘ã›ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ï¼ã€æ°´ã‹ã‘ã‚ï¼ï¼ï¼ï¼",expression:"g"},{speaker:"ãƒ€ã‚¤ãƒå°‘å¹´",character:"daichi_young",text:"ã¾ãšã„ã¾ãšã„ã¾ãšã„ã¾ãšã„ã¾ãšã„ã¾ãšã„ã¾ãšã„ã¾ãšã„ï¼ï¼ï¼ï¼ï¼ï¼ï¼",expression:"I"},{speaker:"ã²ã‚ã‹ãšå°‘å¹´",character:"hirokazu_young",text:"ã¿ã£ã€ã€ã€æ°´ã‚’ã‹ã‘ã‚‹ã‚“ã ï¼ï¼ï¼ã¯ã‚„ãï¼ï¼ï¼ï¼",expression:"g"},{speaker:"ãƒ€ã‚¤ãƒå°‘å¹´",character:"daichi_young",text:"ãƒ€ãƒ¡ã ï¼ï¼ï¼ï¼ï¼ç«ã®å‹¢ã„ãŒå¼·ã„",expression:"K"},{speaker:"ã²ã‚ã‹ãšå°‘å¹´",character:"daichi_young",text:"ã¤ã£ã£ã¤ã¡ï¼ï¼ï¼ï¼",expression:"g"},{speaker:"ã²ã‚ã‹ãšå°‘å¹´",character:"daichi_young",text:"åœŸã‚’ãªã’ã‚ã‰ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ï¼ï¼ï¼ï¼ï¼",expression:"g"},{speaker:"ãƒ€ã‚¤ãƒå°‘å¹´",character:"daichi_young",text:"æ³¥ã—ã‹ãªã„ã§ã™ï¼ï¼ï¼",expression:"K"},{speaker:"ãƒ€ã‚¤ãƒå°‘å¹´",character:"daichi_young",text:"ãªã‚“ã§ã‚‚ã„ã„ã‹ã‚‰ã€ãªã’ã‚ã‰ã‰ãŠã‰ï¼ï¼ï¼",expression:"K"},{speaker:"ãƒ€ã‚¤ãƒå°‘å¹´",character:"daichi_young",text:"ç«ãŒãããï¼ã¤ã‚ˆã„ï¼ï¼ï¼",expression:"K"},{speaker:"ã²ã‚ã‹ãšå°‘å¹´",character:"hirokazu_young",text:"ã‚ãã‚‰ã‚ã‚‹ãªï¼ï¼ï¼æ—©ãã‘ã›ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ï¼ï¼ï¼",expression:"g"},{text:"ï¼“ï¼åˆ†å¾Œ",expression:"a"},{speaker:"ãƒ€ã‚¤ãƒå°‘å¹´",character:"daichi_young",text:"ã‚„ã£ãŸã‹ï¼Ÿã€ã€ã€",expression:"M"},{speaker:"ãƒŠãƒ¬ãƒ¼ã‚¿ãƒ¼",character:"narrator",se:"sei_ge_matti_tukeru01",expression:"a"},{speaker:"ã²ã‚ã‹ãšå°‘å¹´",character:"hirokazu_young",text:"æ—©ãã‘ã›ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ï¼ï¼ï¼",expression:"g"},{speaker:"ãƒŠãƒ¬ãƒ¼ã‚¿ãƒ¼",character:"narrator",text:"ã€ã€ã€",se:"sei_ge_matti_tukeru01",expression:"a"},{speaker:"ãƒŠãƒ¬ãƒ¼ã‚¿ãƒ¼",character:"narrator",text:"ã€ã€ã€ã€ã€",expression:"a"},{speaker:"ãƒŠãƒ¬ãƒ¼ã‚¿ãƒ¼",character:"narrator",text:"ã€ã€ã€ã€ã€ã€ã€ã€ã€ã€ã€ã€",expression:"a"},{speaker:"ãƒ€ã‚¤ãƒå°‘å¹´",character:"daichi_young",text:"ãªã£ã€ã€ã€ä½•ã¨ã‹ããˆãŸãã€ã€ã€ã€",background:"moeato",expression:"M"},{speaker:"ã²ã‚ã‹ãšå°‘å¹´",character:"hirokazu_young",text:"ã‚„ã°ã‹ã£ãŸã€ç„¦ã£ãŸã‚ã€ã€ã€ã€ã€",expression:"g"}]},koutaroupoteto:{background:"koutaroupoteto",bgm:"Nagisa_Moderato",conversations:[{speaker:"ã ã„ã¡",character:"daichi",text:"ã“ã“ã®ãƒãƒ†ãƒˆã†ã¾ã„ãªã€ã€",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã“ã“ã¯ä¸‰é‡ç”ºã§æœ‰åãªãƒãƒ†ãƒˆå±‹ã§ã™ã‚ˆ",expression:"a"},{speaker:"ã ã„ã¡",character:"daichi",text:"ï¼‘ï¼ï¼å††ã§ã€ã“ã®é‡ã¯ãŠå¾—ã§ã†ã¾ã„ãª",expression:"a"},{speaker:"ã ã„ã¡",character:"daichi",text:"ã¾ãã€ã„ã„ã‘ã©ã€ä¸€é€±é–“ãšã£ã¨ã€æ¥ã¦ã‚‹ã‚„ã‚“ã€ã€ã€",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã†ã¾ã„ã‹ã‚‰ã„ã„ã‚“ã ã‚ˆ",expression:"a"},{speaker:"ã ã„ã¡",character:"daichi",text:"ã‚ã£ã€ã€ã€ã¯ã„",expression:"a"}]},antares:{background:"test_1",bgm:"Nagisa_Moderato",conversations:[{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ãƒã‚¹é‡£ã‚Šã£ã¦ãŠã‚‚ã—ã‚ã„ãªã€ã€ã€ãƒªãƒ¼ãƒ«ãŒã»ã—ã„ã€ã€ã€",expression:"a"},{speaker:"ã ã„ã¡",character:"daichi",text:"ã‚„ã£ã±ã€é‡£ã‚Šé“å…·ã£ã¦ã‹ã£ã¡ã‚‡ã„ã„ã‚ˆãª",expression:"b"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã‚¢ãƒ³ã‚¿ãƒ¬ã‚¹æ¬²ã—ã„ãªã€ã€ã€ã‚ã¨ã€ãƒ«ã‚¢ãƒ¼ã‚‚",expression:"c"},{speaker:"ã ã„ã¡",character:"daichi",text:"ã¨ã‚Šã‚ãˆãšã€å¸°ã‚Šã«ãƒã‚¹é‡£ã‚Šè¡Œããï¼ï¼",expression:"d"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ãŠã£ã—ã‚ƒã€ã„ãã‚“ã ï¼ï¼ï¼",expression:"e"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ãŠã‚‰ãããï¼ï¼ï¼ï¼ï¼",expression:"f"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã‚ã‚ã‚ã‚ã‚ã‚ã‚ã‚ã€ä¿ºã®ãƒ«ã‚¢ãƒ¼ãŒã‚ã‚ã‚ã‚ã‚ã‚ã‚",expression:"g"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ãƒ«ã‚¢ãƒ¼ã ã‘é£›ã‚“ã§ã£ãŸãã€ã€ã€ã€ã€ã€ã†ã‚ããã",expression:"h"}]},drinking_dutu:{background:"dutu",bgm:"nightbarth",conversations:[{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"æ™®é€šã®é…’é£²ã¿é£½ããŸãªãƒ¼",expression:"a"},{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:"ãƒ‰ãƒ³ã‚­ã§æ¢ã™ã‹",expression:"a"},{speaker:"ã ã„ã¡",character:"daichi",text:"ã‚ã£ï¼ã“ã‚Œã‚ˆãã­ï¼ï¼Ÿ",expression:"b"},{character:"dutu",se:"taiko_2ren"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã“ã‚Œã‚‚ã†ä¸€æ°—ã™ã‚‹ãŸã‚ã®å¤§ãã•ã˜ã‚ƒã‚“ï¼",expression:"b"},{speaker:"ã ã„ã¡",character:"daichi",text:"ä¸€æ°—ã—ã¦ãã ã•ã„ã£ã¦è¨€ã£ã¦ã‚‹ãªã‚ï¼",expression:"a"},{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:"ãã‚Œå¾¡ç¥é…’ã˜ã‚ƒã­ï¼Ÿ",expression:"c"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ãƒ‰ãƒ³ã‚­ã«ã¯ä¸€æ°—ã™ã‚‹ç”¨ã®é…’ã‚‚å£²ã£ã¦ã‚‹ã‚“ã‹ã‚ï¼",expression:"b"},{speaker:"ã ã„ã¡",character:"daichi",text:"ã˜ã‚ƒã‚1äººä¸€æœ¬ãšã¤è²·ã†ã‹ï¼",expression:"a"},{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:"ã„ã‚„1äººä¸€æœ¬ãšã¤ã®ã‚„ã¤ã‹ãã‚Œï¼Ÿ",expression:"c"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:'1äººä¸€æœ¬"ãšã¤"ã®ã‚„ã¤ã€ã„ãããŠï¼',expression:"b"},{speaker:"ã ã„ã¡",character:"daichi",text:'"ãšã¤"ï¼ã†ãŠãŠãŠï¼',expression:"b"},{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:"ã ã‹ã‚‰â€¦â€¦ã¾ã‚ã„ã„ã‹ï¼ã†ãŠãŠãŠï¼",expression:"a"},{text:"ã€ã€ã€å¤œã€ã€ã€"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ãƒ¼ãƒ¼ã•ã¦ã€å¤œã‚‚æ›´ã‘ã¦ãã¾ã—ãŸ",expression:"a"},{speaker:"ã ã„ã¡",character:"daichi",text:'"ãšã¤"ã€ã„ãã¾ã™ã‹',expression:"a"},{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:'ã‚‚ã†ãã‚Œã®åå‰"ãšã¤"ãªã‚“ã‚„',expression:"c"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã‚ˆã£ã—ã‚ƒ3äººã§åŒæ™‚ã«ã„ãããŠï¼",expression:"b"},{speaker:"ã ã„ã¡",character:"daichi",text:"ã†ãŠãŠãŠï¼",expression:"b"},{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:"ã‚‚ã†ã„ã„ã‚„ï¼ã„ãããŠï¼",expression:"c"},{speaker:"ã²ã‚ã‹ãšãƒ»ã ã„ã¡ãƒ»ã“ã†ãŸã‚ã†",character:"all",text:"ã€Œã€Œã€Œã‚´ã‚¯ã‚´ã‚¯ã‚´ãƒƒâ€¦ã‚ªãƒ­ãƒ­ãƒ­ãƒ­ãƒ­âœ¨ã€ã€ã€",expression:"c"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ãªã‚“ã ã“ã‚Œâ€¦",expression:"c"},{speaker:"ã ã„ã¡",character:"daichi",text:"ä½“ã«å…¥ã‚‰ãªã„ã§ã™",expression:"c"},{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:"èƒƒã«å½“ãŸã£ã¦ãã®ã¾ã¾è·³ã­è¿”ã£ã¦ãã‚‹",expression:"c"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã‚ªãƒ­ãƒ­ãƒ­ãƒ­ãƒ­âœ¨",expression:"c"},{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:"ã‚ªãƒ­ãƒ­ãƒ­ãƒ­ãƒ­â€¦",expression:"c"},{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:"æ­¢ã¾ã‚‰ã‚“â€¦",expression:"c"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"æœ¨ã®ä¸‹ã«åã“ã‚ªãƒ­ãƒ­ãƒ­ãƒ­ãƒ­âœ¨",expression:"c"},{speaker:"ã ã„ã¡",character:"daichi",text:"å¤§ããæˆé•·ã—ã‚ã‚ˆ",expression:"c"},{speaker:"ã ã„ã¡",character:"daichi",text:"ã‚ªãƒ­ãƒ­ãƒ­ãƒ­ãƒ­âœ¨",expression:"c"},{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:"æœ€ä½ã®æ „é¤Šã‚„â€¦",expression:"c"}]},snack_street_night:{background:"miemachimae",bgm:"nightbarth",conversations:[{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã‚ãƒ¼é£²ã‚“ã ãªãƒ¼",expression:"d"},{speaker:"ã‹ãªã¨",character:"kanato",text:"ã¾ã 21æ™‚ã‹â€¦â€¦",expression:"c"},{speaker:"ã“ã†ãŸã‚ã†",character:"koutarou",text:"2è»’ç›®ã„ãã‹",expression:"a"},{speaker:"ãªãŠã",character:"naoki",text:"ç©ºã„ã¦ã‚‹ã®ã‚¹ãƒŠãƒƒã‚¯ã—ã‹ãªã„ã‚ˆãªãƒ¼",expression:"c"},{speaker:"ã ã„ã¡",character:"daichi",text:"ä¸‰é‡ç”ºã¯ã“ã®æ™‚é–“ã‚‚ã†çœ ã£ã¦ã‚‹ã‹ã‚‰ãª",expression:"e"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã‚ˆã—ã€ã˜ã‚ƒã‚ã‚¹ãƒŠãƒƒã‚¯è¡Œããï¼",expression:"e"},{speaker:"ãƒŠãƒ¬ãƒ¼ã‚¿ãƒ¼",character:"narrator",text:"ã“ã“ã¯ä¸‰é‡ç”ºé§…å‰ã€‚æ¨å®šå¹³å‡å¹´é½¢50æ­³ã€ç„¡æ•°ã®ãƒãƒãŸã¡ãŒã²ã—ã‚ãä¸‰é‡ç”ºæœ€å¤§ã®æ­“æ¥½è¡—ã€‚",expression:"a"},{speaker:"ãƒŠãƒ¬ãƒ¼ã‚¿ãƒ¼",character:"narrator",text:"ã€ã‚¹ãƒŠãƒƒã‚¯åé‘‘ in ä¸‰é‡ç”ºã€‘",expression:"a"},{speaker:"ãƒŠãƒ¬ãƒ¼ã‚¿ãƒ¼",character:"narrator",text:"ã¾ãšã¯ã“ã“ï¼ï¼",expression:"a",se:"taiko_2ren"},{speaker:"ãƒŠãƒ¬ãƒ¼ã‚¿ãƒ¼",character:"narrator",text:"ã€ã‚·ãƒªã‚¦ã‚¹ã€",expression:"a"},{speaker:"ãƒŠãƒ¬ãƒ¼ã‚¿ãƒ¼",character:"narrator",text:"ã‚¯ã‚»ã®å¼·ã„ã€Œã‚ˆã„ã—ã‚‡â¤´ã‚ãã‚Œâ¤´ã€ã®ã‚«ãƒ©ã‚ªã‚±åˆã„ã®æ‰‹ãŒåç‰©ï¼",expression:"a"},{speaker:"ãƒŠãƒ¬ãƒ¼ã‚¿ãƒ¼",character:"narrator",text:"æ–‡å­—ã§ã¯ä¼ã‚ã‚‰ãªã„ãƒ‹ãƒ¥ã‚¢ãƒ³ã‚¹ã ãï¼ã‚ã¨ã‚‚ã†åº—ã¯æ½°ã‚Œã¦ã‚‹ãï¼",expression:"a"},{speaker:"ãƒŠãƒ¬ãƒ¼ã‚¿ãƒ¼",character:"narrator",text:"æ¬¡ã«ã€ã€ã‚¸ãƒ¥ã‚¨ãƒªãƒ¼ã€",expression:"a",background:"jewelry",se:"taiko_2ren"},{speaker:"ãƒŠãƒ¬ãƒ¼ã‚¿ãƒ¼",character:"narrator",text:"é³´ç‰©å…¥ã‚Šã§ã‚„ã£ã¦ããŸãƒ«ãƒ¼ã‚­ãƒ¼ï¼åŸæ¶²9å‰²ã®ãƒ¬ãƒ¢ãƒ³ã‚µãƒ¯ãƒ¼ã§é£›ã¹ã‚‹ãï¼",expression:"a"},{speaker:"ãƒŠãƒ¬ãƒ¼ã‚¿ãƒ¼",character:"narrator",text:"æ›´ã«ã€ãƒ‰ãƒ¼ãƒ«ã€",expression:"a",background:"doll",se:"taiko_2ren"},{speaker:"ãƒŠãƒ¬ãƒ¼ã‚¿ãƒ¼",character:"narrator",text:"å”¯ä¸€ã®åŒä¸–ä»£ãƒ»ã‚¢ã‚¤ãƒ‰ãƒ«ã¾ã‚†ã¡ã‚ƒã‚“ï¼ä¸‰é‡ç”ºæœ€å¾Œã®å¸Œæœ›ã ï¼ã§ã‚‚ã‚‚ã†å¼•é€€ã—ãŸãï¼",expression:"a"},{speaker:"ãƒŠãƒ¬ãƒ¼ã‚¿ãƒ¼",character:"narrator",text:"ã§ã‚‚ã‚‚ã†å¼•é€€ã—ãŸãï¼",expression:"a"},{speaker:"ãƒŠãƒ¬ãƒ¼ã‚¿ãƒ¼",character:"narrator",text:"ã‚ã¨æ™®é€šã«åŒç´šç”Ÿã®è¦ªã¨ã‹ã‚‚é€šã£ã¦ã‚‹ï¼",expression:"a"},{speaker:"ãƒŠãƒ¬ãƒ¼ã‚¿ãƒ¼",character:"narrator",text:"ã€ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã€ã‚«ãƒ©ã‚ªã‚±ãŒç››ã‚Šä¸ŠãŒã‚Šã™ãã¦ä¼šè©±ã§ããªã„ï¼",expression:"a",background:"secret",se:"taiko_2ren"},{speaker:"ãƒŠãƒ¬ãƒ¼ã‚¿ãƒ¼",character:"narrator",text:"æœ€é«˜ãªãƒ•ã‚£ãƒªãƒ”ãƒ³ãƒãƒã«ã‚ˆã‚‹ãƒã‚¤ãƒ†ã‚£ãƒ–æ´‹æ¥½ã¨ãƒ•ã‚£ãƒªãƒ”ãƒ³æ–™ç†ãŒé­…åŠ›ï¼",expression:"a"},{speaker:"ãƒŠãƒ¬ãƒ¼ã‚¿ãƒ¼",character:"narrator",text:"æ–™é‡‘ã¯ã¡ã‚‡ã£ã¨ä¸å®‰ã«ãªã‚‹ãã‚‰ã„å®‰ã„ãï¼",expression:"a"},{speaker:"ãƒŠãƒ¬ãƒ¼ã‚¿ãƒ¼",character:"narrator",text:"ãã®ä»–ã«ã‚‚",expression:"a"},{speaker:"ãƒŠãƒ¬ãƒ¼ã‚¿ãƒ¼",character:"narrator",text:"ã€èŠ±å¸‚å ´ã€",expression:"a",background:"hanaichiba",se:"don"},{speaker:"ãƒŠãƒ¬ãƒ¼ã‚¿ãƒ¼",character:"narrator",text:"ã€ã˜ã‚‡ã„ã‚Šã‚“ã€ï¼",expression:"a",background:"joelyn",se:"don"},{speaker:"ãƒŠãƒ¬ãƒ¼ã‚¿ãƒ¼",character:"narrator",text:"ã€ã•ãã‚‰ã€ï¼ï¼",expression:"a",background:"sunakku_sa",se:"don"},{speaker:"ãƒŠãƒ¬ãƒ¼ã‚¿ãƒ¼",character:"narrator",text:"ã€ã‚¯ãƒ¼ãƒ«ã€ï¼ï¼ï¼",expression:"a",background:"cool",se:"taiko_2ren"},{speaker:"ãƒŠãƒ¬ãƒ¼ã‚¿ãƒ¼",character:"narrator",text:"ä»–ã«ã‚‚æ„‰å¿«ãªã‚¹ãƒŠãƒƒã‚¯ãŒå‹¢æƒã„ã ï¼",expression:"a"},{speaker:"ãƒŠãƒ¬ãƒ¼ã‚¿ãƒ¼",character:"narrator",text:"4æ™‚é–“å¾Œ",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã‚„ã£ã±ã‚¹ãƒŠãƒƒã‚¯ã®ã‚ã¨ã«ã€ã‚³ãƒ³ãƒ“ãƒ‹ã§3æ¬¡ä¼šã™ã‚‹ã®ãŒæœ€é«˜ãªã‚“ã ã‚ˆãªã€œ",background:"seven",expression:"a"},{speaker:"ãƒŠãƒ¬ãƒ¼ã‚¿ãƒ¼",character:"narrator",text:"ä¸‰é‡ç”ºã®å¤œã¯ã€ã¾ã ã¾ã å¯ã‹ã›ã¦ãã‚Œãªã„ã€‚",expression:"a"}]},momoiro_jyogakuenn:{background:"momoiro",bgm:"togetogetarumeiro",conversations:[{character:"narrator",text:"ã“ã“ã«ã€äºŒåŒ¹ã®ç‹¼ãŒã„ãŸã€‚",expression:"a"},{character:"narrator",text:"è³¢ã„ç‹¼ã¨ã€æ°—ã®ã„ã„ç‹¼ã€‚äºŒåŒ¹ã¯å…±ã«ç‹©ã‚Šã‚„æ°´æµ´ã³ã‚’ã™ã‚‹ã»ã©ä»²ãŒã‚ˆã‹ã£ãŸã€‚",expression:"a"},{character:"narrator",text:"ã‚ã‚‹ã¨ãã€è³¢ã„ç‹¼ãŒè¨€ã£ãŸã€‚",expression:"a"},{character:"narrator",text:"ã€Œç²ç‰©ã‚’è¿½ã„ã‹ã‘ã‚‹ã‚ˆã‚Šã€å¾…ã¡ä¼ã›ã‚’ã—ã‚ˆã†ã€‚ã€",expression:"a"},{character:"narrator",text:"ã€Œãã†ã™ã‚Œã°é ãã¾ã§å‡ºã‹ã‘ãšã¨ã‚‚ã€ç²ç‰©ã®ã»ã†ã‹ã‚‰ã‚„ã£ã¦æ¥ã‚‹ã ã‚ã†ã€",expression:"a"},{character:"narrator",text:"æ°—ã®ã„ã„ç‹¼ã¯äºŒã¤è¿”äº‹ã§ã†ãªãšã„ãŸã€‚ã ãŒã€äºŒåŒ¹ã«ã¯å¾…ã¡ä¼ã›ã«é©ã—ãŸå ´æ‰€ã®å¿ƒå½“ãŸã‚ŠãŒãªã‹ã£ãŸã€‚",background:"ookami",expression:"a"},{character:"narrator",text:"ãã“ã§äºŒåŒ¹ã¯ã€æ‘ã®ç‰©çŸ¥ã‚Šãªç‹¼ã«ç›¸è«‡ã™ã‚‹ã“ã¨ã«ã—ãŸã€‚",expression:"a"},{character:"narrator",text:"ç‰©çŸ¥ã‚Šãªç‹¼ã¯è¨€ã£ãŸã€‚",expression:"a"},{character:"narrator",text:"ã€ŒçŸ¥ã‚ŠãŸã‘ã‚Œã°ã€å¯¾ä¾¡ã‚’æ‰•ã„ãªã•ã„ã€",expression:"a"},{character:"narrator",text:"äºŒåŒ¹ã¯ã—ã¶ã—ã¶ã€ä»¥å‰ã«ç‹©ã£ãŸç²ç‰©ã‚’ç‰©çŸ¥ã‚Šãªç‹¼ã«åˆ†ã‘ä¸ãˆãŸã€‚",expression:"a"},{character:"narrator",text:"æº€è¶³ãã†ã«ã†ãªãšã„ãŸç‰©çŸ¥ã‚Šãªç‹¼ã¯ç­”ãˆãŸã€‚",expression:"a"},{character:"narrator",text:"ã€Œæ‘ã®å¤–ã‚Œã«ã€ä½¿ã‚ã‚Œã¦ã„ãªã„æ´çªŸãŒäºŒã‹æ‰€ã‚ã‚‹ã€‚äººç›®ã«ã¤ãã«ããã€ç‹©ã‚Šã«ã¯æœ€é©ã ã€",expression:"a"},{character:"narrator",text:"ã€Œãã“ã¯è‡ªç„¶ã‚‚è±Šã‹ã§ã€ç²ç‰©ã‚‚å¤šãã€ä¸¸ã€…å¤ªã£ã¦ã†ã¾ãã†ã«è¦‹ãˆã‚‹ã€ã¨ã‚‚ã€‚",expression:"a"},{character:"narrator",text:"ç‰©çŸ¥ã‚Šãªç‹¼ã¯ç¶šã‘ãŸã€‚",expression:"a"},{character:"narrator",text:'ã€ŒãŸã ã—ã€ãã“ã‹ã‚‰å¸°ã‚‹ã«ã¯"å¯¾ä¾¡"ãŒå¿…è¦ã ã€‚ãã®å¯¾ä¾¡ã¯ã‚ã—ã«ã‚‚åˆ†ã‹ã‚‰ã‚“ã€',expression:"a"},{character:"narrator",text:"å°‘ã—ã®ç–‘å¿µã‚’æŠ±ããªãŒã‚‰ã‚‚ã€äºŒåŒ¹ã®ç‹¼ã¯æ´çªŸã¸å‘ã‹ã£ãŸã€‚",expression:"a"},{character:"narrator",text:"æ—¥ãŒæ²ˆã¿ã€å¤œãŒæ›´ã‘ã‚‹ã“ã‚ã€äºŒã¤ã®æ°—é…ãŒè¿‘ã¥ã„ã¦ããŸã€‚",expression:"a"},{character:"narrator",text:"å¤œé—‡ã«ã¾ãã‚Œã¦ç²ç‰©ã®å…¨è²Œã¯è¦‹ãˆãªã„ã€‚ãã‚Œã§ã‚‚äºŒåŒ¹ã¯æ¯ã‚’æ½œã‚ã€æ´çªŸã§å¾…ã¡ä¼ã›ã‚’ç¶šã‘ãŸã€‚",expression:"a"},{character:"narrator",text:"ã‚„ãŒã¦ã€äºŒåŒ¹ã®ç²ç‰©ãŒæ´çªŸã«å…¥ã‚‹ã€‚",expression:"a"},{character:"narrator",text:"ãã®ç¬é–“ã€äºŒåŒ¹ã®ç‹¼ã¯ç²ç‰©ã‚’ã¨ã‚‰ãˆã‚‹ãŸã‚ã€è¡Œå‹•ã‚’èµ·ã“ã—ãŸ",expression:"a"},{character:"narrator",text:"ã—ã‹ã—ã€ï¼’åŒ¹ã®ç‹¼ã¯è¡Œå‹•ã‚’åœæ­¢ã—ãŸã€‚ç‹©ã‚Šã®æœ¬èƒ½ã‚‚æ€¥æ­¢ã—ãŸã€‚",expression:"a"},{character:"narrator",text:"ç†ç”±ã¯ç°¡å˜ã ã£ãŸã€ç›®ã®å‰ã®ç²ç‰©ãŒã€ãŸã„ãã†å¥½ã¿ã§ã¯ãªã‹ã£ãŸã®ã ã€‚ç«¯çš„ã«è¨€ãˆã°â€”â€”ãƒã‚ºãã†ã€ã ã£ãŸã€‚",expression:"a"},{character:"narrator",text:"ãã‚Œã§ã‚‚äºŒåŒ¹ã¯å¼•ã‘ãªã‹ã£ãŸã€‚ã“ã“ã«è‡³ã‚‹ã¾ã§ã«ã€ç‰©çŸ¥ã‚Šãªç‹¼ã«å¯¾ä¾¡ã‚’æ‰•ã£ã¦ã—ã¾ã£ã¦ã„ãŸã‹ã‚‰ã ã€‚",expression:"a"},{character:"narrator",text:"ä½•ã‚‚ã€ã—ãªã„ã§å¸°ã‚‹ã“ã¨ã¯ã€äºŒåŒ¹ã®ãƒ—ãƒ©ã‚¤ãƒ‰ãŒè¨±ã•ãªã‹ã£ãŸã€‚",expression:"a"},{character:"narrator",text:"â€”â€”ç‹©ã‚Šã¯çµ‚ã‚ã£ãŸã€‚æ˜‡ã‚‹æœæ—¥ã‚’èƒŒã«ã€è‚©ã‚’è½ã¨ã—ãŸå¸°ã‚Šé“ã«ã€ã½ã¤ã‚Šã¨æ°—ã®ã„ã„ç‹¼ãŒè¨€è‘‰ã‚’ã“ã¼ã—ãŸã€‚",background:"yuuhiload",expression:"a"},{character:"narrator",text:"ã€Œã‚ã®æ—¥ã€åƒ•ã‚‰ã¯å¤§äººã«ãªã£ãŸã€",expression:"a"},{character:"narrator",text:"è³¢ã„ç‹¼ã¯ã€ãã‚Œã‚’è‹¦ã„é¡”ã§èãæµã—ãŸã€‚",expression:"a"}]},okagami_conversation:{background:"test_1",bgm:"Fantasy",conversations:[{speaker:"ãŠã‹ãŒã¿",character:"okagami",text:"ã‚¿ãƒã‚³ãŒåˆ‡ã‚ŒãŸ...",expression:"c"},{speaker:"ãŠã‹ãŒã¿",character:"okagami",text:"é›†åˆï¼ï¼",expression:"a"},{speaker:"ãŠã‹ãŒã¿",character:"okagami",text:"é‡˜å®®ï¼ãŠå‰ã¯ã¾ã˜ã§ãƒ€ãƒ¡ï¼ã‚„ã‚‹æ°—ãŒè¶³ã‚Šãªã„ï¼ã‚µãƒœã‚‹ãªï¼",expression:"a"},{speaker:"ãŠã‹ãŒã¿",character:"okagami",text:"æ²³å®¤ï¼ãªã‚“ã ãã®é«ªã®æ¯›ã¯æ¡œæœ¨èŠ±é“ã˜ã‚ƒã­ãˆã‹ï¼",expression:"a"},{speaker:"ãŠã‹ãŒã¿",character:"okagami",text:"ãƒœã‚³ã£ï¼ (æ®´ã‚‹éŸ³)",expression:"a"},{speaker:"è‡ªåˆ†",character:"player",text:"ä¿ºã‚‰ã®æ™‚ä»£ã ã‹ã‚‰ã¾ã è¨±ã•ã‚Œã¦ã‚‹æ„Ÿã‚ã‚‹ã‚ˆãª....",expression:"c"},{speaker:"è‡ªåˆ†",character:"player",text:"ã¾ã˜ã§ç—›ãˆãª...",expression:"c"}]},daichi_conversation:{background:"test_1",bgm:"Fantasy",conversations:[{speaker:"ã ã„ã¡",character:"daichi",text:"å‰¯ãƒªãƒ¼ãƒ€ãƒ¼ã¨ã‹ã„ã†ã®å«Œã™ãã‚‹ãª",expression:"c"},{speaker:"ã ã„ã¡",character:"daichi",text:"ã©ã£ã‹ã§ã‚µãƒœã‚ã†ãœ",expression:"a"},{speaker:"ã ã„ã¡",character:"daichi",text:"ã¾ãŸãŠã‹ãŒã¿ã«æ€’ã‚‰ã‚Œã‚‹ã ã‘ã‹ã‚‚ã ã‘ã©...",expression:"c"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã ã„ã¡ã¯ã„ã£ã¤ã‚‚å†·ã‚ã¦ã‚‹ã‚ˆãª",expression:"b"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã¾ã‚ã€ã„ã„ã‚„ãƒãƒ§ãƒ­QæŒã£ã¦ãã¦ã‚‹ã‹ã‚‰ã“ã‚Œã§éŠã¶ã",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ãã‚Œã‹ã€ã“ã®ãƒã‚¹é‡£ã‚Šã®é›‘èªŒã¿ã‚“ãªã§è¦‹ã‚ˆã†ãœ",expression:"a"},{speaker:"ã ã„ã¡",character:"daichi",text:"ã„ã¤ã‚‚ã®æµã‚Œã ã‘ã©ã€ã“ã‚ŒãŒä¸€ç•ªæ¥½ã—ã„ã‚ˆãªç¬‘",expression:"a"}]}};class r{constructor(){this.conversations=s,this.currentEvent=null,this.resourceManager=null}setResourceManager(e){this.resourceManager=e}getConversation(e){return this.conversations[e]||null}getAvailableEvents(){return Object.keys(this.conversations)}async loadMap(e="miemachi"){if(!this.resourceManager)throw new Error("ResourceManager not set");try{return console.log(`ä¸‰é‡ç”ºãƒãƒƒãƒ—ã€Œ${e}ã€ã‚’èª­ã¿è¾¼ã¿ä¸­...`),await this.resourceManager.loadMapResources(e),console.log(`ä¸‰é‡ç”ºãƒãƒƒãƒ—ã€Œ${e}ã€ã®èª­ã¿è¾¼ã¿å®Œäº†`),!0}catch(e){throw console.error("ãƒãƒƒãƒ—èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:",e),e}}async startEvent(e){if(!this.resourceManager)throw new Error("ResourceManager not set");try{return await this.resourceManager.loadEventResources(e,this.conversations),this.currentEvent=e,!0}catch(e){throw console.error("Failed to start event:",e),e}}endEvent(){this.resourceManager&&this.resourceManager.unloadResources(),this.currentEvent=null}addConversation(e,t){this.conversations[e]=t}updateConversation(e,t){return!!this.conversations[e]&&(this.conversations[e]=t,!0)}}},364:(e,t,a)=>{a.d(t,{AreaConfig:()=>s});const s={select_screen:{bgm:{menu:"assets/audio/bgm/zelda_menu_select.mp3"},se:{touch:"assets/audio/se/touch_1.mp3"}},stage_select:{bgm:{menu:"assets/audio/bgm/zelda_menu_select.mp3"},se:{touch:"assets/audio/se/touch_1.mp3"}},stages:{stage1:{bgm:{map:"assets/audio/bgm/nightbarth.mp3"}},stage2:{bgm:{map:"assets/audio/bgm/stage2/Pollyanna.mp3"}},stage3:{bgm:{map:"assets/audio/bgm/stage3.mp3"}}},miemachistage:{mapKey:"miemachi",tilesetKey:"miemachi",mapTitle:"ä¸‰é‡ç”ºãƒãƒƒãƒ—",folderName:"miemachi",mapFileName:"miemachi",tilesetFileName:"miemachi",bgm:{map:"assets/audio/bgm/kessen_diaruga.mp3"},se:{se_touch:"assets/audio/se/touch_7.mp3",se_map_touch:"assets/audio/se/touch_2.mp3"},areas:[{name:"oreno_koto",scene:null,conversationId:"oreno_koto"},{name:"momoiro_jyogakuenn",scene:null,conversationId:"momoiro_jyogakuenn"},{name:"drinking_dutu",scene:null,conversationId:"drinking_dutu"},{name:"Weeds_burn",scene:null,conversationId:"Weeds_burn"},{name:"mie_high_school",scene:"startPhaserGame",sceneParam:1,conversationId:null},{name:"raizu",scene:null,conversationId:"raizu"},{name:"snack_street_night",scene:null,conversationId:"snack_street_night"},{name:"souce",scene:null,conversationId:"souce"},{name:"koutaroupoteto",scene:null,conversationId:"koutaroupoteto"},{name:"seven",scene:null,conversationId:"seven"}]},taketastage:{mapKey:"taketa",tilesetKey:"taketa",mapTitle:"ç«¹ç”°ã‚¹ãƒ†ãƒ¼ã‚¸",folderName:"taketa",mapFileName:"taketa",tilesetFileName:"taketa",bgm:{map:"assets/audio/bgm/Spain.mp3"},se:{se_touch:"assets/audio/se/touch_7.mp3",se_map_touch:"assets/audio/se/touch_2.mp3"},areas:[{name:"taketa_station",scene:null,conversationId:"taketa_station"},{name:"taketa_high_school",scene:"startPhaserGame",sceneParam:"taketa_highschool",conversationId:null},{name:"galaxy_water",scene:null,conversationId:"galaxy_water"},{name:"udefuriojisann",scene:null,conversationId:"udefuriojisann"},{name:"working_go_to_home_miemachi",scene:null,conversationId:"working_go_to_home_miemachi"}]},japanstage:{mapKey:"japan",tilesetKey:"japan",mapTitle:"æ—¥æœ¬ãƒãƒƒãƒ—",folderName:"japan",mapFileName:"japan",tilesetFileName:"japan",bgm:{map:"assets/audio/bgm/Theme_from_Back_To_The_Future.mp3"},se:{se_touch:"assets/audio/se/touch_7.mp3",se_map_touch:"assets/audio/se/touch_2.mp3"},areas:[{name:"computer",scene:null,conversationId:"computer"},{name:"breaking_car",scene:null,conversationId:"breaking_car"},{name:"special_scam",scene:null,conversationId:"special_scam"},{name:"rojyounopenki",scene:null,conversationId:"rojyounopenki"},{name:"tereapo",scene:null,conversationId:"tereapo"},{name:"first_rising_sun",scene:null,conversationId:"first_rising_sun"},{name:"arechi",scene:null,conversationId:"arechi"},{name:"gray_bytes",scene:null,conversationId:"gray_bytes"}]}}},527:(e,t,a)=>{a.r(t),a.d(t,{JapanConversationManager:()=>r,japanConversationData:()=>s});const s={computer:{background:"test_1",bgm:"curono",conversations:[{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã“ã“ã¯ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ã‚¨ãƒªã‚¢ã ãœâ˜†",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"æœ€æ–°ã®ãƒ†ã‚¯ãƒãƒ­ã‚¸ãƒ¼ãŒé›†ã¾ã£ã¦ã‚‹å ´æ‰€ã ãª",expression:"b"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã¨ã‹ã€AIã¨ã‹ã€ã„ã‚ã‚“ãªæŠ€è¡“ãŒã‚ã‚‹ãœ",expression:"a"}]},breaking_car:{background:"test_1",bgm:"curono",conversations:[{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"æ•…éšœã—ãŸè»ŠãŒã‚ã‚‹ãª...",expression:"b"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ãŒå¿…è¦ã ãª",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"å®‰å…¨ç¬¬ä¸€ã§ä¿®ç†ã—ãªã„ã¨ãª",expression:"c"}]},special_scam:{background:"test_1",bgm:"togetogetarumeiro",conversations:[{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"å‹é”ã®çµå©šå¼ã‚ˆã‹ã£ãŸãªã€ã€ã€",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã¨ã‚Šã‚ãˆãšã€ãƒã‚«ãƒ•ã‚§ã«æ³Šã¾ã£ã¦ä½“ã€ãƒã‚­ãƒã‚­ã ã‹ã‚‰ä¸€æœã™ã‚‹ã‹",expression:"b"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ãµã…ã€ã€ã€ã€ã€ã€",expression:"c"},{speaker:"çŸ¥ã‚‰ãªã„ãŠã˜ã•ã‚“",character:"stranger",text:"ã¡ã‚‡ã£ã¨ã€ãŠå…„ã•ã‚“ã€ã“ã“ã‚‰ã¸ã‚“ã§æœ‰åãªå±…é…’å±‹ã—ã‚‰ãªã„ï¼Ÿ",expression:"a"},{speaker:"çŸ¥ã‚‰ãªã„ãŠã˜ã•ã‚“",character:"stranger",text:"ä¿ºã‚‚ã€ã€ã€ä¹…ã—ã¶ã‚Šã«ã‹ãˆã£ãŸã‹ã‚‰ãªã€ã€ã€ã¨ã‚Šã‚ãˆãšã€çŸ¥ã£ã¦ã„ã‚‹ã¨ã“ã‚ç­”ãˆã‚‹ã‹",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã“ã“ãªã‚“ã‹ã¯ã‚†ã†ã‚ã„ã§ã™ã­ã€ã€ã€",expression:"a"},{speaker:"çŸ¥ã‚‰ãªã„ãŠã˜ã•ã‚“",character:"stranger",text:"ã‚ã‚ŠãŒã¨ã†ã‚ã‚ŠãŒã¨ã†ã€ã€ã€",expression:"a"},{speaker:"çŸ¥ã‚‰ãªã„ãŠã˜ã•ã‚“",character:"stranger",text:"ãŠå…„ã•ã‚“ã„ã„äººã ã‹ã‚‰ã€ä¿ºã‚‚ã„ã‚ã„ã‚è©±ã—ãŸããªã£ãŸã‚",expression:"a"},{speaker:"çŸ¥ã‚‰ãªã„ãŠã˜ã•ã‚“",character:"stranger",text:"å®Ÿã¯ä¿ºå®ãã˜å½“ãŸã£ãŸã‹ã‚‰ã€åƒãå¿…è¦ãªããªã£ã¦é¹¿å…å³¶è¦³å…‰ã—ã¦ãŸã‚“ã ã‚",expression:"a"},{speaker:"çŸ¥ã‚‰ãªã„ãŠã˜ã•ã‚“",character:"stranger",text:"ãŠå…„ã•ã‚“ã„ã¤å¸°ã‚‹ã®ï¼Ÿã‚ã—ãŸï¼Ÿ",expression:"a"},{speaker:"çŸ¥ã‚‰ãªã„ãŠã˜ã•ã‚“",character:"stranger",text:"ã˜ã‚ƒã‚ã‚‚ã†é£›è¡Œæ©Ÿã¨ã‹ã„ã„ã‹ã‚‰ã€ã¡ã‚‡ã£ã¨è©±ãã†ã‚ˆã€é£¯ã„ã“ã†",expression:"a"},{speaker:"çŸ¥ã‚‰ãªã„ãŠã˜ã•ã‚“",character:"stranger",text:"ç„¼ãé³¥ã¨ã‹ã«ã„ã“ã†ã‚„",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã‚“ï¼Ÿï¼Ÿï¼Ÿï¼Ÿè¨€ã£ãŸã¨ã“ã‚ã¨é•ã†ã‘ã©ã€ã¾ããˆãˆã‹",expression:"b"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã‚ã£ã€ã‚ã‹ã‚Šã¾ã—ãŸ",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ç„¼ãé³¥ãŠã„ã—ã„ã§ã™ã­",expression:"a"},{speaker:"çŸ¥ã‚‰ãªã„ãŠã˜ã•ã‚“",character:"stranger",text:"ç¾å‘³ã—ã‹ã£ãŸã§ã™ã­ã€‚",expression:"a"},{speaker:"çŸ¥ã‚‰ãªã„ãŠã˜ã•ã‚“",character:"stranger",text:"ã¡ã‚‡ã£ã¨ã€ã¤ã‹ã‚Œã¾ã—ãŸã­ã€ãã“ã®ãƒ™ãƒ³ãƒã«åº§ã‚Šã¾ã—ã‚‡ã†",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ä»•äº‹ã¨ã‹ã‚ã‚“ã¾ã‚Šã†ã¾ãã„ã£ã¦ãªãã¦ã€ã•ã‚‰ã«å®¶æ—ã‚‚ã„ã‚ã„ã‚ã‚ã£ã¦",expression:"c"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"å½¼å¥³ã¨ã‚‚å¤§å¤‰ã§ã€ãã®ã†ãˆç”Ÿæ´»è²»å‡ºã™ã®ã‚®ãƒªã‚®ãƒªã§ã€ã€ã€",expression:"c"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã†ã…ã€ã€ã€ã€ãã…ã€ã€ã€ã€",expression:"c"},{speaker:"çŸ¥ã‚‰ãªã„ãŠã˜ã•ã‚“",character:"stranger",text:"ãã£ã‹ã€å¤§å¤‰ã‚„ã£ãŸã‚“ã‚„ãª",expression:"a"},{speaker:"çŸ¥ã‚‰ãªã„ãŠã˜ã•ã‚“",character:"stranger",text:"ãã†ã ãªã€ã€ä¿ºã€å®ãã˜ï¼‘å„„å††å½“ãŸã£ã¦ã‚‹ã—ã€ï¼•ï¼ä¸‡ã‚ã’ã‚‹ã‚",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ãƒã‚¸ã£ã™ã‹",expression:"a"},{speaker:"çŸ¥ã‚‰ãªã„ãŠã˜ã•ã‚“",character:"stranger",text:"ã˜ã‚ƒã‚ã€ã‚‚ã†ä»Šæ—¥ã¯ã‚†ã£ãã‚Šå¸°ã‚Šãª",expression:"a"},{speaker:"çŸ¥ã‚‰ãªã„ãŠã˜ã•ã‚“",character:"stranger",text:"ä»Šæ—¥ã¯ã‚‚ã†é£›è¡Œæ©Ÿã‚­ãƒ£ãƒ³ã‚»ãƒ«ã—ã¦ã€ãã‚Œã„ãªãŠã­ãƒ¼ã¡ã‚ƒã‚“ãŒã„ã‚‹ã¨ã“ã‚ã¨ã„ã„ã¨ã“é€£ã‚Œã¦è¡Œã£ã¦ã‚ã’ã‚‹ã‚ˆ",expression:"a"},{speaker:"çŸ¥ã‚‰ãªã„ãŠã˜ã•ã‚“",character:"stranger",text:"ã ã‘ã©ã€ãã†ã ãªã€ã“ã®ã¾ã¾ï¼•ï¼ä¸‡å††ä¸Šã’ã‚‹ã®ã¯ç°¡å˜ã ã‘ã©",expression:"a"},{speaker:"çŸ¥ã‚‰ãªã„ãŠã˜ã•ã‚“",character:"stranger",text:"ãŠå…„ã•ã‚“ã®ä»Šå¾Œã®ãŸã‚ã«ãã®ã¾ã¾æ¸¡ã™ã ã‘ã§ã¯æ„å‘³ãªã„ãªã€ã€",expression:"a"},{speaker:"çŸ¥ã‚‰ãªã„ãŠã˜ã•ã‚“",character:"stranger",text:"ãŠå…„ã•ã‚“ãªã‚‰ã©ã†ã™ã‚‹ï¼Ÿ",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã©ã€ã€ã©ã†ã™ã‹ã­ã€ã€ã€",expression:"b"},{speaker:"çŸ¥ã‚‰ãªã„ãŠã˜ã•ã‚“",character:"stranger",text:"ã“ã†ã™ã‚‹ã®ãŒã„ã„ã‚ˆã€ã€",expression:"a"},{speaker:"çŸ¥ã‚‰ãªã„ãŠã˜ã•ã‚“",character:"stranger",text:"ä¿ºä»Šã€é‡‘ã‚’æ‰±ã†ä»•äº‹ã‚’ã—ã¦ã„ã¦ã€é‡‘ã‚’æ‰±ã†ãƒˆãƒ¬ãƒ¼ãƒ€ãƒ¼ã‚’ã—ã¦ã„ã‚‹ã‚“ã ",expression:"a"},{speaker:"çŸ¥ã‚‰ãªã„ãŠã˜ã•ã‚“",character:"stranger",text:"æ—¥æœ¬ã§è²·ã£ã¦ã€æµ·å¤–ã£ã¦ã„ã†ã‹ä¸­å›½ã¨ã‹ã§å£²ã‚‹ã£ã¦æ„Ÿã˜ã‹ãª",expression:"a"},{speaker:"çŸ¥ã‚‰ãªã„ãŠã˜ã•ã‚“",character:"stranger",text:"ä¸­å›½ã§ã¯é‡‘ã®ä¾¡å€¤ãŒã‚ã£ã¡ã‚ƒã‚ãŒã£ã¦ã„ã‚‹ã‚“ã ã‚ˆ",expression:"a"},{speaker:"çŸ¥ã‚‰ãªã„ãŠã˜ã•ã‚“",character:"stranger",text:"ã§ã€ä»Šã€ã¡ã‚‡ã†ã©ä¸€å£ã‚ã„ã¦ã¦",expression:"a"},{speaker:"çŸ¥ã‚‰ãªã„ãŠã˜ã•ã‚“",character:"stranger",text:"ç¢ºå®šã§ï¼•ï¼ä¸‡ã¨ã‹å…¥ã‚ŒãŸã‚‰ï¼‘å€ä»¥ä¸Šã€ã€ã€ï¼’å€ã¨ã‹ã«ãªã‚‹ã‹ã‚‰",expression:"a"},{speaker:"çŸ¥ã‚‰ãªã„ãŠã˜ã•ã‚“",character:"stranger",text:"ãã®ä¸€å£ã‚’ã‚ã’ã‚‹ã‚ˆ",expression:"a"},{speaker:"çŸ¥ã‚‰ãªã„ãŠã˜ã•ã‚“",character:"stranger",text:"ãŸã ã—ã€ãã®ï¼•ï¼ä¸‡å††ã¯è‡ªåˆ†ã§æº–å‚™ã—ã¦ã­ã€ã€",expression:"a"},{speaker:"çŸ¥ã‚‰ãªã„ãŠã˜ã•ã‚“",character:"stranger",text:"ã©ã†ã™ã‚‹ï¼Ÿï¼Ÿ",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã€ã€ã€ã†ã£ã€ã€ã€",expression:"c"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"çŠ¶æ³ã‚’æ•´ç†ã—ã‚ˆã†ã€",expression:"b"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ä¿ºã¯ï¼ˆ2022å¹´ï¼‰å½“æ™‚ã€è²¯é‡‘ã‚¼ãƒ­ã€å‹é”ã®ç¥å„€ï¼“ä¸‡ã¨ã‹ã§ã‚«ãƒ„ã‚«ãƒ„ã€ã€ã€",expression:"c"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã—ã‹ã‚‚ã€ä»Šãƒ‹ãƒ¼ãƒˆã€ã€ã€ã€",expression:"c"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã ãŒã€ãŠé‡‘ã¯æ¬²ã—ã„ã€ã€ã€",expression:"b"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã§ã‚‚ã€ãŠé‡‘ã‚’å¢—ã‚„ã™ã«ã¯ãŠé‡‘ãŒã„ã‚‹",expression:"b"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã€ã€ã€ã©ã†ã—ã‚ˆã†ã€ã€",expression:"c"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"å€Ÿã‚Šã‚‹ã—ã‹ãªã„ã‚ˆãªã€ã€ã€ã€ã€ã€",expression:"c"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"å€Ÿã‚Šã‚‹ã—ã‹ã€ã€ã€",expression:"c"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã¡ã‚‡ã£ã¨ã€å¾…ã£ã¦ãã ã•ã„",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ä¿ºä»Šã€ã‚«ãƒ„ã‚«ãƒ„ãªã®ã§ã€æ¶ˆè²»è€…é‡‘èã‚’ã‚ãŸã‚‰ã›ã¦ãã ã•ã„",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ãƒ‹ãƒ¼ãƒˆã§ã‚‚è¡Œã‘ã‚‹æ¶ˆè²»è€…é‡‘èã‚’æ¢ã™ã‹ã€ã€ã€",expression:"b"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ãªã‹ãªã‹ã€ãªã„ã‹ã€ã€ã€",expression:"b"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã‚ã£ãŸã€ã“ã“ã ã€ã€ã€ã€",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã‚ã£ã€ï¼•ï¼ä¸‡ã€ã€ã€å€Ÿã‚Šã¾ã—ãŸ",expression:"a"},{speaker:"çŸ¥ã‚‰ãªã„ãŠã˜ã•ã‚“",character:"stranger",text:"ã‚ˆã—ã€ã˜ã‚ƒã‚ã€ä»Šã‹ã‚‰é€£ã‚Œã¦è¡Œãã¨ã“ã‚ã«é‡‘ãŒã‚ã‚‹ã‚“ã‚ˆã­",expression:"a"},{speaker:"çŸ¥ã‚‰ãªã„ãŠã˜ã•ã‚“",character:"stranger",text:"ãã“ã§è²·ã£ã¦ã€éƒµä¾¿ã¨ã‹å…¨éƒ¨ä¿ºãŒã—ã¦å±Šã‘ã‚‹ã‹ã‚‰ã€",expression:"a"},{speaker:"çŸ¥ã‚‰ãªã„ãŠã˜ã•ã‚“",character:"stranger",text:"ãã®ã‚ã¨ä¸€ç·’ã«ã€ä»Šæ—¥ã”é£¯ã¨ã‹é£Ÿã¹ãŸã‚Šã€ãŠé…’é£²ã‚“ã ã‚Šã„ã‚ã„ã‚ä¸€ç·’ã«ã—ã‚ˆã†",expression:"a"},{speaker:"çŸ¥ã‚‰ãªã„ãŠã˜ã•ã‚“",character:"stranger",text:"ã§ã€ã€ã€ã€å ´æ‰€ãªã‚“ã ã‘ã©ã€ãƒ‰ãƒ³ãƒ»ã‚­ãƒ›ãƒ¼ãƒ†ã€ã€ã€",expression:"a"},{speaker:"çŸ¥ã‚‰ãªã„ãŠã˜ã•ã‚“",character:"stranger",text:"ãƒ‰ãƒ³ãƒ»ã‚­ãƒ›ãƒ¼ãƒ†ã«é‡‘ãŒå£²ã£ã¦ã„ã‚‹ã‹ã‚‰ã€ã¨ã‚Šã‚ãˆãšã€å…ˆã«å£åº§ã§ãŠé‡‘ãŠã‚ã—ã¦ãã¦ã­",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã‚ã‹ã‚Šã¾ã—ãŸã€",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã‚¬ãƒ©ã‚¬ãƒ©ã€ã€ã€ã€ã€",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ï¼•ï¼ä¸‡å††ã®æœ­æŸã€ã€ã†ã‚ã€ã€ã€ã“ã‚ŒãŒï¼•ï¼ä¸‡ãªã‚“ã ã€ã€ã€",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã“ã‚ŒãŒï¼•ï¼ä¸‡å††ãªã‚“ã™ã­ã€ã™ã”ã„ã£ã™ã­",expression:"a"},{speaker:"çŸ¥ã‚‰ãªã„ãŠã˜ã•ã‚“",character:"stranger",text:"ã„ã‚„ã€ã‚‚ã£ã¨å¢—ãˆã‚‹ã‹ã‚‰",expression:"a"},{speaker:"çŸ¥ã‚‰ãªã„ãŠã˜ã•ã‚“",character:"stranger",text:"ã“ã‚“ãªã‚‚ã‚“ã˜ã‚ƒãªã„ã‚ˆ",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã†ã‚ã€ãƒã‚¸ã£ã™ã‹ã€ã€",expression:"a"},{speaker:"çŸ¥ã‚‰ãªã„ãŠã˜ã•ã‚“",character:"stranger",text:"ã¨ã‚Šã‚ãˆãšã€ã“ã®å ´ã§ãƒ‘ãƒƒã¨æ¸¡ã™ã¨æ€ªã—ã¾ã‚Œã‚‹ã‹ã‚‰",expression:"a"},{speaker:"çŸ¥ã‚‰ãªã„ãŠã˜ã•ã‚“",character:"stranger",text:"ã¡ã‚‡ã£ã¨ã€ãã“ã®é€šã‚Šã‚’æ­©ã„ã¦ã€äººç›®ã®ã¤ã‹ãªã„å ´æ‰€ã«è¡Œã“ã†ã‹",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã˜ã‚ƒã‚ã€ã“ã‚Œã‚ˆã‚ã—ããŠé¡˜ã„ã—ã¾ã™ã­",expression:"a"},{speaker:"çŸ¥ã‚‰ãªã„ãŠã˜ã•ã‚“",character:"stranger",text:"ã˜ã‚ƒã‚ã€ãƒ‰ãƒ³ãƒ»ã‚­ãƒ›ãƒ¼ãƒ†ã«è¡Œã“ã†ã‹",expression:"a"},{speaker:"çŸ¥ã‚‰ãªã„ãŠã˜ã•ã‚“",character:"stranger",text:"ãƒ‰ãƒ³ãƒ»ã‚­ãƒ›ãƒ¼ãƒ†ã«ã¤ã„ãŸã‘ã©ã€ä¿ºé‡‘ã‚’è²·ã£ã¦ãã‚‹ã‹ã‚‰ã¡ã‚‡ã£ã¨ã“ã“ã§ã¾ã£ã¦ã¦ã­",expression:"a"},{speaker:"çŸ¥ã‚‰ãªã„ãŠã˜ã•ã‚“",character:"stranger",text:"çµ¶å¯¾ã¾ã£ã¦ã¦ã‚ˆ",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã‚ã‹ã‚Šã¾ã—ãŸï¼ï¼ï¼",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"æ•°åˆ†å¾Œã€ã€ã€",expression:"b"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã‚‚ã†ãã‚ãã‚ã‹ãªã€ã€ã€",expression:"b"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"æ•°ååˆ†å¾Œã€ã€ã€",expression:"b"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã¾ãã¾ãã¾ãã¾ãã€ã€ã€é‡‘ã«æ›ãˆã‚‹ã‹ã‚‰ãªã“ã‚Œãã‚‰ã„ã‹ã‹ã‚‹ã‚“ã ã‚ãª",expression:"b"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã¾ãã€ã„ã„äººã ã£ãŸã—ãªã€ã€ã€ã€ã¾ãã€‚ã€‚ãªã„ã‚ˆãªã€ã€ã€ãã‚“ãªã“ã¨ã€ã€ã€",expression:"c"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ï¼“ï¼åˆ†å¾Œã€ã€ã€",expression:"b"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã‚ã£ã€ã€ã‚ã¸ã‡ã€ã€ã‚ã‚Œã€ã€ã€ãŠã‹ã—ã„ãªã€ã€ã€ã€ãŠãã„ãªã€ã€ã€",expression:"c"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã‚“ã‚“ã€ã€ã€ã‚ã‚Œã€ã€ã€ã‚ã¸ã‡ã‡ã€ã€ã»ã‚“ã¨ã«ã€ã€ã€ãŠãã„ãªã€ã€ã€ãŠãã€ã€",expression:"c"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã‚ã£ã€ã€ã€ã€ã€ã‚ã£ã‚ã£ã€ã€ã€ã‚¢ã€ã€ã€ã€ã„ã‚„ã€ã€ã€ã‚ã£ã€ã€ã€",expression:"c"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã€ã€ã€ã€ã‚ã£ã€é¨™ã•ã‚ŒãŸã€ã€ã€ã€ã€ã€ã€ã€ã€ã€ã€ã€ã€ã€",expression:"c"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã¯ã£ã€ã£ã¯ã€ã€ã€ã€ã¯ãã€ã¯ãã€ã†ã…ã€ã€ã€ã€ã€ã¯ãã€ã¯ãã€ã€ã€ã€ã€ã€",expression:"c"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã‚ã‚ã‚ã‚ã‚ã€ã€ã€ã€ã€ã‚ã‚ã‚ã‚ã‚ã‚ã‚ã‚ã‚ã‚ã‚ã€ã€ã€",expression:"c"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã¨ã£ã€ã¨ã‚Šã‚ãˆãšã€ã¡ã‚‡ã£ã¨ã€é¡”è¦‹çŸ¥ã‚Šã®å±…é…’å±‹ã®ã‚ªãƒ¼ãƒŠãƒ¼ã«ãã£ã€ç›¸è«‡ã—ã‚ˆã†",expression:"c"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ãƒ—ãƒ«ãƒ«ãƒ«ãƒ«ãƒ«ãƒ«",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã€ã€ã€ã€ã€ã‚ã‚ã‚ã‚ã‚ã€ã€ã ã£ã€ã€ã€ã€",expression:"c"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"é¨™ã•ã‚Œã¾ã—ãŸã€ã©ã†ã—ã¾ã—ã‚‡ã†ã€ã€",expression:"c"},{speaker:"è¦ªåˆ‡ãªå±…é…’å±‹ã®åº—ä¸»",character:"owner",text:"è½ã¡ç€ã‘ã€ã¨ã‚Šã‚ãˆãšã€äº¤ç•ªã«ã„ããƒ¼ãƒ¼ãƒ¼",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã€ã€ã€ã€ã€ã€ã€",expression:"c"},{speaker:"äº¤ç•ª",character:"police",text:"ã©ã†ã•ã‚Œã¾ã—ãŸï¼Ÿï¼Ÿ",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã†ã£ã€ã€ã€ã†ã…ã€ã€ã€é¨™ã•ã‚Œã¾ã—ãŸã€‚ã€‚ã€‚ã€‚",expression:"c"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ï¼•ï¼ä¸‡ã‚’ã‹ã‚Šã§ã‡ã€ã€ã€ãã—ã¦ã€ãƒ‰ãƒ³ã‚­ã§ãŠé‡‘æ¸¡ã—ã¦ã€ã€ã€ã€",expression:"c"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã†ã…ã€ã€ã€ã†ã£ã€ã€ã€ã€ã€",expression:"c"},{speaker:"äº¤ç•ª",character:"police",text:"è¨¼æ‹ ã¯ã‚ã‚Šã¾ã™ã§ã—ã‚‡ã†ã‹ã€ã€ã€ã€",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ãªã£ã€ã€ãªã„ã§ã™ã€ã€ã€ã€ã€",expression:"c"},{speaker:"äº¤ç•ª",character:"police",text:"ãã®äººã¯ã€ã€ã©ã‚“ãªé¡”ã ã£ãŸï¼Ÿï¼Ÿï¼Ÿ",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ãˆã£ã€ã€çµµã¯å¾—æ„ãªã®ã§ã€ã€ã€",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã†ã…ã€ã€ã‹ã£ã€ã€æãã¾ã™ã€ã€ã€ã€",expression:"c"},{speaker:"äº¤ç•ª",character:"police",text:"ã€ã€ã€ã€ã€ã€",expression:"a"},{speaker:"äº¤ç•ª",character:"police",text:"ã€ã€ã€ã€ã€ã€ã€ã€ã€",expression:"a"},{speaker:"äº¤ç•ª",character:"police",text:"ä¸€å¿œã€ã“ã‚Œã§æœæŸ»ã—ã¦ã¿ã¾ã™ãŒã€ã€ã€",expression:"a"},{speaker:"äº¤ç•ª",character:"police",text:"ã€ã€ã€ã“ã‚Šã‚ƒã€ã€ã€è¦‹ã¤ã‹ã‚Šã¯ã›ã‚“ã§ã€ã€ã€ã€",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã€ã€ã€ã€ã€ã—ã°ã‚‰ãã—ã¦ã€ã€ã€",expression:"c"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ãã®ï¼•ï¼ä¸‡å††ã¯å¸°ã£ã¦ãã‚‹ã“ã¨ã¯ãªã‹ã£ãŸã€ã€ã€",expression:"c"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã²ã‚ã‹ãšã¯ç›®ã®å‰ãŒçœŸã£æš—ã«ãªã£ãŸ",expression:"c"}]},rojyounopenki:{background:"test_1",bgm:"curono",conversations:[{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"è·¯ä¸Šã®å™´æ°´ã ãª",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"è¡—ã®æ™¯è¦³ã‚’è‰¯ãã—ã¦ã‚‹ãœ",expression:"b"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"å¤ã¯æ¶¼ã—ãã†ã ãª",expression:"a"}]},tereapo:{background:"test_1",bgm:"curono",conversations:[{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ãƒ†ãƒ¬ãƒ“å¡”ã ï¼",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"é›»æ³¢ã‚’é€ä¿¡ã—ã¦ã‚‹é‡è¦ãªæ–½è¨­ã ãª",expression:"b"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"è¡—ã®ãƒ©ãƒ³ãƒ‰ãƒãƒ¼ã‚¯ã«ãªã£ã¦ã‚‹ãœâ˜†",expression:"a"}]},first_rising_sun:{background:"test_1",bgm:"curono",conversations:[{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"åˆæ—¥ã®å‡ºã‚’è¦‹ã‚‹å ´æ‰€ã ãª",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"æ–°å¹´ã®å§‹ã¾ã‚Šã‚’ç¥ã†å ´æ‰€ã ãœ",expression:"b"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã¿ã‚“ãªã§é›†ã¾ã£ã¦ãŠç¥ã„ã™ã‚‹ã‚“ã ãª",expression:"a"}]},arechi:{background:"test_1",bgm:"curono",conversations:[{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã“ã“ã¯è’åœ°ã ãª...",expression:"b"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"é–‹ç™ºãŒé€²ã‚“ã§ã„ãªã„å ´æ‰€ã ãœ",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"å°†æ¥ã¯ä½•ã‹å»ºã¤ã‹ã‚‚ã—ã‚Œãªã„ãª",expression:"c"}]},gray_bytes:{background:"test_1",bgm:"curono",conversations:[{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ã‚°ãƒ¬ãƒ¼ãƒã‚¤ãƒˆ...",expression:"b"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"ä½•ã‹ç§˜å¯†ãŒã‚ã‚Šãã†ã ãª",expression:"a"},{speaker:"ã²ã‚ã‹ãš",character:"hirokazu",text:"èª¿æŸ»ã—ã¦ã¿ã‚‹ã‹ï¼Ÿ",expression:"c"}]}};class r{constructor(){this.conversationData=s,this.currentEvent=null,this.resourceManager=null}setResourceManager(e){this.resourceManager=e}async loadMap(e="japan"){if(!this.resourceManager)throw new Error("ResourceManager not set");try{return console.log(`æ—¥æœ¬ãƒãƒƒãƒ—ã€Œ${e}ã€ã‚’èª­ã¿è¾¼ã¿ä¸­...`),await this.resourceManager.loadMapResources(e),console.log(`æ—¥æœ¬ãƒãƒƒãƒ—ã€Œ${e}ã€ã®èª­ã¿è¾¼ã¿å®Œäº†`),!0}catch(e){throw console.error("ãƒãƒƒãƒ—èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:",e),e}}getConversation(e){return this.conversationData[e]||null}getAvailableEvents(){return Object.keys(this.conversationData)}async startEvent(e){if(!this.resourceManager)throw new Error("ResourceManager not set");try{return await this.resourceManager.loadEventResources(e,this.conversationData),this.currentEvent=e,!0}catch(e){throw console.error("Failed to start event:",e),e}}endEvent(){this.resourceManager&&this.resourceManager.unloadResources(),this.currentEvent=null}addConversation(e,t){this.conversationData[e]=t}updateConversation(e,t){this.conversationData[e]=t}}}},s={};function r(e){var t=s[e];if(void 0!==t)return t.exports;var i=s[e]={exports:{}};return a[e](i,i.exports,r),i.exports}r.m=a,r.d=(e,t)=>{for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},r.f={},r.e=e=>Promise.all(Object.keys(r.f).reduce(((t,a)=>(r.f[a](e,t),t)),[])),r.u=e=>e+".bundle.js",r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},t="zosusoft-prj-hirokazu:",r.l=(a,s,i,o)=>{if(e[a])e[a].push(s);else{var n,c;if(void 0!==i)for(var h=document.getElementsByTagName("script"),l=0;l<h.length;l++){var p=h[l];if(p.getAttribute("src")==a||p.getAttribute("data-webpack")==t+i){n=p;break}}n||(c=!0,(n=document.createElement("script")).charset="utf-8",n.timeout=120,r.nc&&n.setAttribute("nonce",r.nc),n.setAttribute("data-webpack",t+i),n.src=a),e[a]=[s];var g=(t,s)=>{n.onerror=n.onload=null,clearTimeout(u);var r=e[a];if(delete e[a],n.parentNode&&n.parentNode.removeChild(n),r&&r.forEach((e=>e(s))),t)return t(s)},u=setTimeout(g.bind(null,void 0,{type:"timeout",target:n}),12e4);n.onerror=g.bind(null,n.onerror),n.onload=g.bind(null,n.onload),c&&document.head.appendChild(n)}},r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;r.g.importScripts&&(e=r.g.location+"");var t=r.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var a=t.getElementsByTagName("script");if(a.length)for(var s=a.length-1;s>-1&&(!e||!/^http(s?):/.test(e));)e=a[s--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),r.p=e})(),(()=>{var e={792:0};r.f.j=(t,a)=>{var s=r.o(e,t)?e[t]:void 0;if(0!==s)if(s)a.push(s[2]);else{var i=new Promise(((a,r)=>s=e[t]=[a,r]));a.push(s[2]=i);var o=r.p+r.u(t),n=new Error;r.l(o,(a=>{if(r.o(e,t)&&(0!==(s=e[t])&&(e[t]=void 0),s)){var i=a&&("load"===a.type?"missing":a.type),o=a&&a.target&&a.target.src;n.message="Loading chunk "+t+" failed.\n("+i+": "+o+")",n.name="ChunkLoadError",n.type=i,n.request=o,s[1](n)}}),"chunk-"+t,t)}};var t=(t,a)=>{var s,i,[o,n,c]=a,h=0;if(o.some((t=>0!==e[t]))){for(s in n)r.o(n,s)&&(r.m[s]=n[s]);c&&c(r)}for(t&&t(a);h<o.length;h++)i=o[h],r.o(e,i)&&e[i]&&e[i][0](),e[i]=0},a=self.webpackChunkzosusoft_prj_hirokazu=self.webpackChunkzosusoft_prj_hirokazu||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})(),r(61);const i=new class{constructor(){this.deferredPrompt=null,this.init()}init(){console.log("PWAManageråˆæœŸåŒ–é–‹å§‹"),this.registerEventListeners(),console.log("PWAManageråˆæœŸåŒ–å®Œäº†")}registerEventListeners(){window.addEventListener("beforeinstallprompt",(e=>{console.log("beforeinstallprompt event fired"),e.preventDefault(),this.deferredPrompt=e,this.enableInstallButton(),this.showInstallBanner()})),window.addEventListener("appinstalled",(()=>{console.log("PWAãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¾ã—ãŸ"),this.hideInstallBanner(),this.deferredPrompt=null})),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",(()=>{this.setupInstallButton()})):this.setupInstallButton()}setupInstallButton(){const e=document.getElementById("install-btn"),t=document.getElementById("close-install-btn");e&&e.addEventListener("click",(async e=>{e.preventDefault(),e.stopPropagation(),await this.handleInstallClick()})),t&&t.addEventListener("click",(e=>{e.preventDefault(),e.stopPropagation(),this.closeInstallBanner()}))}async handleInstallClick(){if(console.log("ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒœã‚¿ãƒ³ãŒã‚¯ãƒªãƒƒã‚¯ã•ã‚Œã¾ã—ãŸ"),this.deferredPrompt)try{console.log("prompt()ã‚’å‘¼ã³å‡ºã—ã¾ã™..."),await this.deferredPrompt.prompt();const{outcome:e}=await this.deferredPrompt.userChoice;console.log("ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«çµæœ:",e),this.deferredPrompt=null,this.hideInstallBanner()}catch(e){console.error("ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚¨ãƒ©ãƒ¼:",e),this.deferredPrompt=null}else console.log("deferredPromptãŒåˆ©ç”¨ã§ãã¾ã›ã‚“ã€‚PWAã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¡ä»¶ãŒæº€ãŸã•ã‚Œã¦ã„ãªã„å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚")}showInstallBanner(){const e=document.getElementById("install-banner");e&&(e.style.display="block",console.log("ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒãƒŠãƒ¼ã‚’è¡¨ç¤ºã—ã¾ã—ãŸ"))}hideInstallBanner(){const e=document.getElementById("install-banner");e&&(e.style.display="none",console.log("ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒãƒŠãƒ¼ã‚’éè¡¨ç¤ºã«ã—ã¾ã—ãŸ"))}closeInstallBanner(){this.hideInstallBanner()}enableInstallButton(){const e=document.getElementById("install-btn");e&&(e.disabled=!1,e.style.opacity="1",e.style.cursor="pointer",console.log("ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒœã‚¿ãƒ³ã‚’æœ‰åŠ¹åŒ–ã—ã¾ã—ãŸ"))}};window.pwaManager=i,window.addEventListener("orientationchange",(()=>{setTimeout((()=>{window.gameInstance&&window.gameInstance.scale&&window.gameInstance.scale.resize(window.innerWidth,window.innerHeight)}),500)}))})();