<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>三重町マップ読み込みテスト</title>
</head>
<body>
    <h1>三重町マップ読み込みテスト</h1>
    <div id="log"></div>
    
    <script type="module">
        import { MiemachiConversationManager } from './src/data/miemachi/conversationData.js';
        import { ResourceManager } from './src/managers/ResourceManager.js';
        
        // ログ表示用
        function log(message) {
            const logDiv = document.getElementById('log');
            logDiv.innerHTML += '<p>' + message + '</p>';
            console.log(message);
        }
        
        async function testMiemachiLoading() {
            log('=== 三重町マップ読み込みテスト開始 ===');
            
            try {
                // 1. リソース管理クラスを初期化
                const resourceManager = new ResourceManager();
                log('ResourceManager初期化完了');
                
                // 2. 三重町会話管理クラスを初期化
                const miemachiManager = new MiemachiConversationManager();
                log('MiemachiConversationManager初期化完了');
                
                // 3. リソース管理クラスを設定
                miemachiManager.setResourceManager(resourceManager);
                log('ResourceManager設定完了');
                
                // 4. マップ読み込み開始
                log('--- マップ読み込み開始 ---');
                await miemachiManager.loadMap('miemachi');
                log('マップ読み込み完了！');
                
                // 5. 利用可能なイベントを確認
                const events = miemachiManager.getAvailableEvents();
                log('利用可能なイベント: ' + events.join(', '));
                
            } catch (error) {
                log('エラーが発生しました: ' + error.message);
                console.error('詳細エラー:', error);
            }
            
            log('=== テスト終了 ===');
        }
        
        // テスト実行
        testMiemachiLoading();
    </script>
</body>
</html>
